{
  "version": 3,
  "sources": [
    "webpack:///src/app/homepage/pages/techniques/authentication/authentication.component.ts",
    "webpack:///src/app/homepage/pages/techniques/authentication/authentication.component.html",
    "webpack:///src/app/homepage/pages/techniques/caching/caching.component.ts",
    "webpack:///src/app/homepage/pages/techniques/caching/caching.component.html",
    "webpack:///src/app/homepage/pages/techniques/compression/compression.component.ts",
    "webpack:///src/app/homepage/pages/techniques/compression/compression.component.html",
    "webpack:///src/app/homepage/pages/techniques/configuration/configuration.component.ts",
    "webpack:///src/app/homepage/pages/techniques/configuration/configuration.component.html",
    "webpack:///src/app/homepage/pages/techniques/file-upload/file-upload.component.ts",
    "webpack:///src/app/homepage/pages/techniques/file-upload/file-upload.component.html",
    "webpack:///src/app/homepage/pages/techniques/http-module/http-module.component.ts",
    "webpack:///src/app/homepage/pages/techniques/http-module/http-module.component.html",
    "webpack:///src/app/homepage/pages/techniques/logger/logger.component.ts",
    "webpack:///src/app/homepage/pages/techniques/logger/logger.component.html",
    "webpack:///src/app/homepage/pages/techniques/mongo/mongo.component.ts",
    "webpack:///src/app/homepage/pages/techniques/mongo/mongo.component.html",
    "webpack:///src/app/homepage/pages/techniques/mvc/mvc.component.ts",
    "webpack:///src/app/homepage/pages/techniques/mvc/mvc.component.html",
    "webpack:///src/app/homepage/pages/techniques/performance/performance.component.ts",
    "webpack:///src/app/homepage/pages/techniques/performance/performance.component.html",
    "webpack:///src/app/homepage/pages/techniques/queues/queues.component.ts",
    "webpack:///src/app/homepage/pages/techniques/queues/queues.component.html",
    "webpack:///src/app/homepage/pages/techniques/security/security.component.ts",
    "webpack:///src/app/homepage/pages/techniques/security/security.component.html",
    "webpack:///src/app/homepage/pages/techniques/serialization/serialization.component.ts",
    "webpack:///src/app/homepage/pages/techniques/serialization/serialization.component.html",
    "webpack:///src/app/homepage/pages/techniques/sql/sql.component.ts",
    "webpack:///src/app/homepage/pages/techniques/sql/sql.component.html",
    "webpack:///src/app/homepage/pages/techniques/task-scheduling/task-scheduling.component.ts",
    "webpack:///src/app/homepage/pages/techniques/task-scheduling/task-scheduling.component.html",
    "webpack:///src/app/homepage/pages/techniques/techniques.module.ts",
    "webpack:///src/app/homepage/pages/techniques/validation/validation.component.ts",
    "webpack:///src/app/homepage/pages/techniques/validation/validation.component.html"
  ],
  "names": [
    "AuthenticationComponent",
    "selector",
    "templateUrl",
    "changeDetection",
    "OnPush",
    "CachingComponent",
    "CompressionComponent",
    "ConfigurationComponent",
    "FileUploadComponent",
    "HttpModuleComponent",
    "LoggerComponent",
    "MongoComponent",
    "MvcComponent",
    "PerformanceComponent",
    "QueuesComponent",
    "SecurityComponent",
    "SerializationComponent",
    "SqlComponent",
    "TaskSchedulingComponent",
    "routes",
    "path",
    "component",
    "data",
    "title",
    "redirectTo",
    "TechniquesModule",
    "forChild",
    "imports",
    "declarations",
    "ValidationComponent"
  ],
  "mappings": "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",
  "file": "homepage-pages-techniques-techniques-module-es5.js",
  "sourcesContent": [
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-authentication',\n  templateUrl: './authentication.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AuthenticationComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/authentication.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"authentication\">Authentication</h3>\n<p>Authentication is an <strong>essential</strong> part of most applications. There are many different approaches and strategies to handle authentication. The approach taken for any project depends on its particular application requirements. This chapter presents several approaches to authentication that can be adapted to a variety of different requirements.</p>\n<p><a rel='nofollow' target='_blank' href=\"https://github.com/jaredhanson/passport\">Passport</a> is the most popular node.js authentication library, well-known by the community and successfully used in many production applications. It&#39;s straightforward to integrate this library with a <strong>Nest</strong> application using the <code>@nestjs/passport</code> module. At a high level, Passport executes a series of steps to:</p>\n<ul>\n<li>Authenticate a user by verifying their &quot;credentials&quot; (such as username/password, JSON Web Token (<a rel='nofollow' target='_blank' href=\"https://jwt.io/\">JWT</a>), or identity token from an Identity Provider)</li>\n<li>Manage authenticated state (by issuing a portable token, such as a JWT, or creating an <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/session\">Express session</a>)</li>\n<li>Attach information about the authenticated user to the <code>Request</code> object for further use in route handlers</li>\n</ul>\n<p>Passport has a rich ecosystem of <a rel='nofollow' target='_blank' href=\"http://www.passportjs.org/packages/\">strategies</a> that implement various authentication mechanisms. While simple in concept, the set of Passport strategies you can choose from is large and presents a lot of variety. Passport abstracts these varied steps into a standard pattern, and the <code>@nestjs/passport</code> module wraps and standardizes this pattern into familiar Nest constructs.</p>\n<p>In this chapter, we&#39;ll implement a complete end-to-end authentication solution for a RESTful API server using these powerful and flexible modules. You can use the concepts described here to implement any Passport strategy to customize your authentication scheme. You can follow the steps in this chapter to build this complete example. You can find a repository with a completed sample app <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/19-auth-jwt\">here</a>.</p>\n<h4 appAnchor id=\"authentication-requirements\"><span>Authentication requirements</span></h4>\n<p>Let&#39;s flesh out our requirements. For this use case, clients will start by authenticating with a username and password. Once authenticated, the server will issue a JWT that can be sent as a <a rel='nofollow' target='_blank' href=\"https://tools.ietf.org/html/rfc6750\">bearer token in an authorization header</a> on subsequent requests to prove authentication. We&#39;ll also create a protected route that is accessible only to requests that contain a valid JWT.</p>\n<p>We&#39;ll start with the first requirement: authenticating a user. We&#39;ll then extend that by issuing a JWT. Finally, we&#39;ll create a protected route that checks for a valid JWT on the request.</p>\n<p>First we need to install the required packages. Passport provides a strategy called <a rel='nofollow' target='_blank' href=\"https://github.com/jaredhanson/passport-local\">passport-local</a> that implements a username/password authentication mechanism, which suits our needs for this portion of our use case.</p>\n<pre><code class=\"language-bash\">\n$ npm install --save @nestjs/passport passport passport-local\n$ npm install --save-dev @types/passport-local</code></pre>\n<blockquote class=\"\nwarning \"><strong>Notice</strong> For <strong>any</strong> Passport strategy you choose, you&#39;ll always need the <code>@nestjs/passport</code> and <code>passport</code> packages. Then, you&#39;ll need to install the strategy-specific package (e.g., <code>passport-jwt</code> or <code>passport-local</code>) that implements the particular authentication strategy you are building. In addition, you can also install the type definitions for any Passport strategy, as show above with <code>@types/passport-local</code>, which provides assistance while writing TypeScript code.\n</blockquote>\n<h4 appAnchor id=\"implementing-passport-strategies\"><span>Implementing Passport strategies</span></h4>\n<p>We&#39;re now ready to implement the authentication feature. We&#39;ll start with an overview of the process used for <strong>any</strong> Passport strategy. It&#39;s helpful to think of Passport as a mini framework in itself. The elegance of the framework is that it abstracts the authentication process into a few basic steps that you customize based on the strategy you&#39;re implementing. It&#39;s like a framework because you configure it by supplying customization parameters (as plain JSON objects) and custom code in the form of callback functions, which Passport calls at the appropriate time. The <code>@nestjs/passport</code> module wraps this framework in a Nest style package, making it easy to integrate into a Nest application. We&#39;ll use <code>@nestjs/passport</code> below, but first let&#39;s consider how <strong>vanilla Passport</strong> works.</p>\n<p>In vanilla Passport, you configure a strategy by providing two things:</p>\n<ol>\n<li>A set of options that are specific to that strategy. For example, in a JWT strategy, you might provide a secret to sign tokens.</li>\n<li>A &quot;verify callback&quot;, which is where you tell Passport how to interact with your user store (where you manage user accounts). Here, you verify whether a user exists (and/or create a new user), and whether their credentials are valid. The Passport library expects this callback to return a full user if the validation succeeds, or a null if it fails (failure is defined as either the user is not found, or, in the case of passport-local, the password does not match).</li>\n</ol>\n<p>With <code>@nestjs/passport</code>, you configure a Passport strategy by extending the <code>PassportStrategy</code> class. You pass the strategy options (item 1 above) by calling the <code>super()</code> method in your subclass, optionally passing in an options object. You provide the verify callback (item 2 above) by implementing a <code>validate()</code> method in your subclass.</p>\n<p>We&#39;ll start by generating an <code>AuthModule</code> and in it, an <code>AuthService</code>:</p>\n<pre><code class=\"language-bash\">\n$ nest g module auth\n$ nest g service auth</code></pre>\n<p>As we implement the <code>AuthService</code>, we&#39;ll find it useful to encapsulate user operations in a <code>UsersService</code>, so let&#39;s generate that module and service now:</p>\n<pre><code class=\"language-bash\">\n$ nest g module users\n$ nest g service users</code></pre>\n<p>Replace the default contents of these generated files as shown below. For our sample app, the <code>UsersService</code> simply maintains a hard-coded in-memory list of users, and a find method to retrieve one by username. In a real app, this is where you&#39;d build your user model and persistence layer, using your library of choice (e.g., TypeORM, Sequelize, Mongoose, etc.).</p>\n\n<span class=\"filename\">\n  {{ 'users/users.service' | extension: app895767af12b531582cea9930847f08ce87ddcb58.isJsActive }}\n<app-tabs #app895767af12b531582cea9930847f08ce87ddcb58></app-tabs>\n</span><pre [class.hide]=\"app895767af12b531582cea9930847f08ce87ddcb58.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\n\nexport type User = any;\n\n@Injectable()\nexport class UsersService &#123;\n  private readonly users: User[];\n\n  constructor() &#123;\n    this.users = [\n      &#123;\n        userId: 1,\n        username: &#39;john&#39;,\n        password: &#39;changeme&#39;,\n      &#125;,\n      &#123;\n        userId: 2,\n        username: &#39;chris&#39;,\n        password: &#39;secret&#39;,\n      &#125;,\n      &#123;\n        userId: 3,\n        username: &#39;maria&#39;,\n        password: &#39;guess&#39;,\n      &#125;,\n    ];\n  &#125;\n\n  async findOne(username: string): Promise&lt;User | undefined&gt; &#123;\n    return this.users.find(user =&gt; user.username === username);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app895767af12b531582cea9930847f08ce87ddcb58.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\n\n@Injectable()\nexport class UsersService &#123;\n  constructor() &#123;\n    this.users = [\n      &#123;\n        userId: 1,\n        username: &#39;john&#39;,\n        password: &#39;changeme&#39;,\n      &#125;,\n      &#123;\n        userId: 2,\n        username: &#39;chris&#39;,\n        password: &#39;secret&#39;,\n      &#125;,\n      &#123;\n        userId: 3,\n        username: &#39;maria&#39;,\n        password: &#39;guess&#39;,\n      &#125;,\n    ];\n  &#125;\n\n  async findOne(username) &#123;\n    return this.users.find(user =&gt; user.username === username);\n  &#125;\n&#125;</code></pre><p>In the <code>UsersModule</code>, the only change needed is to add the <code>UsersService</code> to the exports array of the <code>@Module</code> decorator so that it is visible outside this module (we&#39;ll soon use it in our <code>AuthService</code>).</p>\n\n<span class=\"filename\">\n  {{ 'users/users.module' | extension: app24a3d597876c2a85e1e98e703a9578ca68cb2c41.isJsActive }}\n<app-tabs #app24a3d597876c2a85e1e98e703a9578ca68cb2c41></app-tabs>\n</span><pre [class.hide]=\"app24a3d597876c2a85e1e98e703a9578ca68cb2c41.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; UsersService &#125; from &#39;./users.service&#39;;\n\n@Module(&#123;\n  providers: [UsersService],\n  exports: [UsersService],\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre>\n<pre [class.hide]=\"!app24a3d597876c2a85e1e98e703a9578ca68cb2c41.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; UsersService &#125; from &#39;./users.service&#39;;\n\n@Module(&#123;\n  providers: [UsersService],\n  exports: [UsersService],\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre><p>Our <code>AuthService</code> has the job of retrieving a user and verifying the password. We create a <code>validateUser()</code> method for this purpose. In the code below, we use a convenient ES6 spread operator to strip the password property from the user object before returning it. We&#39;ll be calling into the <code>validateUser()</code> method from our Passport local strategy in a moment.</p>\n\n<span class=\"filename\">\n  {{ 'auth/auth.service' | extension: appee2072477e14b47b7a2cacda1ed48d984573c0ef.isJsActive }}\n<app-tabs #appee2072477e14b47b7a2cacda1ed48d984573c0ef></app-tabs>\n</span><pre [class.hide]=\"appee2072477e14b47b7a2cacda1ed48d984573c0ef.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; UsersService &#125; from &#39;../users/users.service&#39;;\n\n@Injectable()\nexport class AuthService &#123;\n  constructor(private readonly usersService: UsersService) &#123;&#125;\n\n  async validateUser(username: string, pass: string): Promise&lt;any&gt; &#123;\n    const user = await this.usersService.findOne(username);\n    if (user &amp;&amp; user.password === pass) &#123;\n      const &#123; password, ...result &#125; = user;\n      return result;\n    &#125;\n    return null;\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appee2072477e14b47b7a2cacda1ed48d984573c0ef.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable, Dependencies &#125; from &#39;@nestjs/common&#39;;\nimport &#123; UsersService &#125; from &#39;../users/users.service&#39;;\n\n@Injectable()\n@Dependencies(UsersService)\nexport class AuthService &#123;\n  constructor(usersService) &#123;\n    this.usersService = usersService;\n  &#125;\n\n  async validateUser(username, pass) &#123;\n    const user = await this.usersService.findOne(username);\n    if (user &amp;&amp; user.password === pass) &#123;\n      const &#123; password, ...result &#125; = user;\n      return result;\n    &#125;\n    return null;\n  &#125;\n&#125;</code></pre><blockquote class=\"\nWarning \"><strong>Warning</strong> Of course in a real application, you wouldn&#39;t store a password in plain text. You&#39;d instead use a library like <a rel='nofollow' target='_blank' href=\"https://github.com/kelektiv/node.bcrypt.js#readme\">bcrypt</a>, with a salted one-way hash algorithm. With that approach, you&#39;d only store hashed passwords, and then compare the stored password to a hashed version of the <strong>incoming</strong> password, thus never storing or exposing user passwords in plain text. To keep our sample app simple, we violate that absolute mandate and use plain text. <strong>Don&#39;t do this in your real app!</strong>\n</blockquote>\n<p>Now, we update our <code>AuthModule</code> to import the <code>UsersModule</code>.</p>\n\n<span class=\"filename\">\n  {{ 'auth/auth.module' | extension: app15649c7e96fd90f2cbbb18e409bc5640ef7fd268.isJsActive }}\n<app-tabs #app15649c7e96fd90f2cbbb18e409bc5640ef7fd268></app-tabs>\n</span><pre [class.hide]=\"app15649c7e96fd90f2cbbb18e409bc5640ef7fd268.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\n\n@Module(&#123;\n  imports: [UsersModule],\n  providers: [AuthService],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre>\n<pre [class.hide]=\"!app15649c7e96fd90f2cbbb18e409bc5640ef7fd268.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\n\n@Module(&#123;\n  imports: [UsersModule],\n  providers: [AuthService],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre><h4 appAnchor id=\"implementing-passport-local\"><span>Implementing Passport local</span></h4>\n<p>Now we can implement our Passport <strong>local authentication strategy</strong>. Create a file called <code>local.strategy.ts</code> in the <code>auth</code> folder, and add the following code:</p>\n\n<span class=\"filename\">\n  {{ 'auth/local.strategy' | extension: app7558dfb224d063fd8130b0a44ae78eebb5c282b0.isJsActive }}\n<app-tabs #app7558dfb224d063fd8130b0a44ae78eebb5c282b0></app-tabs>\n</span><pre [class.hide]=\"app7558dfb224d063fd8130b0a44ae78eebb5c282b0.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Strategy &#125; from &#39;passport-local&#39;;\nimport &#123; PassportStrategy &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; Injectable, UnauthorizedException &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\n\n@Injectable()\nexport class LocalStrategy extends PassportStrategy(Strategy) &#123;\n  constructor(private readonly authService: AuthService) &#123;\n    super();\n  &#125;\n\n  async validate(username: string, password: string): Promise&lt;any&gt; &#123;\n    const user = await this.authService.validateUser(username, password);\n    if (!user) &#123;\n      throw new UnauthorizedException();\n    &#125;\n    return user;\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app7558dfb224d063fd8130b0a44ae78eebb5c282b0.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Strategy &#125; from &#39;passport-local&#39;;\nimport &#123; PassportStrategy &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; Injectable, UnauthorizedException, Dependencies &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\n\n@Injectable()\n@Dependencies(AuthService)\nexport class LocalStrategy extends PassportStrategy(Strategy) &#123;\n  constructor(authService) &#123;\n    this.authService = authService\n    super();\n  &#125;\n\n  async validate(username, password) &#123;\n    const user = await this.authService.validateUser(username, password);\n    if (!user) &#123;\n      throw new UnauthorizedException();\n    &#125;\n    return user;\n  &#125;\n&#125;</code></pre><p>We&#39;ve followed the recipe described earlier for all Passport strategies. In our use case with passport-local, there are no configuration options, so our constructor simply calls <code>super()</code>, without an options object.</p>\n<p>We&#39;ve also implemented the <code>validate()</code> method. For each strategy, Passport will call the verify function (implemented with the <code>validate()</code> method in <code>@nestjs/passport</code>) using an appropriate strategy-specific set of parameters. For the local-strategy, Passport expects a <code>validate()</code> method with the following signature: <code>validate(username: string, password:string): any</code>.</p>\n<p>Most of the validation work is done in our <code>AuthService</code> (with the help of our <code>UserService</code>), so this method is quite straightforward. The <code>validate()</code> method for <strong>any</strong> Passport strategy will follow a similar pattern, varying only in the details of how credentials are represented. If a user is found and the credentials are valid, the user is returned so Passport can complete its tasks (e.g., creating the <code>user</code> property on the <code>Request</code> object), and the request handling pipeline can continue. If it&#39;s not found, we throw an exception and let our <a href=\"exception-filters\">exceptions layer</a> handle it.</p>\n<p>Typically, the only significant difference in the <code>validate()</code> method for each strategy is <strong>how</strong> you determine if a user exists and is valid. For example, in a JWT strategy, depending on requirements, we may evaluate whether the <code>userId</code> carried in the decoded token matches a record in our user database, or matches a list of revoked tokens. Hence, this pattern of sub-classing and implementing strategy-specific validation is consistent, elegant and extensible.</p>\n<p>We need to configure our <code>AuthModule</code> to use the Passport features we just defined. Update <code>auth.module.ts</code> to look like this:</p>\n\n<span class=\"filename\">\n  {{ 'auth/auth.module' | extension: appbdc24f6bc684962ea4c5994275d87e9e6062a458.isJsActive }}\n<app-tabs #appbdc24f6bc684962ea4c5994275d87e9e6062a458></app-tabs>\n</span><pre [class.hide]=\"appbdc24f6bc684962ea4c5994275d87e9e6062a458.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\nimport &#123; PassportModule &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; LocalStrategy &#125; from &#39;./local.strategy&#39;;\n\n@Module(&#123;\n  imports: [UsersModule, PassportModule],\n  providers: [AuthService, LocalStrategy],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre>\n<pre [class.hide]=\"!appbdc24f6bc684962ea4c5994275d87e9e6062a458.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\nimport &#123; PassportModule &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; LocalStrategy &#125; from &#39;./local.strategy&#39;;\n\n@Module(&#123;\n  imports: [UsersModule, PassportModule],\n  providers: [AuthService, LocalStrategy],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre><h4 appAnchor id=\"built-in-passport-guards\"><span>Built-in Passport Guards</span></h4>\n<p>The <a href=\"guards\">Guards</a> chapter describes the primary function of Guards: to determine whether a request will be handled by the route handler or not. That remains true, and we&#39;ll use that standard capability soon. However, in the context of using the <code>@nestjs/passport</code> module, we will also introduce a slight new wrinkle that may at first be confusing, so let&#39;s discuss that now. Consider that your app can exist in two states, from an authentication perspective:</p>\n<ol>\n<li>the user/client is <strong>not</strong> logged in (is not authenticated)</li>\n<li>the user/client <strong>is</strong> logged in (is authenticated)</li>\n</ol>\n<p>In the first case (user is not logged in), we need to perform two distinct functions:</p>\n<ul>\n<li><p>Restrict the routes an unauthenticated user can access (i.e., deny access to restricted routes). We&#39;ll use Guards in their familiar capacity to handle this function, by placing a Guard on the protected routes. As you may anticipate, we&#39;ll be checking for the presence of a valid JWT in this Guard, so we&#39;ll work on this Guard later, once we are successfully issuing JWTs.</p>\n</li>\n<li><p>Initiate the <strong>authentication step</strong> itself when a previously unauthenticated user attempts to login. This is the step where we&#39;ll <strong>issue</strong> a JWT to a valid user. Thinking about this for a moment, we know we&#39;ll need to <code>POST</code> username/password credentials to initiate authentication, so we&#39;ll set up a <code>POST /auth/login</code> route to handle that. This raises the question: how exactly do we invoke the passport-local strategy in that route?</p>\n</li>\n</ul>\n<p>The answer is straightforward: by using another, slightly different type of Guard. The <code>@nestjs/passport</code> module provides us with a built-in Guard that does this for us. This Guard invokes the Passport strategy and kicks off the steps described above (retrieving credentials, running the verify function, creating the <code>user</code> property, etc).</p>\n<p>The second case enumerated above (logged in user) simply relies on the standard type of Guard we already discussed to enable access to protected routes for logged in users.</p>\n<p></p>\n<h4 appAnchor id=\"login-route\"><span>Login route</span></h4>\n<p>With the strategy in place, we can now implement a bare-bones <code>/auth/login</code> route, and apply the built-in Guard to initiate the passport-local flow.</p>\n<p>Open the <code>app.controller.ts</code> file and replace its contents with the following:</p>\n\n<span class=\"filename\">\n  {{ 'app.controller' | extension: app273789167402066d887f346141821433637c61fc.isJsActive }}\n<app-tabs #app273789167402066d887f346141821433637c61fc></app-tabs>\n</span><pre [class.hide]=\"app273789167402066d887f346141821433637c61fc.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Controller, Request, Post, UseGuards &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthGuard &#125; from &#39;@nestjs/passport&#39;;\n\n@Controller()\nexport class AppController &#123;\n  @UseGuards(AuthGuard(&#39;local&#39;))\n  @Post(&#39;auth/login&#39;)\n  async login(@Request() req) &#123;\n    return req.user;\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app273789167402066d887f346141821433637c61fc.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Controller, Bind, Request, Post, UseGuards &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthGuard &#125; from &#39;@nestjs/passport&#39;;\n\n@Controller()\nexport class AppController &#123;\n  @UseGuards(AuthGuard(&#39;local&#39;))\n  @Post(&#39;auth/login&#39;)\n  @Bind(Req())\n  async login(req) &#123;\n    return req.user;\n  &#125;\n&#125;</code></pre><p>With <code>@UseGuards(AuthGuard(&#39;local&#39;))</code> we are using an <code>AuthGuard</code> that <code>@nestjs/passport</code> <strong>automatically provisioned</strong> for us when we extended the passport-local strategy. Let&#39;s break that down. Our Passport local strategy has a default name of <code>&#39;local&#39;</code>. We reference that name in the <code>@UseGuards()</code> decorator to associate it with code supplied by the <code>passport-local</code> package. This is used to disambiguate which strategy to invoke in case we have multiple Passport strategies in our app (each of which may provision a strategy-specific <code>AuthGuard</code>). While we only have one such strategy so far, we&#39;ll shortly add a second, so this is needed for disambiguation.</p>\n<p>In order to test our route we&#39;ll have our <code>/auth/login</code> route simply return the user for now. This also lets us demonstrate another Passport feature: Passport automatically creates a <code>user</code> object, based on the value we return from the <code>validate()</code> method, and assigns it to the <code>Request</code> object as <code>req.user</code>. Later, we&#39;ll replace this with code to create and return a JWT instead.</p>\n<p>Since these are API routes, we&#39;ll test them using the commonly available <a rel='nofollow' target='_blank' href=\"https://curl.haxx.se/\">cURL</a> library. You can test with any of the <code>user</code> objects hard-coded in the <code>UsersService</code>.</p>\n<pre><code class=\"language-bash\">\n$ # POST to /auth/login\n$ curl -X POST http://localhost:3000/auth/login -d &#39;&#123;&quot;username&quot;: &quot;john&quot;, &quot;password&quot;: &quot;changeme&quot;&#125;&#39; -H &quot;Content-Type: application/json&quot;\n$ # result -&gt; &#123;&quot;userId&quot;:1,&quot;username&quot;:&quot;john&quot;&#125;</code></pre>\n<p>While this works, passing the strategy name directly to the <code>AuthGuard()</code> introduces magic strings in the codebase. Instead, we recommend creating your own class, as shown below:</p>\n\n<span class=\"filename\">\n  {{ 'auth/local-auth.guard' | extension: appc54bae382fb5eaf12d4c50b72131882c88a25109.isJsActive }}\n<app-tabs #appc54bae382fb5eaf12d4c50b72131882c88a25109></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthGuard &#125; from &#39;@nestjs/passport&#39;;\n\n@Injectable()\nexport class LocalAuthGuard extends AuthGuard(&#39;local&#39;) &#123;&#125;</code></pre><p>Now, we can update the <code>/auth/login</code> route handler and use the <code>LocalAuthGuard</code> instead:</p>\n<pre><code class=\"language-typescript\">\n@UseGuards(LocalAuthGuard)\n@Post(&#39;auth/login&#39;)\nasync login(@Request() req) &#123;\n  return req.user;\n&#125;</code></pre>\n<h4 appAnchor id=\"jwt-functionality\"><span>JWT functionality</span></h4>\n<p>We&#39;re ready to move on to the JWT portion of our auth system. Let&#39;s review and refine our requirements:</p>\n<ul>\n<li>Allow users to authenticate with username/password, returning a JWT for use in subsequent calls to protected API endpoints. We&#39;re well on our way to meeting this requirement. To complete it, we&#39;ll need to write the code that issues a JWT.</li>\n<li>Create API routes which are protected based on the presence of a valid JWT as a bearer token</li>\n</ul>\n<p>We&#39;ll need to install a couple more packages to support our JWT requirements:</p>\n<pre><code class=\"language-bash\">\n$ npm install @nestjs/jwt passport-jwt\n$ npm install @types/passport-jwt --save-dev</code></pre>\n<p>The <code>@nestjs/jwt</code> package (see more <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/jwt\">here</a>) is a utility package that helps with JWT manipulation. The <code>passport-jwt</code> package is the Passport package that implements the JWT strategy and <code>@types/passport-jwt</code> provides the TypeScript type definitions.</p>\n<p>Let&#39;s take a closer look at how a <code>POST /auth/login</code> request is handled. We&#39;ve decorated the route using the built-in <code>AuthGuard</code> provided by the passport-local strategy. This means that:</p>\n<ol>\n<li>The route handler <strong>will only be invoked if the user has been validated</strong></li>\n<li>The <code>req</code> parameter will contain a <code>user</code> property (populated by Passport during the passport-local authentication flow)</li>\n</ol>\n<p>With this in mind, we can now finally generate a real JWT, and return it in this route. To keep our services cleanly modularized, we&#39;ll handle generating the JWT in the <code>authService</code>. Open the <code>auth.service.ts</code> file in the <code>auth</code> folder, and add the <code>login()</code> method, and import the <code>JwtService</code> as shown:</p>\n\n<span class=\"filename\">\n  {{ 'auth/auth.service' | extension: app3817416f16478eb6e7dcd320249c4531b87298d4.isJsActive }}\n<app-tabs #app3817416f16478eb6e7dcd320249c4531b87298d4></app-tabs>\n</span><pre [class.hide]=\"app3817416f16478eb6e7dcd320249c4531b87298d4.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; UsersService &#125; from &#39;../users/users.service&#39;;\nimport &#123; JwtService &#125; from &#39;@nestjs/jwt&#39;;\n\n@Injectable()\nexport class AuthService &#123;\n  constructor(\n    private readonly usersService: UsersService,\n    private readonly jwtService: JwtService\n  ) &#123;&#125;\n\n  async validateUser(username: string, pass: string): Promise&lt;any&gt; &#123;\n    const user = await this.usersService.findOne(username);\n    if (user &amp;&amp; user.password === pass) &#123;\n      const &#123; password, ...result &#125; = user;\n      return result;\n    &#125;\n    return null;\n  &#125;\n\n  async login(user: any) &#123;\n    const payload = &#123; username: user.username, sub: user.userId &#125;;\n    return &#123;\n      access_token: this.jwtService.sign(payload),\n    &#125;;\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app3817416f16478eb6e7dcd320249c4531b87298d4.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable, Dependencies &#125; from &#39;@nestjs/common&#39;;\nimport &#123; UsersService &#125; from &#39;../users/users.service&#39;;\nimport &#123; JwtService &#125; from &#39;@nestjs/jwt&#39;;\n\n@Dependencies(UsersService, JwtService)\n@Injectable()\nexport class AuthService &#123;\n  constructor(usersService, jwtService)\n  ) &#123;\n    this.usersService = usersService;\n    this.jwtService = jwtService;\n  &#125;\n\n  async validateUser(username, pass) &#123;\n    const user = await this.usersService.findOne(username);\n    if (user &amp;&amp; user.password === pass) &#123;\n      const &#123; password, ...result &#125; = user;\n      return result;\n    &#125;\n    return null;\n  &#125;\n\n  async login(user) &#123;\n    const payload = &#123; username: user.username, sub: user.userId &#125;;\n    return &#123;\n      access_token: this.jwtService.sign(payload),\n    &#125;;\n  &#125;\n&#125;</code></pre><p>We&#39;re using the <code>@nestjs/jwt</code> library, which supplies a <code>sign()</code> function to generate our JWT from a subset of the <code>user</code> object properties, which we then return as a simple object with a single <code>access_token</code> property. Note: we choose a property name of <code>sub</code> to hold our <code>userId</code> value to be consistent with JWT standards. Don&#39;t forget to inject the JwtService provider into the <code>AuthService</code>.</p>\n<p>We now need to update the <code>AuthModule</code> to import the new dependencies and configure the <code>JwtModule</code>.</p>\n<p>First, create <code>constants.ts</code> in the <code>auth</code> folder, and add the following code:</p>\n\n<span class=\"filename\">\n  {{ 'auth/constants' | extension: app2c8d40ed17af95a83605e2026333dd153eeb3f86.isJsActive }}\n<app-tabs #app2c8d40ed17af95a83605e2026333dd153eeb3f86></app-tabs>\n</span><pre [class.hide]=\"app2c8d40ed17af95a83605e2026333dd153eeb3f86.isJsActive\"><code class=\"language-typescript\">\nexport const jwtConstants = &#123;\n  secret: &#39;secretKey&#39;,\n&#125;;</code></pre>\n<pre [class.hide]=\"!app2c8d40ed17af95a83605e2026333dd153eeb3f86.isJsActive\"><code class=\"language-typescript\">\nexport const jwtConstants = &#123;\n  secret: &#39;secretKey&#39;,\n&#125;;</code></pre><p>We&#39;ll use this to share our key between the JWT signing and verifying steps.</p>\n<blockquote class=\"\nWarning \"><strong>Warning</strong> <strong>Do not expose this key publicly</strong>. We have done so here to make it clear what the code is doing, but in a production system <strong>you must protect this key</strong> using appropriate measures such as a secrets vault, environment variable, or configuration service.\n</blockquote>\n<p>Now, open <code>auth.module.ts</code> in the <code>auth</code> folder and update it to look like this:</p>\n\n<span class=\"filename\">\n  {{ 'auth/auth.module' | extension: app03f798bfc43a6124a4872bce2221cc9489e273c4.isJsActive }}\n<app-tabs #app03f798bfc43a6124a4872bce2221cc9489e273c4></app-tabs>\n</span><pre [class.hide]=\"app03f798bfc43a6124a4872bce2221cc9489e273c4.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; LocalStrategy &#125; from &#39;./local.strategy&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\nimport &#123; PassportModule &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; JwtModule &#125; from &#39;@nestjs/jwt&#39;;\nimport &#123; jwtConstants &#125; from &#39;./constants&#39;;\n\n@Module(&#123;\n  imports: [\n    UsersModule,\n    PassportModule,\n    JwtModule.register(&#123;\n      secret: jwtConstants.secret,\n      signOptions: &#123; expiresIn: &#39;60s&#39; &#125;,\n    &#125;),\n  ],\n  providers: [AuthService, LocalStrategy],\n  exports: [AuthService],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre>\n<pre [class.hide]=\"!app03f798bfc43a6124a4872bce2221cc9489e273c4.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; LocalStrategy &#125; from &#39;./local.strategy&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\nimport &#123; PassportModule &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; JwtModule &#125; from &#39;@nestjs/jwt&#39;;\nimport &#123; jwtConstants &#125; from &#39;./constants&#39;;\n\n@Module(&#123;\n  imports: [\n    UsersModule,\n    PassportModule,\n    JwtModule.register(&#123;\n      secret: jwtConstants.secret,\n      signOptions: &#123; expiresIn: &#39;60s&#39; &#125;,\n    &#125;),\n  ],\n  providers: [AuthService, LocalStrategy],\n  exports: [AuthService],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre><p>We configure the <code>JwtModule</code> using <code>register()</code>, passing in a configuration object. See <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/jwt/blob/master/README.md\">here</a> for more on the Nest <code>JwtModule</code> and <a rel='nofollow' target='_blank' href=\"https://github.com/auth0/node-jsonwebtoken#usage\">here</a> for more details on the available configuration options.</p>\n<p>Now we can update the <code>/auth/login</code> route to return a JWT.</p>\n\n<span class=\"filename\">\n  {{ 'app.controller' | extension: appf75f175141df6434661e0d28bcd598d58c4cbad4.isJsActive }}\n<app-tabs #appf75f175141df6434661e0d28bcd598d58c4cbad4></app-tabs>\n</span><pre [class.hide]=\"appf75f175141df6434661e0d28bcd598d58c4cbad4.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Controller, Request, Post, UseGuards &#125; from &#39;@nestjs/common&#39;;\nimport &#123; LocalAuthGuard &#125; from &#39;./auth/local-auth.guard&#39;;\nimport &#123; AuthService &#125; from &#39;./auth/auth.service&#39;;\n\n@Controller()\nexport class AppController &#123;\n  constructor(private readonly authService: AuthService) &#123;&#125;\n\n  @UseGuards(LocalAuthGuard)\n  @Post(&#39;auth/login&#39;)\n  async login(@Request() req) &#123;\n    return this.authService.login(req.user);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appf75f175141df6434661e0d28bcd598d58c4cbad4.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Controller, Bind, Request, Post, UseGuards &#125; from &#39;@nestjs/common&#39;;\nimport &#123; LocalAuthGuard &#125; from &#39;./auth/local-auth.guard&#39;;\nimport &#123; AuthService &#125; from &#39;./auth/auth.service&#39;;\n\n@Controller()\nexport class AppController &#123;\n  constructor(private readonly authService: AuthService) &#123;&#125;\n\n  @UseGuards(LocalAuthGuard)\n  @Post(&#39;auth/login&#39;)\n  @Bind(Req())\n  async login(req) &#123;\n    return this.authService.login(req.user);\n  &#125;\n&#125;</code></pre><p>Let&#39;s go ahead and test our routes using cURL again. You can test with any of the <code>user</code> objects hard-coded in the <code>UsersService</code>.</p>\n<pre><code class=\"language-bash\">\n$ # POST to /auth/login\n$ curl -X POST http://localhost:3000/auth/login -d &#39;&#123;&quot;username&quot;: &quot;john&quot;, &quot;password&quot;: &quot;changeme&quot;&#125;&#39; -H &quot;Content-Type: application/json&quot;\n$ # result -&gt; &#123;&quot;access_token&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;&#125;\n$ # Note: above JWT truncated</code></pre>\n<h4 appAnchor id=\"implementing-passport-jwt\"><span>Implementing Passport JWT</span></h4>\n<p>We can now address our final requirement: protecting endpoints by requiring a valid JWT be present on the request. Passport can help us here too. It provides the <a rel='nofollow' target='_blank' href=\"https://github.com/mikenicholson/passport-jwt\">passport-jwt</a> strategy for securing RESTful endpoints with JSON Web Tokens. Start by creating a file called <code>jwt.strategy.ts</code> in the <code>auth</code> folder, and add the following code:</p>\n\n<span class=\"filename\">\n  {{ 'auth/jwt.strategy' | extension: app44cb0d4f2f046a6975f62c95128bacc3ea84fa41.isJsActive }}\n<app-tabs #app44cb0d4f2f046a6975f62c95128bacc3ea84fa41></app-tabs>\n</span><pre [class.hide]=\"app44cb0d4f2f046a6975f62c95128bacc3ea84fa41.isJsActive\"><code class=\"language-typescript\">\nimport &#123; ExtractJwt, Strategy &#125; from &#39;passport-jwt&#39;;\nimport &#123; PassportStrategy &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; jwtConstants &#125; from &#39;./constants&#39;;\n\n@Injectable()\nexport class JwtStrategy extends PassportStrategy(Strategy) &#123;\n  constructor() &#123;\n    super(&#123;\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n      ignoreExpiration: false,\n      secretOrKey: jwtConstants.secret,\n    &#125;);\n  &#125;\n\n  async validate(payload: any) &#123;\n    return &#123; userId: payload.sub, username: payload.username &#125;;\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app44cb0d4f2f046a6975f62c95128bacc3ea84fa41.isJsActive\"><code class=\"language-typescript\">\nimport &#123; ExtractJwt, Strategy &#125; from &#39;passport-jwt&#39;;\nimport &#123; PassportStrategy &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; jwtConstants &#125; from &#39;./constants&#39;;\n\n@Injectable()\nexport class JwtStrategy extends PassportStrategy(Strategy) &#123;\n  constructor() &#123;\n    super(&#123;\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n      ignoreExpiration: false,\n      secretOrKey: jwtConstants.secret,\n    &#125;);\n  &#125;\n\n  async validate(payload) &#123;\n    return &#123; userId: payload.sub, username: payload.username &#125;;\n  &#125;\n&#125;</code></pre><p>With our <code>JwtStrategy</code>, we&#39;ve followed the same recipe described earlier for all Passport strategies. This strategy requires some initialization, so we do that by passing in an options object in the <code>super()</code> call. You can read more about the available options <a rel='nofollow' target='_blank' href=\"https://github.com/mikenicholson/passport-jwt#configure-strategy\">here</a>. In our case, these options are:</p>\n<ul>\n<li><code>jwtFromRequest</code>: supplies the method by which the JWT will be extracted from the <code>Request</code>. We will use the standard approach of supplying a bearer token in the Authorization header of our API requests. Other options are described <a rel='nofollow' target='_blank' href=\"https://github.com/mikenicholson/passport-jwt#extracting-the-jwt-from-the-request\">here</a>.</li>\n<li><code>ignoreExpiration</code>: just to be explicit, we choose the default <code>false</code> setting, which delegates the responsibility of ensuring that a JWT has not expired to the Passport module. This means that if our route is supplied with an expired JWT, the request will be denied and a <code>401 Unauthorized</code> response sent. Passport conveniently handles this automatically for us.</li>\n<li><code>secretOrKey</code>: we are using the expedient option of supplying a symmetric secret for signing the token. Other options, such as a PEM-encoded public key, may be more appropriate for production apps (see <a rel='nofollow' target='_blank' href=\"https://github.com/mikenicholson/passport-jwt#extracting-the-jwt-from-the-request\">here</a> for more information). In any case, as cautioned earlier, <strong>do not expose this secret publicly</strong>.</li>\n</ul>\n<p>The <code>validate()</code> method deserves some discussion. For the jwt-strategy, Passport first verifies the JWT&#39;s signature and decodes the JSON. It then invokes our <code>validate()</code> method passing the decoded JSON as its single parameter. Based on the way JWT signing works, <strong>we&#39;re guaranteed that we&#39;re receiving a valid token</strong> that we have previously signed and issued to a valid user.</p>\n<p>As a result of all this, our response to the <code>validate()</code> callback is trivial: we simply return an object containing the <code>userId</code> and <code>username</code> properties. Recall again that Passport will build a <code>user</code> object based on the return value of our <code>validate()</code> method, and attach it as a property on the <code>Request</code> object.</p>\n<p>It&#39;s also worth pointing out that this approach leaves us room (&#39;hooks&#39; as it were) to inject other business logic into the process. For example, we could do a database lookup in our <code>validate()</code> method to extract more information about the user, resulting in a more enriched <code>user</code> object being available in our <code>Request</code>. This is also the place we may decide to do further token validation, such as looking up the <code>userId</code> in a list of revoked tokens, enabling us to perform token revocation. The model we&#39;ve implemented here in our sample code is a fast, &quot;stateless JWT&quot; model, where each API call is immediately authorized based on the presence of a valid JWT, and a small bit of information about the requester (its <code>userId</code> and <code>username</code>) is available in our Request pipeline.</p>\n<p>Add the new <code>JwtStrategy</code> as a provider in the <code>AuthModule</code>:</p>\n\n<span class=\"filename\">\n  {{ 'auth/auth.module' | extension: appc0fa21d5f476c298f917ca715e4bba8fd7145721.isJsActive }}\n<app-tabs #appc0fa21d5f476c298f917ca715e4bba8fd7145721></app-tabs>\n</span><pre [class.hide]=\"appc0fa21d5f476c298f917ca715e4bba8fd7145721.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; LocalStrategy &#125; from &#39;./local.strategy&#39;;\nimport &#123; JwtStrategy &#125; from &#39;./jwt.strategy&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\nimport &#123; PassportModule &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; JwtModule &#125; from &#39;@nestjs/jwt&#39;;\nimport &#123; jwtConstants &#125; from &#39;./constants&#39;;\n\n@Module(&#123;\n  imports: [\n    UsersModule,\n    PassportModule,\n    JwtModule.register(&#123;\n      secret: jwtConstants.secret,\n      signOptions: &#123; expiresIn: &#39;60s&#39; &#125;,\n    &#125;),\n  ],\n  providers: [AuthService, LocalStrategy, JwtStrategy],\n  exports: [AuthService],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre>\n<pre [class.hide]=\"!appc0fa21d5f476c298f917ca715e4bba8fd7145721.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; LocalStrategy &#125; from &#39;./local.strategy&#39;;\nimport &#123; JwtStrategy &#125; from &#39;./jwt.strategy&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\nimport &#123; PassportModule &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; JwtModule &#125; from &#39;@nestjs/jwt&#39;;\nimport &#123; jwtConstants &#125; from &#39;./constants&#39;;\n\n@Module(&#123;\n  imports: [\n    UsersModule,\n    PassportModule,\n    JwtModule.register(&#123;\n      secret: jwtConstants.secret,\n      signOptions: &#123; expiresIn: &#39;60s&#39; &#125;,\n    &#125;),\n  ],\n  providers: [AuthService, LocalStrategy, JwtStrategy],\n  exports: [AuthService],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre><p>By importing the same secret used when we signed the JWT, we ensure that the <strong>verify</strong> phase performed by Passport, and the <strong>sign</strong> phase performed in our AuthService, use a common secret.</p>\n<p>Finally, we define the <code>JwtAuthGuard</code> class which extends the built-in <code>AuthGuard</code>:</p>\n\n<span class=\"filename\">\n  {{ 'auth/jwt-auth.guard' | extension: app6c0a7a38ec940e2273587739db464d6d068b02ea.isJsActive }}\n<app-tabs #app6c0a7a38ec940e2273587739db464d6d068b02ea></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthGuard &#125; from &#39;@nestjs/passport&#39;;\n\n@Injectable()\nexport class JwtAuthGuard extends AuthGuard(&#39;jwt&#39;) &#123;&#125;</code></pre><h4 appAnchor id=\"implement-protected-route-and-jwt-strategy-guards\"><span>Implement protected route and JWT strategy guards</span></h4>\n<p>We can now implement our protected route and its associated Guard.</p>\n<p>Open the <code>app.controller.ts</code> file and update it as shown below:</p>\n\n<span class=\"filename\">\n  {{ 'app.controller' | extension: appfd1260d8edfdd2676949a8fcb940c4d3fe6daa82.isJsActive }}\n<app-tabs #appfd1260d8edfdd2676949a8fcb940c4d3fe6daa82></app-tabs>\n</span><pre [class.hide]=\"appfd1260d8edfdd2676949a8fcb940c4d3fe6daa82.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Controller, Get, Request, Post, UseGuards &#125; from &#39;@nestjs/common&#39;;\nimport &#123; JwtAuthGuard &#125; from &#39;./auth/jwt-auth.guard&#39;;\nimport &#123; LocalAuthGuard &#125; from &#39;./auth/local-auth.guard&#39;;\nimport &#123; AuthService &#125; from &#39;./auth/auth.service&#39;;\n\n@Controller()\nexport class AppController &#123;\n  constructor(private readonly authService: AuthService) &#123;&#125;\n\n  @UseGuards(LocalAuthGuard)\n  @Post(&#39;auth/login&#39;)\n  async login(@Request() req) &#123;\n    return this.authService.login(req.user);\n  &#125;\n\n  @UseGuards(JwtAuthGuard)\n  @Get(&#39;profile&#39;)\n  getProfile(@Request() req) &#123;\n    return req.user;\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appfd1260d8edfdd2676949a8fcb940c4d3fe6daa82.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Controller, Bind, Get, Request, Post, UseGuards &#125; from &#39;@nestjs/common&#39;;\nimport &#123; JwtAuthGuard &#125; from &#39;./auth/jwt-auth.guard&#39;;\nimport &#123; LocalAuthGuard &#125; from &#39;./auth/local-auth.guard&#39;;\nimport &#123; AuthService &#125; from &#39;./auth/auth.service&#39;;\n\n@Controller()\nexport class AppController &#123;\n  constructor(private readonly authService: AuthService) &#123;&#125;\n\n  @UseGuards(LocalAuthGuard)\n  @Post(&#39;auth/login&#39;)\n  @Bind(Req())\n  async login(req) &#123;\n    return this.authService.login(req.user);\n  &#125;\n\n  @UseGuards(JwtAuthGuard)\n  @Get(&#39;profile&#39;)\n  @Bind(Req())\n  getProfile(req) &#123;\n    return req.user;\n  &#125;\n&#125;</code></pre><p>Once again, we&#39;re applying the <code>AuthGuard</code> that the <code>@nestjs/passport</code> module has automatically provisioned for us when we configured the passport-jwt module. This Guard is referenced by its default name, <code>jwt</code>. When our <code>GET /profile</code> route is hit, the Guard will automatically invoke our passport-jwt custom configured logic, validating the JWT, and assigning the <code>user</code> property to the <code>Request</code> object.</p>\n<p>Ensure the app is running, and test the routes using <code>cURL</code>.</p>\n<pre><code class=\"language-bash\">\n$ # GET /profile\n$ curl http://localhost:3000/profile\n$ # result -&gt; &#123;&quot;statusCode&quot;:401,&quot;error&quot;:&quot;Unauthorized&quot;&#125;\n\n$ # POST /auth/login\n$ curl -X POST http://localhost:3000/auth/login -d &#39;&#123;&quot;username&quot;: &quot;john&quot;, &quot;password&quot;: &quot;changeme&quot;&#125;&#39; -H &quot;Content-Type: application/json&quot;\n$ # result -&gt; &#123;&quot;access_token&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2Vybm... &#125;\n\n$ # GET /profile using access_token returned from previous step as bearer code\n$ curl http://localhost:3000/profile -H &quot;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2Vybm...&quot;\n$ # result -&gt; &#123;&quot;userId&quot;:1,&quot;username&quot;:&quot;john&quot;&#125;</code></pre>\n<p>Note that in the <code>AuthModule</code>, we configured the JWT to have an expiration of <code>60 seconds</code>. This is probably too short an expiration, and dealing with the details of token expiration and refresh is beyond the scope of this article. However, we chose that to demonstrate an important quality of JWTs and the passport-jwt strategy. If you wait 60 seconds after authenticating before attempting a <code>GET /profile</code> request, you&#39;ll receive a <code>401 Unauthorized</code> response. This is because Passport automatically checks the JWT for its expiration time, saving you the trouble of doing so in your application.</p>\n<p>We&#39;ve now completed our JWT authentication implementation. JavaScript clients (such as Angular/React/Vue), and other JavaScript apps, can now authenticate and communicate securely with our API Server. You can find a complete version of the code in this chapter <a routerLink=\"\">here</a>.</p>\n<p><app-banner-enterprise></app-banner-enterprise></p>\n<h4 appAnchor id=\"default-strategy\"><span>Default strategy</span></h4>\n<p>In our <code>AppController</code>, we pass the name of the strategy in the <code>@AuthGuard()</code> decorator. We need to do this because we&#39;ve introduced <strong>two</strong> Passport strategies (passport-local and passport-jwt), both of which supply implementations of various Passport components. Passing the name disambiguates which implementation we&#39;re linking to. When multiple strategies are included in an application, we can declare a default strategy so that we no longer have to pass the name in the <code>@AuthGuard</code> decorator if using that default strategy. Here&#39;s how to register a default strategy when importing the <code>PassportModule</code>. This code would go in the <code>AuthModule</code>:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthService &#125; from &#39;./auth.service&#39;;\nimport &#123; LocalStrategy &#125; from &#39;./local.strategy&#39;;\nimport &#123; UsersModule &#125; from &#39;../users/users.module&#39;;\nimport &#123; PassportModule &#125; from &#39;@nestjs/passport&#39;;\nimport &#123; JwtModule &#125; from &#39;@nestjs/jwt&#39;;\nimport &#123; jwtConstants &#125; from &#39;./constants&#39;;\nimport &#123; JwtStrategy &#125; from &#39;./jwt.strategy&#39;;\n\n@Module(&#123;\n  imports: [\n    PassportModule.register(&#123; defaultStrategy: &#39;jwt&#39; &#125;),\n    JwtModule.register(&#123;\n      secret: jwtConstants.secret,\n      signOptions: &#123; expiresIn: &#39;60s&#39; &#125;,\n    &#125;),\n    UsersModule,\n  ],\n  providers: [AuthService, LocalStrategy, JwtStrategy],\n  exports: [AuthService],\n&#125;)\nexport class AuthModule &#123;&#125;</code></pre>\n<h4 appAnchor id=\"request-scoped-strategies\"><span>Request-scoped strategies</span></h4>\n<p>The passport API is based on registering strategies to the global instance of the library. Therefore strategies are not designed to have request-dependent options or to be dynamically instantiated per request (read more about the <a routerLink=\"/fundamentals/injection-scopes\">request-scoped</a> providers). When you configure your strategy to be request-scoped, Nest will never instantiate it since it&#39;s not tied to any specific route. There is no physical way to determine which &quot;request-scoped&quot; strategies should be executed per request.</p>\n<p>However, there are ways to dynamically resolve request-scoped providers within the strategy. For this, we leverage the <a routerLink=\"/fundamentals/module-ref\">module reference</a> feature.</p>\n<p>First, open the <code>local.strategy.ts</code> file and inject the <code>ModuleRef</code> in the normal way:</p>\n<pre><code class=\"language-typescript\">\nconstructor(private readonly moduleRef: ModuleRef) &#123;\n  super(&#123;\n    passReqToCallback: true,\n  &#125;);\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>ModuleRef</code> class is imported from the <code>@nestjs/core</code> package.\n</blockquote>\n<p>Be sure to set the <code>passReqToCallback</code> configuration property to <code>true</code>, as shown above.</p>\n<p>In the next step, the request instance will be used to obtain the current context identifier, instead of generating a new one (read more about request context <a href=\"/fundamentals/module-ref#getting-current-sub-tree\">here</a>).</p>\n<p>Now, inside the <code>validate()</code> method of the <code>LocalStrategy</code> class, use the <code>getByRequest()</code> method of the <code>ContextIdFactory</code> class to create a context id based on the request object, and pass this to the <code>resolve()</code> call:</p>\n<pre><code class=\"language-typescript\">\nasync validate(\n  request: Request,\n  username: string,\n  password: string,\n) &#123;\n  const contextId = ContextIdFactory.getByRequest(request);\n  // &quot;AuthService&quot; is a request-scoped provider\n  const authService = await this.moduleRef.resolve(AuthService, contextId);\n  ...\n&#125;</code></pre>\n<p>In the example above, the <code>resolve()</code> method will asynchronously return the request-scoped instance of the <code>AuthService</code> provider (we assumed that <code>AuthService</code> is marked as a request-scoped provider).</p>\n<h4 appAnchor id=\"extending-guards\"><span>Extending guards</span></h4>\n<p>In most cases, using a provided <code>AuthGuard</code> class is sufficient. However, there might be use-cases when you would like to simply extend the default error handling or authentication logic. For this, you can extend the built-in class and override methods within a sub-class.</p>\n<pre><code class=\"language-typescript\">\nimport &#123;\n  ExecutionContext,\n  Injectable,\n  UnauthorizedException,\n&#125; from &#39;@nestjs/common&#39;;\nimport &#123; AuthGuard &#125; from &#39;@nestjs/passport&#39;;\n\n@Injectable()\nexport class JwtAuthGuard extends AuthGuard(&#39;jwt&#39;) &#123;\n  canActivate(context: ExecutionContext) &#123;\n    // Add your custom authentication logic here\n    // for example, call super.logIn(request) to establish a session.\n    return super.canActivate(context);\n  &#125;\n\n  handleRequest(err, user, info) &#123;\n    // You can throw an exception based on either &quot;info&quot; or &quot;err&quot; arguments\n    if (err || !user) &#123;\n      throw err || new UnauthorizedException();\n    &#125;\n    return user;\n  &#125;\n&#125;</code></pre>\n<h4 appAnchor id=\"customize-passport\"><span>Customize Passport</span></h4>\n<p>Any standard Passport customization options can be passed the same way, using the <code>register()</code> method. The available options depend on the strategy being implemented. For example:</p>\n<pre><code class=\"language-typescript\">\nPassportModule.register(&#123; session: true &#125;);</code></pre>\n<p>You can also pass strategies an options object in their constructors to configure them.\nFor the local strategy you can pass e.g.:</p>\n<pre><code class=\"language-typescript\">\nconstructor(private readonly authService: AuthService) &#123;\n  super(&#123;\n    usernameField: &#39;email&#39;,\n    passwordField: &#39;password&#39;,\n  &#125;);\n&#125;</code></pre>\n<p>Take a look at the official <a rel='nofollow' target='_blank' href=\"http://www.passportjs.org/docs/oauth/\">Passport Website</a> for property names.</p>\n<h4 appAnchor id=\"named-strategies\"><span>Named strategies</span></h4>\n<p>When implementing a strategy, you can provide a name for it by passing a second argument to the <code>PassportStrategy</code> function. If you don&#39;t do this, each strategy will have a default name (e.g., &#39;jwt&#39; for jwt-strategy):</p>\n<pre><code class=\"language-typescript\">\nexport class JwtStrategy extends PassportStrategy(Strategy, &#39;myjwt&#39;)</code></pre>\n<p>Then, you refer to this via a decorator like <code>@AuthGuard(&#39;myjwt&#39;)</code>.</p>\n<h4 appAnchor id=\"graphql\"><span>GraphQL</span></h4>\n<p>In order to use an AuthGuard with <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/graphql/quick-start\">GraphQL</a>, extend the built-in AuthGuard class and override the getRequest() method.</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nexport class GqlAuthGuard extends AuthGuard(&#39;jwt&#39;) &#123;\n  getRequest(context: ExecutionContext) &#123;\n    const ctx = GqlExecutionContext.create(context);\n    return ctx.getContext().req;\n  &#125;\n&#125;</code></pre>\n<p>To use the above construct, be sure to pass the request (<code>req</code>) object as part of the context value in the GraphQL Module settings:</p>\n<pre><code class=\"language-typescript\">\nGraphQLModule.forRoot(&#123;\n  context: (&#123; req &#125;) =&gt; (&#123; req &#125;),\n&#125;);</code></pre>\n<p>To get the current authenticated user in your graphql resolver, you can define a User decorator:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; createParamDecorator &#125; from &#39;@nestjs/common&#39;;\n\nexport const CurrentUser = createParamDecorator(\n  (data, [root, args, ctx, info]) =&gt; ctx.req.user,\n);</code></pre>\n<p>To use above decorator in your resolver, be sure to include it as a parameter of your query or mutation:</p>\n<pre><code class=\"language-typescript\">\n@Query(returns =&gt; User)\n@UseGuards(GqlAuthGuard)\nwhoAmI(@CurrentUser() user: User) &#123;\n  return this.userService.findById(user.id);\n&#125;</code></pre>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-caching',\n  templateUrl: './caching.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CachingComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/caching.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"caching\">Caching</h3>\n<p>Caching is a great and simple <strong>technique</strong> that helps improve your app&#39;s performance. It acts as a temporary data store providing high performance data access.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>First install the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm install --save cache-manager</code></pre>\n<h4 appAnchor id=\"in-memory-cache\"><span>In-memory cache</span></h4>\n<p>Nest provides a unified API for various cache storage providers. The built-in one is an in-memory data store. However, you can easily switch to a more comprehensive solution, like Redis. In order to enable caching, first import the <code>CacheModule</code> and call its <code>register()</code> method.</p>\n<pre><code class=\"language-typescript\">\nimport &#123; CacheModule, Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AppController &#125; from &#39;./app.controller&#39;;\n\n@Module(&#123;\n  imports: [CacheModule.register()],\n  controllers: [AppController],\n&#125;)\nexport class ApplicationModule &#123;&#125;</code></pre>\n<p>Then just tie the <code>CacheInterceptor</code> where you want to cache data.</p>\n<pre><code class=\"language-typescript\">\n@Controller()\n@UseInterceptors(CacheInterceptor)\nexport class AppController &#123;\n  @Get()\n  findAll(): string[] &#123;\n    return [];\n  &#125;\n&#125;</code></pre>\n<blockquote class=\"\nwarning\"><strong>Warning</strong> Only <code>GET</code> endpoints are cached. Also, HTTP server routes that inject the native response object (<code>@Res()</code>) cannot use the Cache Interceptor. See\n<a href=\"https://docs.nestjs.com/interceptors#response-mapping\">response mapping</a> for more details.\n</blockquote>\n<h4 appAnchor id=\"global-cache\"><span>Global cache</span></h4>\n<p>To reduce the amount of required boilerplate, you can bind <code>CacheInterceptor</code> to all endpoints globally:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; CacheModule, Module, CacheInterceptor &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AppController &#125; from &#39;./app.controller&#39;;\nimport &#123; APP_INTERCEPTOR &#125; from &#39;@nestjs/core&#39;;\n\n@Module(&#123;\n  imports: [CacheModule.register()],\n  controllers: [AppController],\n  providers: [\n    &#123;\n      provide: APP_INTERCEPTOR,\n      useClass: CacheInterceptor,\n    &#125;,\n  ],\n&#125;)\nexport class ApplicationModule &#123;&#125;</code></pre>\n<h4 appAnchor id=\"customize-caching\"><span>Customize caching</span></h4>\n<p>All cached data has its own expiration time (TTL). To customize default values, pass the options object to the <code>register()</code> method.</p>\n<pre><code class=\"language-typescript\">\nCacheModule.register(&#123;\n  ttl: 5, // seconds\n  max: 10, // maximum number of items in cache\n&#125;);</code></pre>\n<h4 appAnchor id=\"global-cache-overrides\"><span>Global cache overrides</span></h4>\n<p>While global cache is enabled, cache entries are stored under a <code>CacheKey</code> that is auto-generated based on the route path. You may override certain cache settings (<code>@CacheKey()</code> and <code>@CacheTTL()</code>) on a per-method basis, allowing customized caching strategies for individual controller methods. This may be most relevant while using <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/techniques/caching#different-stores\">different cache stores.</a></p>\n<pre><code class=\"language-typescript\">\n@Controller()\nexport class AppController &#123;\n  @CacheKey(&#39;custom_key&#39;)\n  @CacheTTL(20)\n  findAll(): string[] &#123;\n    return [];\n  &#125;\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>@CacheKey()</code> and <code>@CacheTTL()</code> decorators are imported from the <code>@nestjs/common</code> package.\n</blockquote>\n<p>The <code>@CacheKey()</code> decorator may be used with or without a corresponding <code>@CacheTTL()</code> decorator and vice versa. One may choose to override only the <code>@CacheKey()</code> or only the <code>@CacheTTL()</code>. Settings that are not overridden with a decorator will use the default values as registered globally (see <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/techniques/caching#customize-caching\">Customize caching</a>).</p>\n<h4 appAnchor id=\"websockets--microservices\"><span>WebSockets &amp; Microservices</span></h4>\n<p>You can also apply the <code>CacheInterceptor</code> to WebSocket subscribers as well as Microservice&#39;s patterns (regardless of the transport method that is being used).</p>\n\n<span class=\"filename\">\n<app-tabs #app190aff18b72044e3f863d2a64dfcc3b55159e645></app-tabs>\n</span><pre [class.hide]=\"app190aff18b72044e3f863d2a64dfcc3b55159e645.isJsActive\"><code class=\"language-typescript\">\n@CacheKey(&#39;events&#39;)\n@UseInterceptors(CacheInterceptor)\n@SubscribeMessage(&#39;events&#39;)\nhandleEvent(client: Client, data: string[]): Observable&lt;string[]&gt; &#123;\n  return [];\n&#125;</code></pre>\n<pre [class.hide]=\"!app190aff18b72044e3f863d2a64dfcc3b55159e645.isJsActive\"><code class=\"language-typescript\">\n@CacheKey(&#39;events&#39;)\n@UseInterceptors(CacheInterceptor)\n@SubscribeMessage(&#39;events&#39;)\nhandleEvent(client, data) &#123;\n  return [];\n&#125;</code></pre><p>However, the additional <code>@CacheKey()</code> decorator is required in order to specify a key used to subsequently store and retrieve cached data. Also, please note that you <strong>shouldn&#39;t cache everything</strong>. Actions which perform some business operations rather than simply querying the data should never be cached.</p>\n<p>Additionally, you may specify a cache expiration time (TTL) by using the <code>@CacheTTL()</code> decorator, which will override the global default TTL value.</p>\n\n<span class=\"filename\">\n<app-tabs #app3751b1064c9a0af170bb875fb43f30c072ea9cec></app-tabs>\n</span><pre [class.hide]=\"app3751b1064c9a0af170bb875fb43f30c072ea9cec.isJsActive\"><code class=\"language-typescript\">\n@CacheTTL(10)\n@UseInterceptors(CacheInterceptor)\n@SubscribeMessage(&#39;events&#39;)\nhandleEvent(client: Client, data: string[]): Observable&lt;string[]&gt; &#123;\n  return [];\n&#125;</code></pre>\n<pre [class.hide]=\"!app3751b1064c9a0af170bb875fb43f30c072ea9cec.isJsActive\"><code class=\"language-typescript\">\n@CacheTTL(10)\n@UseInterceptors(CacheInterceptor)\n@SubscribeMessage(&#39;events&#39;)\nhandleEvent(client, data) &#123;\n  return [];\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>@CacheTTL()</code> decorator may be used with or without a corresponding <code>@CacheKey()</code> decorator. \n</blockquote>\n<h4 appAnchor id=\"different-stores\"><span>Different stores</span></h4>\n<p>This service takes advantage of <a rel='nofollow' target='_blank' href=\"https://github.com/BryanDonovan/node-cache-manager\">cache-manager</a> under the hood. The <code>cache-manager</code> package supports a wide-range of useful stores, for example, <a rel='nofollow' target='_blank' href=\"https://github.com/dabroek/node-cache-manager-redis-store\">Redis</a> store. A full list of supported stores is available <a rel='nofollow' target='_blank' href=\"https://github.com/BryanDonovan/node-cache-manager#store-engines\">here</a>. To set up the Redis store, simple pass the package together with corresponding options to the <code>register()</code> method.</p>\n<pre><code class=\"language-typescript\">\nimport * as redisStore from &#39;cache-manager-redis-store&#39;;\nimport &#123; CacheModule, Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; AppController &#125; from &#39;./app.controller&#39;;\n\n@Module(&#123;\n  imports: [\n    CacheModule.register(&#123;\n      store: redisStore,\n      host: &#39;localhost&#39;,\n      port: 6379,\n    &#125;),\n  ],\n  controllers: [AppController],\n&#125;)\nexport class ApplicationModule &#123;&#125;</code></pre>\n<h4 appAnchor id=\"adjust-tracking\"><span>Adjust tracking</span></h4>\n<p>By default, Nest uses the request URL (in an HTTP app) or cache key (in websockets and microservices apps, set through the <code>@CacheKey()</code> decorator) to associate cache records with your endpoints. Nevertheless, sometimes you might want to set up tracking based on different factors, for example, using HTTP headers (e.g. <code>Authorization</code> to properly identify <code>profile</code> endpoints).</p>\n<p>In order to accomplish that, create a subclass of <code>CacheInterceptor</code> and override the <code>trackBy()</code> method.</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nclass HttpCacheInterceptor extends CacheInterceptor &#123;\n  trackBy(context: ExecutionContext): string | undefined &#123;\n    return &#39;key&#39;;\n  &#125;\n&#125;</code></pre>\n<h4 appAnchor id=\"async-configuration\"><span>Async configuration</span></h4>\n<p>You may want to asynchronously pass in module options instead of passing them statically at compile time. In this case, use the <code>registerAsync()</code> method, which provides several ways to deal with async configuration.</p>\n<p>One approach is to use a factory function:</p>\n<pre><code class=\"language-typescript\">\nCacheModule.registerAsync(&#123;\n  useFactory: () =&gt; (&#123;\n    ttl: 5,\n  &#125;),\n&#125;);</code></pre>\n<p>Our factory behaves like all other asynchronous module factories (it can be <code>async</code> and is able to inject dependencies through <code>inject</code>).</p>\n<pre><code class=\"language-typescript\">\nCacheModule.registerAsync(&#123;\n  imports: [ConfigModule],\n  useFactory: async (configService: ConfigService) =&gt; (&#123;\n    ttl: configService.getString(&#39;CACHE_TTL&#39;),\n  &#125;),\n  inject: [ConfigService],\n&#125;);</code></pre>\n<p>Alternatively, you can use the <code>useClass</code> method:</p>\n<pre><code class=\"language-typescript\">\nCacheModule.registerAsync(&#123;\n  useClass: CacheConfigService,\n&#125;);</code></pre>\n<p>The above construction will instantiate <code>CacheConfigService</code> inside <code>CacheModule</code> and will use it to get the options object. The <code>CacheConfigService</code> has to implement the <code>CacheOptionsFactory</code> interface in order to provide the configuration options:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nclass CacheConfigService implements CacheOptionsFactory &#123;\n  createCacheOptions(): CacheModuleOptions &#123;\n    return &#123;\n      ttl: 5,\n    &#125;;\n  &#125;\n&#125;</code></pre>\n<p>If you wish to use an existing configuration provider imported from a different module, use the <code>useExisting</code> syntax:</p>\n<pre><code class=\"language-typescript\">\nCacheModule.registerAsync(&#123;\n  imports: [ConfigModule],\n  useExisting: ConfigService,\n&#125;);</code></pre>\n<p>This works the same as <code>useClass</code> with one critical difference - <code>CacheModule</code> will lookup imported modules to reuse any already-created <code>ConfigService</code>, instead of instantiating its own.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-compression',\n  templateUrl: './compression.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CompressionComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/compression.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"compression\">Compression</h3>\n<p>Compression can greatly decrease the size of the response body, thereby increasing the speed of a web app. Use the <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/compression\">compression</a> middleware package to enable gzip compression.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>First install the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save compression</code></pre>\n<p>Once the installation is complete, apply the compression middleware as global middleware.</p>\n<pre><code class=\"language-typescript\">\nimport * as compression from &#39;compression&#39;;\n// somewhere in your initialization file\napp.use(compression());</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> If using the <code>FastifyAdapter</code>, consider using <a rel='nofollow' target='_blank' href=\"https://github.com/fastify/fastify-compress\">fastify-compress</a> instead.\n</blockquote>\n<p>For <strong>high-traffic</strong> websites in production, it is strongly recommended to offload compression from the application server - typically in a reverse proxy (e.g., Nginx). In that case, you should not use compression middleware.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-configuration',\n  templateUrl: './configuration.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ConfigurationComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/configuration.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"configuration\">Configuration</h3>\n<p>Applications often run in different <strong>environments</strong>. Depending on the environment, different configuration settings should be used. For example, usually the local environment relies on specific database credentials, valid only for the local DB instance. The production environment would use a separate set of DB credentials. Since configuration variables change, best practice is to <a rel='nofollow' target='_blank' href=\"https://12factor.net/config\">store configuration variables</a> in the environment.</p>\n<p>Externally defined environment variables are visible inside Node.js through the <code>process.env</code> global. We could try to solve the problem of multiple environments by setting the environment variables separately in each environment. This can quickly get unwieldy, especially in the development and testing environments where these values need to be easily mocked and/or changed.</p>\n<p>In Node.js applications, it&#39;s common to use <code>.env</code> files, holding key-value pairs where each key represents a particular value, to represent each environment. Running an app in different environments is then just a matter of swapping in the correct <code>.env</code> file.</p>\n<p>A good approach for using this technique in Nest is to create a <code>ConfigModule</code> that exposes a <code>ConfigService</code> which loads the appropriate <code>.env</code> file. While you may choose to write such a module yourself, for convenience Nest provides the <code>@nestjs/config</code> package out-of-the box. We&#39;ll cover this package in the current chapter.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To begin using it, we first install the required dependency.</p>\n<pre><code class=\"language-bash\">\n$ npm i --save @nestjs/config</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>@nestjs/config</code> package internally uses <a rel='nofollow' target='_blank' href=\"https://github.com/motdotla/dotenv\">dotenv</a>.\n</blockquote>\n<h4 appAnchor id=\"getting-started\"><span>Getting started</span></h4>\n<p>Once the installation process is complete, we can import the <code>ConfigModule</code>. Typically, we&#39;ll import it into the root <code>AppModule</code> and control its behavior using the <code>.forRoot()</code> static method. During this step, environment variable key/value pairs are parsed and resolved. Later, we&#39;ll see several options for accessing the <code>ConfigService</code> class of the <code>ConfigModule</code> in our other feature modules.</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app102a865b25be55b4e31f19a2c5e75e37a25213d6.isJsActive }}\n<app-tabs #app102a865b25be55b4e31f19a2c5e75e37a25213d6></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; ConfigModule &#125; from &#39;@nestjs/config&#39;;\n\n@Module(&#123;\n  imports: [ConfigModule.forRoot()],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>The above code will load and parse a <code>.env</code> file from the default location (the project root directory), merge key/value pairs from the <code>.env</code> file with environment variables assigned to <code>process.env</code>, and store the result in a private structure that you can access through the <code>ConfigService</code>. The <code>forRoot()</code> method registers the <code>ConfigService</code> provider, which provides a <code>get()</code> method for reading these parsed/merged configuration variables. Since <code>@nestjs/config</code> relies on <a rel='nofollow' target='_blank' href=\"https://github.com/motdotla/dotenv\">dotenv</a>, it uses that package&#39;s rules for resolving conflicts in environment variable names. When a key exists both in the runtime environment as an environment variable (e.g., via OS shell exports like <code>export DATABASE_USER=test</code>) and in a <code>.env</code> file, the runtime environment variable takes precedence.</p>\n<p>A sample <code>.env</code> file looks something like this:</p>\n<pre><code class=\"language-json\">\nDATABASE_USER=test\nDATABASE_PASSWORD=test</code></pre>\n<h4 appAnchor id=\"custom-env-file-path\"><span>Custom env file path</span></h4>\n<p>By default, the package looks for a <code>.env</code> file in the root directory of the application. To specify another path for the <code>.env</code> file, set the <code>envFilePath</code> property of an (optional) options object you pass to <code>forRoot()</code>, as follows:</p>\n<pre><code class=\"language-typescript\">\nConfigModule.forRoot(&#123;\n  envFilePath: &#39;.development.env&#39;,\n&#125;);</code></pre>\n<h4 appAnchor id=\"disable-env-variables-loading\"><span>Disable env variables loading</span></h4>\n<p>If you don&#39;t want to load the <code>.env</code> file, but instead would like to simply access environment variables from the runtime environment (as with OS shell exports like <code>export DATABASE_USER=test</code>), set the options object&#39;s <code>ignoreEnvFile</code> property to <code>true</code>, as follows:</p>\n<pre><code class=\"language-typescript\">\nConfigModule.forRoot(&#123;\n  ignoreEnvFile: true,\n&#125;);</code></pre>\n<h4 appAnchor id=\"use-module-globally\"><span>Use module globally</span></h4>\n<p>When you want to use <code>ConfigModule</code> in other modules, you&#39;ll need to import it (as is standard with any Nest module). Alternatively, declare it as a <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/modules#global-modules\">global module</a> by setting the options object&#39;s <code>isGlobal</code> property to <code>true</code>, as shown below. In that case, you will not need to import <code>ConfigModule</code> in other modules once it&#39;s been loaded in the root module (e.g., <code>AppModule</code>).</p>\n<pre><code class=\"language-typescript\">\nConfigModule.forRoot(&#123;\n  isGlobal: true,\n&#125;);</code></pre>\n<h4 appAnchor id=\"custom-configuration-files\"><span>Custom configuration files</span></h4>\n<p>For more complex projects, you may utilize custom configuration files to return nested configuration objects. This allows you to group related configuration settings by function (e.g., database-related settings), and to store related settings in individual files to help manage them independently.</p>\n<p>A custom configuration file exports a factory function that returns a configuration object. The configuration object can be any arbitrarily nested plain JavaScript object. The <code>process.env</code> object will contain the fully resolved environment variable key/value pairs (with <code>.env</code> file and externally defined variables resolved and merged as described <a href=\"techniques/configuration#getting-started\">above</a>). Since you control the returned configuration object, you can add any required logic to cast values to an appropriate type, set default values, etc. For example:</p>\n\n<span class=\"filename\">\n  {{ 'config/configuration' | extension: appeaec38ab041575a09f71d828d8363e00948f3049.isJsActive }}\n<app-tabs #appeaec38ab041575a09f71d828d8363e00948f3049></app-tabs>\n</span><pre><code class=\"language-typescript\">\nexport default () =&gt; (&#123;\n  port: parseInt(process.env.PORT, 10) || 3000,\n  database: &#123;\n    host: process.env.DATABASE_HOST,\n    port: parseInt(process.env.DATABASE_PORT, 10) || 5432\n  &#125;\n&#125;);</code></pre><p>We load this file using the <code>load</code> property of the options object we pass to the <code>ConfigModule.forRoot()</code> method:</p>\n<pre><code class=\"language-typescript\">\nimport configuration from &#39;./config/configuration&#39;;\n\n@Module(&#123;\n  imports: [\n    ConfigModule.forRoot(&#123;\n      load: [configuration],\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Notice</strong> The value assigned to the <code>load</code> property is an array, allowing you to load multiple configuration files (e.g. <code>load: [databaseConfig, authConfig]</code>)\n</blockquote>\n<p><app-banner-enterprise></app-banner-enterprise></p>\n<h4 appAnchor id=\"using-the-configservice\"><span>Using the <code>ConfigService</code></span></h4>\n<p>To access configuration values from our <code>ConfigService</code>, we first need to inject <code>ConfigService</code>. As with any provider, we need to import its containing module - the <code>ConfigModule</code> - into the module that will use it (unless you set the <code>isGlobal</code> property in the options object passed to the <code>ConfigModule.forRoot()</code> method to <code>true</code>). Import it into a feature module as shown below.</p>\n\n<span class=\"filename\">\n  {{ 'feature.module' | extension: appebc25bfb59dbf1503a31cd5639a104d8613fedbe.isJsActive }}\n<app-tabs #appebc25bfb59dbf1503a31cd5639a104d8613fedbe></app-tabs>\n</span><pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [ConfigModule],\n  // ...\n&#125;)</code></pre><p>Then we can inject it using standard constructor injection:</p>\n<pre><code class=\"language-typescript\">\nconstructor(private readonly configService: ConfigService) &#123;&#125;</code></pre>\n<p>And use it in our class:</p>\n<pre><code class=\"language-typescript\">\n// get an environment variable\nconst dbUser = this.configService.get&lt;string&gt;(&#39;DATABASE_USER&#39;);\n\n// get a custom configuration value\nconst dbHost = this.configService.get&lt;string&gt;(&#39;database.host&#39;);</code></pre>\n<p>As shown above, use the <code>configService.get()</code> method to get a simple environment variable by passing the variable name. You can do TypeScript type hinting by passing the type, as shown above (e.g., <code>get&lt;string&gt;(...)</code>). The <code>get()</code> method can also traverse a nested custom configuration object (created via a <a href=\"techniques/configuration#custom-configuration-files\">Custom configuration file</a>, as shown in the second example above. The <code>get()</code> method also takes an optional second argument defining a default value, which will be returned when the key doesn&#39;t exist, as shown below:</p>\n<pre><code class=\"language-typescript\">\n// use &quot;localhost&quot; when &quot;database.host&quot; is not defined\nconst dbHost = this.configService.get&lt;string&gt;(&#39;database.host&#39;, &#39;localhost&#39;);</code></pre>\n<h4 appAnchor id=\"configuration-namespaces\"><span>Configuration namespaces</span></h4>\n<p>The <code>ConfigModule</code> allows you to define and load multiple custom configuration files, as shown in <a href=\"techniques/configuration#custom-configuration-files\">Custom configuration files</a> above. You can manage complex configuration object hierarchies with nested configuration objects as shown in that section. Alternatively, you can return a &quot;namespaced&quot; configuration object with the <code>registerAs()</code> function as follows:</p>\n\n<span class=\"filename\">\n  {{ 'config/database.config' | extension: appb6957802abe844c2be3d4ffe7816e1c77c0b24fb.isJsActive }}\n<app-tabs #appb6957802abe844c2be3d4ffe7816e1c77c0b24fb></app-tabs>\n</span><pre><code class=\"language-typescript\">\nexport default registerAs(&#39;database&#39;, () =&gt; (&#123;\n  host: process.env.DATABASE_HOST,\n  port: process.env.DATABASE_PORT || 5432\n&#125;));</code></pre><p>As with custom configuration files, inside your <code>registerAs()</code> factory function, the <code>process.env</code> object will contain the fully resolved environment variable key/value pairs (with <code>.env</code> file and externally defined variables resolved and merged as described <a href=\"techniques/configuration#getting-started\">above</a>).</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>registerAs</code> function is exported from the <code>@nestjs/config</code> package.\n</blockquote>\n<p>Load a namespaced configuration with the <code>load</code> property of the <code>forRoot()</code> method&#39;s options object, in the same way you load a custom configuration file:</p>\n<pre><code class=\"language-typescript\">\nimport databaseConfig from &#39;./config/database.config&#39;;\n\n@Module(&#123;\n  imports: [\n    ConfigModule.forRoot(&#123;\n      load: [databaseConfig],\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<p>Now, to get the <code>host</code> value from the <code>database</code> namespace, use dot notation. Use <code>&#39;database&#39;</code> as the prefix to the property name, corresponding to the name of the namespace (passed as the first argument to the <code>registerAs()</code> function):</p>\n<pre><code class=\"language-typescript\">\nconst dbHost = this.configService.get&lt;string&gt;(&#39;database.host&#39;);</code></pre>\n<p>A reasonable alternative is to inject the <code>database</code> namespace directly. This allows us to benefit from strong typing:</p>\n<pre><code class=\"language-typescript\">\nconstructor(\n  @Inject(databaseConfig.KEY)\n  private databaseConfig: ConfigType&lt;typeof databaseConfig&gt;,\n) &#123;&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>ConfigType</code> is exported from the <code>@nestjs/config</code> package.\n</blockquote>\n<h4 appAnchor id=\"partial-registration\"><span>Partial registration</span></h4>\n<p>Thus far, we&#39;ve processed configuration files in our root module (e.g., <code>AppModule</code>), with the <code>forRoot()</code> method. Perhaps you have a more complex project structure, with feature-specific configuration files located in multiple different directories. Rather than load all these files in the root module, the <code>@nestjs/config</code> package provides a feature called <strong>partial registration</strong>, which references only the configuration files associated with each feature module. Use the <code>forFeature()</code> static method within a feature module to perform this partial registration, as follows:</p>\n<pre><code class=\"language-typescript\">\nimport databaseConfig from &#39;./config/database.config&#39;;\n\n@Module(&#123;\n  imports: [ConfigModule.forFeature(databaseConfig)],\n&#125;)\nexport class DatabaseModule &#123;&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Warning</strong> In some circumstances, you may need to access properties loaded via partial registration using the <code>onModuleInit()</code> hook, rather than in a constructor. This is because the <code>forFeature()</code> method is run during module initialization, and the order of module initialization is indeterminate. If you access values loaded this way by another module, in a constructor, the module that the configuration depends upon may not yet have initialized. The <code>onModuleInit()</code> method runs only after all modules it depends upon have been initialized, so this technique is safe.\n</blockquote>\n<h4 appAnchor id=\"schema-validation\"><span>Schema validation</span></h4>\n<p>It is standard practice to throw an exception during application startup if required environment variables haven&#39;t been provided or if they don&#39;t meet certain validation rules. The <code>@nestjs/config</code> package enables use of the <a rel='nofollow' target='_blank' href=\"https://github.com/hapijs/joi\">Joi</a> npm package to support this type of validation. With Joi, you define an object schema and validate JavaScript objects against it.</p>\n<p>Install Joi (and its types, for <strong>TypeScript</strong> users):</p>\n<pre><code class=\"language-bash\">\n$ npm install --save @hapi/joi\n$ npm install --save-dev @types/hapi__joi</code></pre>\n<blockquote class=\"\nwarning \"><strong>Notice</strong> The latest version of <code>@hapi/joi</code> requires you to be running Node v12 or later. For older versions of node, please install <code>v16.1.8</code>. This is mainly after the release of <code>v17.0.2</code> which causes errors during build time. For more information, please refer to <a rel='nofollow' target='_blank' href=\"https://hapi.dev/family/joi/?v=17.0.2#install\">their documentation</a> &amp; this <a rel='nofollow' target='_blank' href=\"https://github.com/hapijs/joi/issues/2266#issuecomment-571667769\">github issue</a>.\n</blockquote>\n<p>Now we can define a Joi validation schema and pass it via the <code>validationSchema</code> property of the <code>forRoot()</code> method&#39;s options object, as shown below:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app3b826a30df37833d7411f31a2fb6b27fa66c11fe.isJsActive }}\n<app-tabs #app3b826a30df37833d7411f31a2fb6b27fa66c11fe></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport * as Joi from &#39;@hapi/joi&#39;;\n\n@Module(&#123;\n  imports: [\n    ConfigModule.forRoot(&#123;\n      validationSchema: Joi.object(&#123;\n        NODE_ENV: Joi.string()\n          .valid(&#39;development&#39;, &#39;production&#39;, &#39;test&#39;, &#39;provision&#39;)\n          .default(&#39;development&#39;),\n        PORT: Joi.number().default(3000),\n      &#125;),\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>By default, all schema keys are considered optional. Here, we set default values for <code>NODE_ENV</code> and <code>PORT</code> which will be used if we don&#39;t provide these variables in the environment (<code>.env</code> file or process environment). Alternatively, we can use the <code>required()</code> validation method to require that a value must be defined in the environment (<code>.env</code> file or process environment). In this case, the validation step will throw an exception if we don&#39;t provide the variable in the environment. See <a rel='nofollow' target='_blank' href=\"https://hapi.dev/family/joi/?v=17.0.2#example\">Joi validation methods</a> for more on how to construct validation schemas.</p>\n<p>By default, unknown environment variables (environment variables whose keys are not present in the schema) are allowed and do not trigger a validation exception. By default, all validation errors are reported. You can alter these behaviors by passing an options object via the <code>validationOptions</code> key of the <code>forRoot()</code> options object. This options object can contain any of the standard validation options properties provided by <a rel='nofollow' target='_blank' href=\"https://hapi.dev/family/joi/api/?v=17.0.2#anyvalidvalues---aliases-equal\">Joi validation options</a>. For example, to reverse the two settings above, pass options like this:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app0ed6cebf0bc99ec0dc50c1fde9119b50cb100fdc.isJsActive }}\n<app-tabs #app0ed6cebf0bc99ec0dc50c1fde9119b50cb100fdc></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport * as Joi from &#39;@hapi/joi&#39;;\n\n@Module(&#123;\n  imports: [\n    ConfigModule.forRoot(&#123;\n      validationSchema: Joi.object(&#123;\n        NODE_ENV: Joi.string()\n          .valid(&#39;development&#39;, &#39;production&#39;, &#39;test&#39;, &#39;provision&#39;)\n          .default(&#39;development&#39;),\n        PORT: Joi.number().default(3000),\n      &#125;),\n      validationOptions: &#123;\n        allowUnknown: false,\n        abortEarly: true,\n      &#125;,\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>The <code>@nestjs/config</code> package uses default settings of:</p>\n<ul>\n<li><code>allowUnknown</code>: controls whether or not to allow unknown keys in the environment variables. Default is <code>true</code></li>\n<li><code>abortEarly</code>: if true, stops validation on the first error; if false, returns all errors. Defaults to <code>false</code>.</li>\n</ul>\n<p>Note that once you decide to pass a <code>validationOptions</code> object, any settings you do not explicitly pass will default to <code>Joi</code> standard defaults (not the <code>@nestjs/config</code> defaults). For example, if you leave <code>allowUnknowns</code> unspecified in your custom <code>validationOptions</code> object, it will have the <code>Joi</code> default value of <code>false</code>. Hence, it is probably safest to specify <strong>both</strong> of these settings in your custom object.</p>\n<p><app-banner-shop></app-banner-shop></p>\n<h4 appAnchor id=\"custom-getter-functions\"><span>Custom getter functions</span></h4>\n<p><code>ConfigService</code> defines a generic <code>get()</code> method to retrieve a configuration value by key. We may also add <code>getter</code> functions to enable a little more natural coding style:</p>\n\n<span class=\"filename\">\n<app-tabs #appb1841a5e507e8742a4cb8abb94e5e0127fd089c0></app-tabs>\n</span><pre [class.hide]=\"appb1841a5e507e8742a4cb8abb94e5e0127fd089c0.isJsActive\"><code class=\"language-typescript\">\n@Injectable()\nexport class ApiConfigService &#123;\n  constructor(private configService: ConfigService) &#123;&#125;\n\n  get isAuthEnabled(): boolean &#123;\n    return this.configService.get(&#39;AUTH_ENABLED&#39;) === &#39;true&#39;;\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appb1841a5e507e8742a4cb8abb94e5e0127fd089c0.isJsActive\"><code class=\"language-typescript\">\n@Dependencies(ConfigService)\n@Injectable()\nexport class ApiConfigService &#123;\n  constructor(configService) &#123;\n    this.configService = configService;\n  &#125;\n\n  get isAuthEnabled() &#123;\n    return this.configService.get(&#39;AUTH_ENABLED&#39;) === &#39;true&#39;;\n  &#125;\n&#125;</code></pre><p>Now we can use the getter function as follows:</p>\n\n<span class=\"filename\">\n  {{ 'app.service' | extension: appdb03dbd797f5a5a6ae92e53ae875a19147ca2141.isJsActive }}\n<app-tabs #appdb03dbd797f5a5a6ae92e53ae875a19147ca2141></app-tabs>\n</span><pre [class.hide]=\"appdb03dbd797f5a5a6ae92e53ae875a19147ca2141.isJsActive\"><code class=\"language-typescript\">\n@Injectable()\nexport class AppService &#123;\n  constructor(apiConfigService: ApiConfigService) &#123;\n    if (apiConfigService.isAuthEnabled) &#123;\n      // Authentication is enabled\n    &#125;\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appdb03dbd797f5a5a6ae92e53ae875a19147ca2141.isJsActive\"><code class=\"language-typescript\">\n@Dependencies(ApiConfigService)\n@Injectable()\nexport class AppService &#123;\n  constructor(apiConfigService) &#123;\n    if (apiConfigService.isAuthEnabled) &#123;\n      // Authentication is enabled\n    &#125;\n  &#125;\n&#125;</code></pre><h4 appAnchor id=\"expandable-variables\"><span>Expandable variables</span></h4>\n<p>The <code>@nestjs/config</code> package supports environment variable expansion. With this technique, you can create nested environment variables, where one variable is referred to within the definition of another. For example:</p>\n<pre><code class=\"language-json\">\nAPP_URL=mywebsite.com\nSUPPORT_EMAIL=support@$&#123;APP_URL&#125;</code></pre>\n<p>With this construction, the variable <code>SUPPORT_EMAIL</code> resolves to <code>&#39;support@mywebsite.com&#39;</code>. Note the use of the <code>${{ &#39;{&#39; }}...{{ &#39;}&#39; }}</code> syntax to trigger resolving the value of the variable <code>APP_URL</code> inside the definition of <code>SUPPORT_EMAIL</code>.</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> For this feature, <code>@nestjs/config</code> package internally uses <a rel='nofollow' target='_blank' href=\"https://github.com/motdotla/dotenv-expand\">dotenv-expand</a>.\n</blockquote>\n<p>Enable environment variable expansion using the <code>expandVariables</code> property in the options object passed to the <code>forRoot()</code> method of the <code>ConfigModule</code>, as shown below:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: appc1c589dc4b0d33508126c2efce745f145fbdf55d.isJsActive }}\n<app-tabs #appc1c589dc4b0d33508126c2efce745f145fbdf55d></app-tabs>\n</span><pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    ConfigModule.forRoot(&#123;\n      // ...\n      expandVariables: true,\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><h4 appAnchor id=\"using-in-the-maints\"><span>Using in the <code>main.ts</code></span></h4>\n<p>While our config is a stored in a service, it can still be used in the <code>main.ts</code> file. This way, you can use it to store variables such as the application port or the CORS host.</p>\n<p>To access it, you must use the <code>app.get()</code> method, followed by the service reference:</p>\n<pre><code class=\"language-typescript\">\nconst configService = app.get(ConfigService);</code></pre>\n<p>You can then use it as usual, by calling the <code>get</code> method with the configuration key:</p>\n<pre><code class=\"language-typescript\">\nconst port = configService.get(&#39;PORT&#39;);</code></pre>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-file-upload',\n  templateUrl: './file-upload.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class FileUploadComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/file-upload.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"file-upload\">File upload</h3>\n<p>To handle file uploading, Nest provides a built-in module based on the <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/multer\">multer</a> middleware package for Express. Multer handles data posted in the <code>multipart/form-data</code> format, which is primarily used for uploading files via an HTTP <code>POST</code> request. This module is fully configurable and you can adjust its behavior to your application requirements.</p>\n<blockquote class=\"\nwarning \"><strong>Warning</strong> Multer cannot process data which is not in the supported multipart format (<code>multipart/form-data</code>). Also, note that this package is not compatible with the <code>FastifyAdapter</code>.\n</blockquote>\n<h4 appAnchor id=\"basic-example\"><span>Basic example</span></h4>\n<p>To upload a single file, simply tie the <code>FileInterceptor()</code> interceptor to the route handler and extract <code>file</code> from the <code>request</code> using the <code>@UploadedFile()</code> decorator.</p>\n\n<span class=\"filename\">\n<app-tabs #appa851f5178cbd2406e98fbd2ab99149f2252f220c></app-tabs>\n</span><pre [class.hide]=\"appa851f5178cbd2406e98fbd2ab99149f2252f220c.isJsActive\"><code class=\"language-typescript\">\n@Post(&#39;upload&#39;)\n@UseInterceptors(FileInterceptor(&#39;file&#39;))\nuploadFile(@UploadedFile() file) &#123;\n  console.log(file);\n&#125;</code></pre>\n<pre [class.hide]=\"!appa851f5178cbd2406e98fbd2ab99149f2252f220c.isJsActive\"><code class=\"language-typescript\">\n@Post(&#39;upload&#39;)\n@UseInterceptors(FileInterceptor(&#39;file&#39;))\n@Bind(UploadedFile())\nuploadFile(file) &#123;\n  console.log(file);\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>FileInterceptor()</code> decorator is exported from the <code>@nestjs/platform-express</code> package. The <code>@UploadedFile()</code> decorator is exported from <code>@nestjs/common</code>.\n</blockquote>\n<p>The <code>FileInterceptor()</code> decorator takes two arguments:</p>\n<ul>\n<li><code>fieldName</code>: string that supplies the name of the field from the HTML form that holds a file</li>\n<li><code>options</code>: optional object of type <code>MulterOptions</code>. This is the same object used by the multer constructor (more details <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/multer#multeropts\">here</a>).</li>\n</ul>\n<h4 appAnchor id=\"array-of-files\"><span>Array of files</span></h4>\n<p>To upload an array of files (identified with a single field name), use the <code>FilesInterceptor()</code> decorator (note the plural <strong>Files</strong> in the decorator name). This decorator takes three arguments:</p>\n<ul>\n<li><code>fieldName</code>: as described above</li>\n<li><code>maxCount</code>: optional number defining the maximum number of files to accept</li>\n<li><code>options</code>: optional <code>MulterOptions</code> object, as described above</li>\n</ul>\n<p>When using <code>FilesInterceptor()</code>, extract files from the <code>request</code> with the <code>@UploadedFiles()</code> decorator.</p>\n\n<span class=\"filename\">\n<app-tabs #app07e3d03576a8a7fbe668cbbeb6e2cc7655626a30></app-tabs>\n</span><pre [class.hide]=\"app07e3d03576a8a7fbe668cbbeb6e2cc7655626a30.isJsActive\"><code class=\"language-typescript\">\n@Post(&#39;upload&#39;)\n@UseInterceptors(FilesInterceptor(&#39;files&#39;))\nuploadFile(@UploadedFiles() files) &#123;\n  console.log(files);\n&#125;</code></pre>\n<pre [class.hide]=\"!app07e3d03576a8a7fbe668cbbeb6e2cc7655626a30.isJsActive\"><code class=\"language-typescript\">\n@Post(&#39;upload&#39;)\n@UseInterceptors(FilesInterceptor(&#39;files&#39;))\n@Bind(UploadedFiles())\nuploadFile(files) &#123;\n  console.log(files);\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>FilesInterceptor()</code> decorator is exported from the <code>@nestjs/platform-express</code> package. The <code>@UploadedFiles()</code> decorator is exported from <code>@nestjs/common</code>.\n</blockquote>\n<h4 appAnchor id=\"multiple-files\"><span>Multiple files</span></h4>\n<p>To upload multiple fields (all with different field name keys), use the <code>FileFieldsInterceptor()</code> decorator. This decorator takes two arguments:</p>\n<ul>\n<li><code>uploadedFields</code>: an array of objects, where each object specifies a required <code>name</code> property with a string value specifying a field name, as described above, and an optional <code>maxCount</code> property, as described above</li>\n<li><code>options</code>: optional <code>MulterOptions</code> object, as described above</li>\n</ul>\n<p>When using <code>FileFieldsInterceptor()</code>, extract files from the <code>request</code> with the <code>@UploadedFiles()</code> decorator.</p>\n\n<span class=\"filename\">\n<app-tabs #app2bf8d59add54497788497c77d01e881bd923db29></app-tabs>\n</span><pre [class.hide]=\"app2bf8d59add54497788497c77d01e881bd923db29.isJsActive\"><code class=\"language-typescript\">\n@Post(&#39;upload&#39;)\n@UseInterceptors(FileFieldsInterceptor([\n  &#123; name: &#39;avatar&#39;, maxCount: 1 &#125;,\n  &#123; name: &#39;background&#39;, maxCount: 1 &#125;,\n]))\nuploadFile(@UploadedFiles() files) &#123;\n  console.log(files);\n&#125;</code></pre>\n<pre [class.hide]=\"!app2bf8d59add54497788497c77d01e881bd923db29.isJsActive\"><code class=\"language-typescript\">\n@Post(&#39;upload&#39;)\n@Bind(UploadedFiles())\n@UseInterceptors(FileFieldsInterceptor([\n  &#123; name: &#39;avatar&#39;, maxCount: 1 &#125;,\n  &#123; name: &#39;background&#39;, maxCount: 1 &#125;,\n]))\nuploadFile(files) &#123;\n  console.log(files);\n&#125;</code></pre><h4 appAnchor id=\"any-files\"><span>Any files</span></h4>\n<p>To upload all fields with arbitrary field name keys, use the <code>AnyFilesInterceptor()</code> decorator. This decorator can accept an optional <code>options</code> object as described above.</p>\n<p>When using <code>AnyFilesInterceptor()</code>, extract files from the <code>request</code> with the <code>@UploadedFiles()</code> decorator.</p>\n\n<span class=\"filename\">\n<app-tabs #app54e26c4c37709e48a1d448f11e9c7958def9efe8></app-tabs>\n</span><pre [class.hide]=\"app54e26c4c37709e48a1d448f11e9c7958def9efe8.isJsActive\"><code class=\"language-typescript\">\n@Post(&#39;upload&#39;)\n@UseInterceptors(AnyFilesInterceptor())\nuploadFile(@UploadedFiles() files) &#123;\n  console.log(files);\n&#125;</code></pre>\n<pre [class.hide]=\"!app54e26c4c37709e48a1d448f11e9c7958def9efe8.isJsActive\"><code class=\"language-typescript\">\n@Post(&#39;upload&#39;)\n@Bind(UploadedFiles())\n@UseInterceptors(AnyFilesInterceptor())\nuploadFile(files) &#123;\n  console.log(files);\n&#125;</code></pre><h4 appAnchor id=\"default-options\"><span>Default options</span></h4>\n<p>You can specify multer options in the file interceptors as described above. To set default options, you can call the static <code>register()</code> method when you import the <code>MulterModule</code>, passing in supported options. You can use all options listed <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/multer#multeropts\">here</a>.</p>\n<pre><code class=\"language-typescript\">\nMulterModule.register(&#123;\n  dest: &#39;/upload&#39;,\n&#125;);</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>MulterModule</code> class is exported from the <code>@nestjs/platform-express</code> package.\n</blockquote>\n<h4 appAnchor id=\"async-configuration\"><span>Async configuration</span></h4>\n<p>When you need to set <code>MulterModule</code> options asynchronously instead of statically, use the <code>registerAsync()</code> method. As with most dynamic modules, Nest provides several techniques to deal with async configuration.</p>\n<p>One technique is to use a factory function:</p>\n<pre><code class=\"language-typescript\">\nMulterModule.registerAsync(&#123;\n  useFactory: () =&gt; (&#123;\n    dest: &#39;/upload&#39;,\n  &#125;),\n&#125;);</code></pre>\n<p>Like other <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory\">factory providers</a>, our factory function can be <code>async</code> and can inject dependencies through <code>inject</code>.</p>\n<pre><code class=\"language-typescript\">\nMulterModule.registerAsync(&#123;\n  imports: [ConfigModule],\n  useFactory: async (configService: ConfigService) =&gt; (&#123;\n    dest: configService.getString(&#39;MULTER_DEST&#39;),\n  &#125;),\n  inject: [ConfigService],\n&#125;);</code></pre>\n<p>Alternatively, you can configure the <code>MulterModule</code> using a class instead of a factory, as shown below:</p>\n<pre><code class=\"language-typescript\">\nMulterModule.registerAsync(&#123;\n  useClass: MulterConfigService,\n&#125;);</code></pre>\n<p>The construction above instantiates <code>MulterConfigService</code> inside <code>MulterModule</code>, using it to create the required options object. Note that in this example, the <code>MulterConfigService</code> has to implement the <code>MulterOptionsFactory</code> interface, as shown below. The <code>MulterModule</code> will call the <code>createMulterOptions()</code> method on the instantiated object of the supplied class.</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nclass MulterConfigService implements MulterOptionsFactory &#123;\n  createMulterOptions(): MulterModuleOptions &#123;\n    return &#123;\n      dest: &#39;/upload&#39;,\n    &#125;;\n  &#125;\n&#125;</code></pre>\n<p>If you want to reuse an existing options provider instead of creating a private copy inside the <code>MulterModule</code>, use the <code>useExisting</code> syntax.</p>\n<pre><code class=\"language-typescript\">\nMulterModule.registerAsync(&#123;\n  imports: [ConfigModule],\n  useExisting: ConfigService,\n&#125;);</code></pre>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-http-module',\n  templateUrl: './http-module.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class HttpModuleComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/http-module.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"http-module\">HTTP module</h3>\n<p><a rel='nofollow' target='_blank' href=\"https://github.com/axios/axios\">Axios</a> is richly featured HTTP client package that is widely used. Nest wraps Axios and exposes it via the built-in <code>HttpModule</code>. The <code>HttpModule</code> exports the <code>HttpService</code> class, which exposes Axios-based methods to perform HTTP requests. The library also transforms the resulting HTTP responses into <code>Observables</code>.</p>\n<p>To use the <code>HttpService</code>, first import <code>HttpModule</code>.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [HttpModule],\n  providers: [CatsService],\n&#125;)\nexport class CatsModule &#123;&#125;</code></pre>\n<p>Next, inject <code>HttpService</code> using normal constructor injection.</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> <code>HttpModule</code> and <code>HttpService</code> are imported from <code>@nestjs/common</code> package.\n</blockquote>\n\n<span class=\"filename\">\n<app-tabs #appab8c34601c875a168dec902b00358dc0b733f96c></app-tabs>\n</span><pre [class.hide]=\"appab8c34601c875a168dec902b00358dc0b733f96c.isJsActive\"><code class=\"language-typescript\">\n@Injectable()\nexport class CatsService &#123;\n  constructor(private readonly httpService: HttpService) &#123;&#125;\n\n  findAll(): Observable&lt;AxiosResponse&lt;Cat[]&gt;&gt; &#123;\n    return this.httpService.get(&#39;http://localhost:3000/cats&#39;);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appab8c34601c875a168dec902b00358dc0b733f96c.isJsActive\"><code class=\"language-typescript\">\n@Injectable()\n@Dependencies(HttpService)\nexport class CatsService &#123;\n  constructor(httpService) &#123;\n    this.httpService = httpService;\n  &#125;\n\n  findAll() &#123;\n    return this.httpService.get(&#39;http://localhost:3000/cats&#39;);\n  &#125;\n&#125;</code></pre><p>All <code>HttpService</code> methods return an <code>AxiosResponse</code> wrapped in an <code>Observable</code> object.</p>\n<h4 appAnchor id=\"configuration\"><span>Configuration</span></h4>\n<p><a rel='nofollow' target='_blank' href=\"https://github.com/axios/axios\">Axios</a> can be configured with a variety of options to customize the behavior of the <code>HttpService</code>. Read more about them <a rel='nofollow' target='_blank' href=\"https://github.com/axios/axios#request-config\">here</a>. To configure the underlying Axios instance, pass an optional options object to the <code>register()</code> method of <code>HttpModule</code> when importing it. This options object will be passed directly to the underlying Axios constructor.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    HttpModule.register(&#123;\n      timeout: 5000,\n      maxRedirects: 5,\n    &#125;),\n  ],\n  providers: [CatsService],\n&#125;)\nexport class CatsModule &#123;&#125;</code></pre>\n<h4 appAnchor id=\"async-configuration\"><span>Async configuration</span></h4>\n<p>When you need to pass module options asynchronously instead of statically, use the <code>registerAsync()</code> method. As with most dynamic modules, Nest provides several techniques to deal with async configuration.</p>\n<p>One technique is to use a factory function:</p>\n<pre><code class=\"language-typescript\">\nHttpModule.registerAsync(&#123;\n  useFactory: () =&gt; (&#123;\n    timeout: 5000,\n    maxRedirects: 5,\n  &#125;),\n&#125;);</code></pre>\n<p>Like other factory providers, our factory function can be <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory\">async</a> and can inject dependencies through <code>inject</code>.</p>\n<pre><code class=\"language-typescript\">\nHttpModule.registerAsync(&#123;\n  imports: [ConfigModule],\n  useFactory: async (configService: ConfigService) =&gt; (&#123;\n    timeout: configService.getString(&#39;HTTP_TIMEOUT&#39;),\n    maxRedirects: configService.getString(&#39;HTTP_MAX_REDIRECTS&#39;),\n  &#125;),\n  inject: [ConfigService],\n&#125;);</code></pre>\n<p>Alternatively, you can configure the <code>HttpModule</code> using a class instead of a factory, as shown below.</p>\n<pre><code class=\"language-typescript\">\nHttpModule.registerAsync(&#123;\n  useClass: HttpConfigService,\n&#125;);</code></pre>\n<p>The construction above instantiates <code>HttpConfigService</code> inside <code>HttpModule</code>, using it to create an options object. Note that in this example, the <code>HttpConfigService</code> has to implement <code>HttpModuleOptionsFactory</code> interface as shown below. The <code>HttpModule</code> will call the <code>createHttpOptions()</code> method on the instantiated object of the supplied class.</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nclass HttpConfigService implements HttpModuleOptionsFactory &#123;\n  createHttpOptions(): HttpModuleOptions &#123;\n    return &#123;\n      timeout: 5000,\n      maxRedirects: 5,\n    &#125;;\n  &#125;\n&#125;</code></pre>\n<p>If you want to reuse an existing options provider instead of creating a private copy inside the <code>HttpModule</code>, use the <code>useExisting</code> syntax.</p>\n<pre><code class=\"language-typescript\">\nHttpModule.registerAsync(&#123;\n  imports: [ConfigModule],\n  useExisting: ConfigService,\n&#125;);</code></pre>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-logger',\n  templateUrl: './logger.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class LoggerComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/logger.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"logger\">Logger</h3>\n<p>Nest comes with a built-in text-based logger which is used during application bootstrapping and several other circumstances such as displaying caught exceptions (i.e., system logging). This functionality is provided via the <code>Logger</code> class in the <code>@nestjs/common</code> package. You can fully control the behavior of the logging system, including any of the following:</p>\n<ul>\n<li>disable logging entirely</li>\n<li>specify the log level of detail (e.g., display errors, warnings, debug information, etc.)</li>\n<li>completely override the default logger</li>\n<li>customize the default logger by extending it</li>\n<li>make use of dependency injection to simplify composing and testing your application</li>\n</ul>\n<p>You can also make use of the built-in logger, or create your own custom implementation, to log your own application-level events and messages.</p>\n<p>For more advanced logging functionality, you can make use of any Node.js logging package, such as <a rel='nofollow' target='_blank' href=\"https://github.com/winstonjs/winston\">Winston</a>, to implement a completely custom, production grade logging system.</p>\n<h4 appAnchor id=\"basic-customization\"><span>Basic customization</span></h4>\n<p>To disable logging, set the <code>logger</code> property to <code>false</code> in the (optional) Nest application options object passed as the second argument to the <code>NestFactory.create()</code> method.</p>\n<pre><code class=\"language-typescript\">\nconst app = await NestFactory.create(ApplicationModule, &#123;\n  logger: false,\n&#125;);\nawait app.listen(3000);</code></pre>\n<p>To enable specific logging levels, set the <code>logger</code> property to an array of strings specifying the log levels to display, as follows:</p>\n<pre><code class=\"language-typescript\">\nconst app = await NestFactory.create(ApplicationModule, &#123;\n  logger: [&#39;error&#39;, &#39;warn&#39;],\n&#125;);\nawait app.listen(3000);</code></pre>\n<p>Values in the array can be any combination of <code>&#39;log&#39;</code>, <code>&#39;error&#39;</code>, <code>&#39;warn&#39;</code>, <code>&#39;debug&#39;</code>, and <code>&#39;verbose&#39;</code>.</p>\n<h4 appAnchor id=\"custom-implementation\"><span>Custom implementation</span></h4>\n<p>You can provide a custom logger implementation to be used by Nest for system logging by setting the value of the <code>logger</code> property to an object that fulfills the <code>LoggerService</code> interface. For example, you can tell Nest to use the built-in global JavaScript <code>console</code> object (which implements the <code>LoggerService</code> interface), as follows:</p>\n<pre><code class=\"language-typescript\">\nconst app = await NestFactory.create(ApplicationModule, &#123;\n  logger: console,\n&#125;);\nawait app.listen(3000);</code></pre>\n<p>Implementing your own custom logger is straightforward. Simply implement each of the methods of the <code>LoggerService</code> interface as shown below.</p>\n<pre><code class=\"language-typescript\">\nimport &#123; LoggerService &#125; from &#39;@nestjs/common&#39;;\n\nexport class MyLogger implements LoggerService &#123;\n  log(message: string) &#123;\n    /* your implementation */\n  &#125;\n  error(message: string, trace: string) &#123;\n    /* your implementation */\n  &#125;\n  warn(message: string) &#123;\n    /* your implementation */\n  &#125;\n  debug(message: string) &#123;\n    /* your implementation */\n  &#125;\n  verbose(message: string) &#123;\n    /* your implementation */\n  &#125;\n&#125;</code></pre>\n<p>You can then supply an instance of <code>MyLogger</code> via the <code>logger</code> property of the Nest application options object.</p>\n<pre><code class=\"language-typescript\">\nconst app = await NestFactory.create(ApplicationModule, &#123;\n  logger: new MyLogger(),\n&#125;);\nawait app.listen(3000);</code></pre>\n<p>This technique, while simple, doesn&#39;t utilize dependency injection for the <code>MyLogger</code> class. This can pose some challenges, particularly for testing, and limit the reusability of <code>MyLogger</code>. For a better solution, see the <a href=\"techniques/logger#dependency-injection\">Dependency Injection</a> section below.</p>\n<h4 appAnchor id=\"extend-built-in-logger\"><span>Extend built-in logger</span></h4>\n<p>Rather than writing a logger from scratch, you may be able to meet your needs by extending the built-in <code>Logger</code> class and overriding selected behavior of the default implementation.</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Logger &#125; from &#39;@nestjs/common&#39;;\n\nexport class MyLogger extends Logger &#123;\n  error(message: string, trace: string) &#123;\n    // add your tailored logic here\n    super.error(message, trace);\n  &#125;\n&#125;</code></pre>\n<p>You can use such an extended logger in your feature modules as described in the <a href=\"techniques/logger#using-the-logger-for-application-logging\">Using the logger for application logging</a> section below.</p>\n<p>You can tell Nest to use your extended logger for system logging by passing an instance of it via the <code>logger</code> property of the application options object (as shown in the <a href=\"techniques/logger#custom-logger-implementation\">Custom implementation</a> section above), or by using the technique shown in the <a href=\"techniques/logger#dependency-injection\">Dependency Injection</a> section below. If you do so, you should take care to call <code>super</code>, as shown in the sample code above, to delegate the specific log method call to the parent (built-in) class so that Nest can rely on the built-in features it expects.</p>\n<p></p>\n<h4 appAnchor id=\"dependency-injection\"><span>Dependency injection</span></h4>\n<p>For more advanced logging functionality, you&#39;ll want to take advantage of dependency injection. For example, you may want to inject a <code>ConfigService</code> into your logger to customize it, and in turn inject your custom logger into other controllers and/or providers. To enable dependency injection for your custom logger, create a class that implements <code>LoggerService</code> and register that class as a provider in some module. For example, you can</p>\n<ol>\n<li>Define a <code>MyLogger</code> class that either extends the built-in <code>Logger</code> or completely overrides it, as shown in previous sections.</li>\n<li>Create a <code>LoggerModule</code> as shown below, and provide <code>MyLogger</code> from that module.</li>\n</ol>\n<pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MyLogger &#125; from &#39;./my-logger.service&#39;;\n\n@Module(&#123;\n  providers: [MyLogger],\n  exports: [MyLogger],\n&#125;)\nexport class LoggerModule &#123;&#125;</code></pre>\n<p>With this construct, you are now providing your custom logger for use by any other module. Because your <code>MyLogger</code> class is part of a module, it can use dependency injection (for example, to inject a <code>ConfigService</code>). There&#39;s one more technique needed to provide this custom logger for use by Nest for system logging (e.g., for bootstrapping and error handling).</p>\n<p>Because application instantiation (<code>NestFactory.create()</code>) happens outside the context of any module, it doesn&#39;t participate in the normal Dependency Injection phase of initialization. So we must ensure that at least one application module imports the <code>LoggerModule</code> to trigger Nest to instantiate a singleton instance of our <code>MyLogger</code> class. We can then instruct Nest to use the same singleton instance of <code>MyLogger</code> with the following construction:</p>\n<pre><code class=\"language-typescript\">\nconst app = await NestFactory.create(ApplicationModule, &#123;\n  logger: false,\n&#125;);\napp.useLogger(app.get(MyLogger));\nawait app.listen(3000);</code></pre>\n<p>Here we use the <code>get()</code> method on the <code>NestApplication</code> instance to retrieve the singleton instance of the <code>MyLogger</code> object. This technique is essentially a way to &quot;inject&quot; an instance of a logger for use by Nest. The <code>app.get()</code> call retrieves the singleton instance of <code>MyLogger</code>, and depends on that instance being first injected in another module, as described above.</p>\n<p>You can also inject this <code>MyLogger</code> provider in your feature classes, thus ensuring consistent logging behavior across both Nest system logging and application logging. See <a href=\"techniques/logger#using-the-logger-for-application-logging\">Using the logger for application logging</a> below for more information.</p>\n<h4 appAnchor id=\"using-the-logger-for-application-logging\"><span>Using the logger for application logging</span></h4>\n<p>We can combine several of the techniques above to provide consistent behavior and formatting across both Nest system logging and our own application event/message logging. In this section, we&#39;ll achieve this with the following steps:</p>\n<ol>\n<li>We extend the built-in logger and customize the <code>context</code> portion of the log message (e.g., the phrase <code>NestFactory</code> in square brackets in the log line shown below).</li>\n</ol>\n<pre><code class=\"language-bash\">\n[Nest] 19096   - 12/08/2019, 7:12:59 AM   [NestFactory] Starting Nest application...</code></pre>\n<ol start=\"2\">\n<li>We inject a <a routerLink=\"/fundamentals/injection-scopes\">transient</a> instance of the <code>Logger</code> into our feature modules so that each one has its own custom context.</li>\n<li>We supply this extended logger for Nest to use for system logging.</li>\n</ol>\n<p>To start, extend the built-in logger with code like the following. We supply the <code>scope</code> option as configuration metadata for the <code>Logger</code> class, specifying a <a routerLink=\"/fundamentals/injection-scopes\">transient</a> scope, to ensure that we&#39;ll have a unique instance of the <code>Logger</code> in each feature module. In this example, we do not extend the individual <code>Logger</code> methods (like <code>log()</code>, <code>warn()</code>, etc.), though you may choose to do so.</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Injectable, Scope, Logger &#125; from &#39;@nestjs/common&#39;;\n\n@Injectable(&#123; scope: Scope.TRANSIENT &#125;)\nexport class MyLogger extends Logger &#123;&#125;</code></pre>\n<p>Next, create a <code>LoggerModule</code> with a construction like this:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MyLogger &#125; from &#39;./my-logger.service&#39;;\n\n@Module(&#123;\n  providers: [MyLogger],\n  exports: [MyLogger],\n&#125;)\nexport class LoggerModule &#123;&#125;</code></pre>\n<p>Next, import the <code>LoggerModule</code> into your feature module. Then set the logger context, and start using the context-aware custom logger, like this:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MyLogger &#125; from &#39;./my-logger.service&#39;;\n\n@Injectable()\nexport class CatsService &#123;\n  private readonly cats: Cat[] = [];\n\n  constructor(private readonly myLogger: MyLogger) &#123;\n    this.myLogger.setContext(&#39;CatsService&#39;);\n  &#125;\n\n  findAll(): Cat[] &#123;\n    this.myLogger.warn(&#39;About to return cats!&#39;);\n    return this.cats;\n  &#125;\n&#125;</code></pre>\n<p>Finally, instruct Nest to use an instance of the custom logger in your <code>main.ts</code> file as shown below. Of course in this example, we haven&#39;t actually customized the logger behavior (by extending the <code>Logger</code> methods like <code>log()</code>, <code>warn()</code>, etc.), so this step isn&#39;t actually needed. But it <strong>would</strong> be needed if you added custom logic to those methods and wanted Nest to use the same implementation.</p>\n<pre><code class=\"language-typescript\">\nconst app = await NestFactory.create(ApplicationModule, &#123;\n  logger: false,\n&#125;);\napp.useLogger(new MyLogger());\nawait app.listen(3000);</code></pre>\n<h4 appAnchor id=\"use-external-logger\"><span>Use external logger</span></h4>\n<p>Production applications often have specific logging requirements, including advanced filtering, formatting and centralized logging. Nest&#39;s built-in logger is used for monitoring Nest system behavior, and can also be useful for basic formatted text logging in your feature modules while in development, but production applications often take advantage of dedicated logging modules like <a rel='nofollow' target='_blank' href=\"https://github.com/winstonjs/winston\">Winston</a>. As with any standard Node.js application, you can take full advantage of such modules in Nest.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-mongo',\n  templateUrl: './mongo.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class MongoComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/mongo.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"mongo\">Mongo</h3>\n<p>Nest supports two methods for integrating with the <a rel='nofollow' target='_blank' href=\"https://www.mongodb.com/\">MongoDB</a> database. You can either use the built-in <a rel='nofollow' target='_blank' href=\"https://github.com/typeorm/typeorm\">TypeORM</a> module described <a routerLink=\"/techniques/database\">here</a>, which has a connector for MongoDB, or use <a rel='nofollow' target='_blank' href=\"http://mongoosejs.com\">Mongoose</a>, the most popular MongoDB object modeling tool. In this chapter we&#39;ll describe the latter, using the dedicated <code>@nestjs/mongoose</code> package.</p>\n<p>Start by installing the required dependencies:</p>\n<pre><code class=\"language-bash\">\n$ npm install --save @nestjs/mongoose mongoose</code></pre>\n<p>Once the installation process is complete, we can import the <code>MongooseModule</code> into the root <code>AppModule</code>.</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: appea4e6c4003d3c9f7f34a9a7b54d6bafa097dc0ad.isJsActive }}\n<app-tabs #appea4e6c4003d3c9f7f34a9a7b54d6bafa097dc0ad></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MongooseModule &#125; from &#39;@nestjs/mongoose&#39;;\n\n@Module(&#123;\n  imports: [MongooseModule.forRoot(&#39;mongodb://localhost/nest&#39;)],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>The <code>forRoot()</code> method accepts the same configuration object as <code>mongoose.connect()</code> from the Mongoose package, as described <a rel='nofollow' target='_blank' href=\"https://mongoosejs.com/docs/connections.html\">here</a>.</p>\n<h4 appAnchor id=\"model-injection\"><span>Model injection</span></h4>\n<p>With Mongoose, everything is derived from a <a rel='nofollow' target='_blank' href=\"http://mongoosejs.com/docs/guide.html\">Schema</a>. Let&#39;s define the <code>CatSchema</code>:</p>\n\n<span class=\"filename\">\n  {{ 'schemas/cat.schema' | extension: app2fa63e85b9a3be06dd62b32856aaf0a8340a5547.isJsActive }}\n<app-tabs #app2fa63e85b9a3be06dd62b32856aaf0a8340a5547></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport * as mongoose from &#39;mongoose&#39;;\n\nexport const CatSchema = new mongoose.Schema(&#123;\n  name: String,\n  age: Number,\n  breed: String,\n&#125;);</code></pre><p>The <code>cat.schema</code> file resides in a folder in the <code>cats</code> directory, where we also define the <code>CatsModule</code>. While you can store schema files wherever you prefer, we recommend storing them them near their related <strong>domain</strong> objects, in the appropriate module directory.</p>\n<p>Let&#39;s look at the <code>CatsModule</code>:</p>\n\n<span class=\"filename\">\n  {{ 'cats.module' | extension: app92d34942d414d8560ae0db7fc80bb705cd9570c9.isJsActive }}\n<app-tabs #app92d34942d414d8560ae0db7fc80bb705cd9570c9></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MongooseModule &#125; from &#39;@nestjs/mongoose&#39;;\nimport &#123; CatsController &#125; from &#39;./cats.controller&#39;;\nimport &#123; CatsService &#125; from &#39;./cats.service&#39;;\nimport &#123; CatSchema &#125; from &#39;./schemas/cat.schema&#39;;\n\n@Module(&#123;\n  imports: [MongooseModule.forFeature([&#123; name: &#39;Cat&#39;, schema: CatSchema &#125;])],\n  controllers: [CatsController],\n  providers: [CatsService],\n&#125;)\nexport class CatsModule &#123;&#125;</code></pre><p>The <code>MongooseModule</code> provides the <code>forFeature()</code> method to configure the module, including defining which models should be registered in the current scope. If you also want to use the models in another module, add MongooseModule to the <code>exports</code> section of <code>CatsModule</code> and import <code>CatsModule</code> in the other module.</p>\n<p>Once you&#39;ve registered the schema, you can inject a <code>Cat</code> model into the <code>CatsService</code> using the <code>@InjectModel()</code> decorator:</p>\n\n<span class=\"filename\">\n  {{ 'cats.service' | extension: app6caf36fa1dddf1c72b570dfd26d58588bfd1de35.isJsActive }}\n<app-tabs #app6caf36fa1dddf1c72b570dfd26d58588bfd1de35></app-tabs>\n</span><pre [class.hide]=\"app6caf36fa1dddf1c72b570dfd26d58588bfd1de35.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Model &#125; from &#39;mongoose&#39;;\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; InjectModel &#125; from &#39;@nestjs/mongoose&#39;;\nimport &#123; Cat &#125; from &#39;./interfaces/cat.interface&#39;;\nimport &#123; CreateCatDto &#125; from &#39;./dto/create-cat.dto&#39;;\n\n@Injectable()\nexport class CatsService &#123;\n  constructor(@InjectModel(&#39;Cat&#39;) private readonly catModel: Model&lt;Cat&gt;) &#123;&#125;\n\n  async create(createCatDto: CreateCatDto): Promise&lt;Cat&gt; &#123;\n    const createdCat = new this.catModel(createCatDto);\n    return createdCat.save();\n  &#125;\n\n  async findAll(): Promise&lt;Cat[]&gt; &#123;\n    return this.catModel.find().exec();\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app6caf36fa1dddf1c72b570dfd26d58588bfd1de35.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Model &#125; from &#39;mongoose&#39;;\nimport &#123; Injectable, Dependencies &#125; from &#39;@nestjs/common&#39;;\nimport &#123; getModelToken &#125; from &#39;@nestjs/mongoose&#39;;\n\n@Injectable()\n@Dependencies(getModelToken(&#39;Cat&#39;))\nexport class CatsService &#123;\n  constructor(catModel) &#123;\n    this.catModel = catModel;\n  &#125;\n\n  async create(createCatDto) &#123;\n    const createdCat = new this.catModel(createCatDto);\n    return createdCat.save();\n  &#125;\n\n  async findAll() &#123;\n    return this.catModel.find().exec();\n  &#125;\n&#125;</code></pre><h4 appAnchor id=\"connection\"><span>Connection</span></h4>\n<p>At times you may need to access the native <a rel='nofollow' target='_blank' href=\"https://mongoosejs.com/docs/api.html#Connection\">Mongoose Connection</a> object. For example, you may want to make native API calls on the connection object. You can inject the Mongoose Connection by using the <code>@InjectConnection()</code> decorator as follows:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; InjectConnection &#125; from &#39;@nestjs/mongoose&#39;;\nimport &#123; Connection &#125; from &#39;mongoose&#39;;\n\n@Injectable()\nexport class CatsService &#123;\n  constructor(@InjectConnection() private readonly connection: Connection) &#123;&#125;\n&#125;</code></pre>\n<h4 appAnchor id=\"multiple-databases\"><span>Multiple databases</span></h4>\n<p>Some projects require multiple database connections. This can also be achieved with this module. To work with multiple connections, first create the connections. In this case, connection naming becomes <strong>mandatory</strong>.</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: appd5bd3207496e33f8f3ef16ec5a81d340a32e9a26.isJsActive }}\n<app-tabs #appd5bd3207496e33f8f3ef16ec5a81d340a32e9a26></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MongooseModule &#125; from &#39;@nestjs/mongoose&#39;;\n\n@Module(&#123;\n  imports: [\n    MongooseModule.forRoot(&#39;mongodb://localhost/test&#39;, &#123;\n      connectionName: &#39;cats&#39;,\n    &#125;),\n    MongooseModule.forRoot(&#39;mongodb://localhost/users&#39;, &#123;\n      connectionName: &#39;users&#39;,\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><blockquote class=\"\nwarning \"><strong>Notice</strong> Please note that you shouldn&#39;t have multiple connections without a name, or with the same name, otherwise they will get overridden.\n</blockquote>\n<p>With this setup, you have to tell the <code>MongooseModule.forFeature()</code> function which connection should be used.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    MongooseModule.forFeature([&#123; name: &#39;Cat&#39;, schema: CatSchema &#125;], &#39;cats&#39;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<p>You can also inject the <code>Connection</code> for a given connection:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; InjectConnection &#125; from &#39;@nestjs/mongoose&#39;;\nimport &#123; Connection &#125; from &#39;mongoose&#39;;\n\n@Injectable()\nexport class CatsService &#123;\n  constructor(\n    @InjectConnection(&#39;cats&#39;) private readonly connection: Connection,\n  ) &#123;&#125;\n&#125;</code></pre>\n<h4 appAnchor id=\"hooks-middleware\"><span>Hooks (middleware)</span></h4>\n<p>Middleware (also called pre and post hooks) are functions which are passed control during execution of asynchronous functions. Middleware is specified on the schema level and is useful for writing plugins (<a rel='nofollow' target='_blank' href=\"https://mongoosejs.com/docs/middleware.html\">source</a>). Calling <code>pre()</code> or <code>post()</code> after compiling a model does not work in Mongoose. To register a hook <strong>before</strong> model registration, use the <code>forFeatureAsync()</code> method of the <code>MongooseModule</code> along with a factory provider (i.e., <code>useFactory</code>). With this technique, you can access a schema object, then use the <code>pre()</code> or <code>post()</code> method to register a hook on that schema. See example below:</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    MongooseModule.forFeatureAsync([\n      &#123;\n        name: &#39;Cat&#39;,\n        useFactory: () =&gt; &#123;\n          const schema = CatsSchema;\n          schema.pre(&#39;save&#39;, () =&gt; console.log(&#39;Hello from pre save&#39;));\n          return schema;\n        &#125;,\n      &#125;,\n    ]),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<p>Like other <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory\">factory providers</a>, our factory function can be <code>async</code> and can inject dependencies through <code>inject</code>.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    MongooseModule.forFeatureAsync([\n      &#123;\n        name: &#39;Cat&#39;,\n        import [ConfigModule],\n        useFactory: (configService: ConfigService) =&gt; &#123;\n          const schema = CatsSchema;\n          schema.pre(&#39;save&#39;, () =&gt;\n            console.log(`$&#123;configService.getString(&#39;APP_NAME&#39;)&#125;: Hello from pre save`),\n          );\n          return schema;\n        &#125;,\n        inject: [ConfigService],\n      &#125;\n    ]),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<h4 appAnchor id=\"plugins\"><span>Plugins</span></h4>\n<p>To register a <a rel='nofollow' target='_blank' href=\"https://mongoosejs.com/docs/plugins.html\">plugin</a> for a given schema, use the <code>forFeatureAsync()</code> method.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    MongooseModule.forFeatureAsync([\n      &#123;\n        name: &#39;Cat&#39;,\n        useFactory: () =&gt; &#123;\n          const schema = CatsSchema;\n          schema.plugin(require(&#39;mongoose-autopopulate&#39;));\n          return schema;\n        &#125;,\n      &#125;,\n    ]),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<p>To register a plugin for all schemas at once, call the <code>.plugin()</code> method of the <code>Connection</code> object. You should access the connection before models are created; to do this, use the <code>connectionFactory</code>:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: appb3b321397805a714b614a46f884bf8e8db7a7af5.isJsActive }}\n<app-tabs #appb3b321397805a714b614a46f884bf8e8db7a7af5></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MongooseModule &#125; from &#39;@nestjs/mongoose&#39;;\n\n@Module(&#123;\n  imports: [\n    MongooseModule.forRoot(&#39;mongodb://localhost/test&#39;, &#123;\n      connectionFactory: (connection) =&gt; &#123;\n        connection.plugin(require(&#39;mongoose-autopopulate&#39;));\n        return connection;\n      &#125;\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><h4 appAnchor id=\"testing\"><span>Testing</span></h4>\n<p>When unit testing an application, we usually want to avoid any database connection, making our test suites simpler to set up and faster to execute. But our classes might depend on models that are pulled from the connection instance. How do we resolve these classes? The solution is to create mock models.</p>\n<p>To make this easier, the <code>@nestjs/mongoose</code> package exposes a <code>getModelToken()</code> function that returns a prepared <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/custom-providers#di-fundamentals\">injection token</a> based on a token name. Using this token, you can easily provide a mock implementation using any of the standard <a routerLink=\"/fundamentals/custom-providers\">custom provider</a> techniques, including <code>useClass</code>, <code>useValue</code>, and <code>useFactory</code>. For example:</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  providers: [\n    CatsService,\n    &#123;\n      provide: getModelToken(&#39;Cat&#39;),\n      useValue: catModel,\n    &#125;,\n  ],\n&#125;)\nexport class CatsModule &#123;&#125;</code></pre>\n<p>In this example, a hardcoded <code>catModel</code> (object instance) will be provided whenever any consumer injects a <code>Model&lt;Cat&gt;</code> using an <code>@InjectModel()</code> decorator.</p>\n<p></p>\n<h4 appAnchor id=\"async-configuration\"><span>Async configuration</span></h4>\n<p>When you need to pass module options asynchronously instead of statically, use the <code>forRootAsync()</code> method. As with most dynamic modules, Nest provides several techniques to deal with async configuration.</p>\n<p>One technique is to use a factory function:</p>\n<pre><code class=\"language-typescript\">\nMongooseModule.forRootAsync(&#123;\n  useFactory: () =&gt; (&#123;\n    uri: &#39;mongodb://localhost/nest&#39;,\n  &#125;),\n&#125;);</code></pre>\n<p>Like other <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory\">factory providers</a>, our factory function can be <code>async</code> and can inject dependencies through <code>inject</code>.</p>\n<pre><code class=\"language-typescript\">\nMongooseModule.forRootAsync(&#123;\n  imports: [ConfigModule],\n  useFactory: async (configService: ConfigService) =&gt; (&#123;\n    uri: configService.getString(&#39;MONGODB_URI&#39;),\n  &#125;),\n  inject: [ConfigService],\n&#125;);</code></pre>\n<p>Alternatively, you can configure the <code>MongooseModule</code> using a class instead of a factory, as shown below:</p>\n<pre><code class=\"language-typescript\">\nMongooseModule.forRootAsync(&#123;\n  useClass: MongooseConfigService,\n&#125;);</code></pre>\n<p>The construction above instantiates <code>MongooseConfigService</code> inside <code>MongooseModule</code>, using it to create the required options object. Note that in this example, the <code>MongooseConfigService</code> has to implement the <code>MongooseOptionsFactory</code> interface, as shown below. The <code>MongooseModule</code> will call the <code>createMongooseOptions()</code> method on the instantiated object of the supplied class.</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nclass MongooseConfigService implements MongooseOptionsFactory &#123;\n  createMongooseOptions(): MongooseModuleOptions &#123;\n    return &#123;\n      uri: &#39;mongodb://localhost/nest&#39;,\n    &#125;;\n  &#125;\n&#125;</code></pre>\n<p>If you want to reuse an existing options provider instead of creating a private copy inside the <code>MongooseModule</code>, use the <code>useExisting</code> syntax.</p>\n<pre><code class=\"language-typescript\">\nMongooseModule.forRootAsync(&#123;\n  imports: [ConfigModule],\n  useExisting: ConfigService,\n&#125;);</code></pre>\n<h4 appAnchor id=\"example\"><span>Example</span></h4>\n<p>A working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/06-mongoose\">here</a>.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-mvc',\n  templateUrl: './mvc.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class MvcComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/mvc.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"model-view-controller\">Model-View-Controller</h3>\n<p>Nest, by default, makes use of the <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/express\">Express</a> library under the hood. Hence, every technique for using the MVC (Model-View-Controller) pattern in Express applies to Nest as well.</p>\n<p>First, let&#39;s scaffold a simple Nest application using the <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest-cli\">CLI</a> tool:</p>\n<pre><code class=\"language-bash\">\n$ npm i -g @nestjs/cli\n$ nest new project</code></pre>\n<p>In order to create an MVC app, we also need a <a rel='nofollow' target='_blank' href=\"http://expressjs.com/en/guide/using-template-engines.html\">template engine</a> to render our HTML views:</p>\n<pre><code class=\"language-bash\">\n$ npm install --save hbs</code></pre>\n<p>We&#39;ve used the <code>hbs</code> (<a rel='nofollow' target='_blank' href=\"https://github.com/pillarjs/hbs#readme\">Handlebars</a>) engine, though you can use whatever fits your requirements. Once the installation process is complete, we need to configure the express instance using the following code:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app3c27ee139be1ac721fd9d17a21f3d29b66276930.isJsActive }}\n<app-tabs #app3c27ee139be1ac721fd9d17a21f3d29b66276930></app-tabs>\n</span><pre [class.hide]=\"app3c27ee139be1ac721fd9d17a21f3d29b66276930.isJsActive\"><code class=\"language-typescript\">\nimport &#123; NestFactory &#125; from &#39;@nestjs/core&#39;;\nimport &#123; NestExpressApplication &#125; from &#39;@nestjs/platform-express&#39;;\nimport &#123; join &#125; from &#39;path&#39;;\nimport &#123; AppModule &#125; from &#39;./app.module&#39;;\n\nasync function bootstrap() &#123;\n  const app = await NestFactory.create&lt;NestExpressApplication&gt;(\n    AppModule,\n  );\n\n  app.useStaticAssets(join(__dirname, &#39;..&#39;, &#39;public&#39;));\n  app.setBaseViewsDir(join(__dirname, &#39;..&#39;, &#39;views&#39;));\n  app.setViewEngine(&#39;hbs&#39;);\n\n  await app.listen(3000);\n&#125;\nbootstrap();</code></pre>\n<pre [class.hide]=\"!app3c27ee139be1ac721fd9d17a21f3d29b66276930.isJsActive\"><code class=\"language-typescript\">\nimport &#123; NestFactory &#125; from &#39;@nestjs/core&#39;;\nimport &#123; join &#125; from &#39;path&#39;;\nimport &#123; AppModule &#125; from &#39;./app.module&#39;;\n\nasync function bootstrap() &#123;\n  const app = await NestFactory.create(\n    AppModule,\n  );\n\n  app.useStaticAssets(join(__dirname, &#39;..&#39;, &#39;public&#39;));\n  app.setBaseViewsDir(join(__dirname, &#39;..&#39;, &#39;views&#39;));\n  app.setViewEngine(&#39;hbs&#39;);\n\n  await app.listen(3000);\n&#125;\nbootstrap();</code></pre><p>We told <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/express\">Express</a> that the <code>public</code> directory will be used for storing static assets, <code>views</code> will contain templates, and the <code>hbs</code> template engine should be used to render HTML output.</p>\n<h4 appAnchor id=\"template-rendering\"><span>Template rendering</span></h4>\n<p>Now, let&#39;s create a <code>views</code> directory and <code>index.hbs</code> template inside it. In the template, we&#39;ll print a <code>message</code> passed from the controller:</p>\n<pre><code class=\"language-html\">\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=&quot;utf-8&quot; /&gt;\n    &lt;title&gt;App&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &#123;&#123; &quot;&#123;&#123; message &#125;\\&#125;&quot; &#125;&#125;\n  &lt;/body&gt;\n&lt;/html&gt;</code></pre>\n<p>Next, open the <code>app.controller</code> file and replace the <code>root()</code> method with the following code:</p>\n\n<span class=\"filename\">\n  {{ 'app.controller' | extension: app7a3ccfc5be0013a2cb3ba4a57632c5cd61829bd5.isJsActive }}\n<app-tabs #app7a3ccfc5be0013a2cb3ba4a57632c5cd61829bd5></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Get, Controller, Render &#125; from &#39;@nestjs/common&#39;;\n\n@Controller()\nexport class AppController &#123;\n  @Get()\n  @Render(&#39;index&#39;)\n  root() &#123;\n    return &#123; message: &#39;Hello world!&#39; &#125;;\n  &#125;\n&#125;</code></pre><p>In this code, we are specifying the template to use in the <code>@Render()</code> decorator, and the return value of the route handler method is passed to the template for rendering. Notice that the return value is an object with a property <code>message</code>, matching the <code>message</code> placeholder we created in the template.</p>\n<p>While the application is running, open your browser and navigate to <code>http://localhost:3000</code>. You should see the <code>Hello world!</code> message.</p>\n<h4 appAnchor id=\"dynamic-template-rendering\"><span>Dynamic template rendering</span></h4>\n<p>If the application logic must dynamically decide which template to render, then we should use the <code>@Res()</code> decorator, and supply the view name in our route handler, rather than in the <code>@Render()</code> decorator:</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> When Nest detects the <code>@Res()</code> decorator, it injects the library-specific <code>response</code> object. We can use this object to dynamically render the template. Learn more about the <code>response</code> object API <a rel='nofollow' target='_blank' href=\"http://expressjs.com/en/api.html\">here</a>.\n</blockquote>\n\n<span class=\"filename\">\n  {{ 'app.controller' | extension: appe23a2c9da91651cef02c9cdf51818f71e2c58319.isJsActive }}\n<app-tabs #appe23a2c9da91651cef02c9cdf51818f71e2c58319></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Get, Controller, Render &#125; from &#39;@nestjs/common&#39;;\nimport &#123; Response &#125; from &#39;express&#39;;\nimport &#123; AppService &#125; from &#39;./app.service&#39;;\n\n@Controller()\nexport class AppController &#123;\n  constructor(private readonly appService: AppService) &#123;&#125;\n\n  @Get()\n  root(@Res() res: Response) &#123;\n    return res.render(\n      this.appService.getViewName(),\n      &#123; message: &#39;Hello world!&#39; &#125;,\n    );\n  &#125;\n&#125;</code></pre><h4 appAnchor id=\"example\"><span>Example</span></h4>\n<p>A working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/15-mvc\">here</a>.</p>\n<h4 appAnchor id=\"fastify\"><span>Fastify</span></h4>\n<p>As mentioned in this <a routerLink=\"/techniques/performance\">chapter</a>, we are able to use any compatible HTTP provider together with Nest. One such library is <a rel='nofollow' target='_blank' href=\"https://github.com/fastify/fastify\">Fastify</a>. In order to create an MVC application with Fastify, we have to install the following packages:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save fastify point-of-view handlebars</code></pre>\n<p>The next steps cover almost the same process used with Express, with minor differences specific to the platform. Once the installation process is complete, open the <code>main.ts</code> file and update its contents:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: appe5d594ed587426c2423fd32875641457f0d0bd06.isJsActive }}\n<app-tabs #appe5d594ed587426c2423fd32875641457f0d0bd06></app-tabs>\n</span><pre [class.hide]=\"appe5d594ed587426c2423fd32875641457f0d0bd06.isJsActive\"><code class=\"language-typescript\">\nimport &#123; NestFactory &#125; from &#39;@nestjs/core&#39;;\nimport &#123; NestFastifyApplication, FastifyAdapter &#125; from &#39;@nestjs/platform-fastify&#39;;\nimport &#123; AppModule &#125; from &#39;./app.module&#39;;\nimport &#123; join &#125; from &#39;path&#39;;\n\nasync function bootstrap() &#123;\n  const app = await NestFactory.create&lt;NestFastifyApplication&gt;(\n    AppModule,\n    new FastifyAdapter(),\n  );\n  app.useStaticAssets(&#123;\n    root: join(__dirname, &#39;..&#39;, &#39;public&#39;),\n    prefix: &#39;/public/&#39;,\n  &#125;);\n  app.setViewEngine(&#123;\n    engine: &#123;\n      handlebars: require(&#39;handlebars&#39;),\n    &#125;,\n    templates: join(__dirname, &#39;..&#39;, &#39;views&#39;),\n  &#125;);\n  await app.listen(3000);\n&#125;\nbootstrap();</code></pre>\n<pre [class.hide]=\"!appe5d594ed587426c2423fd32875641457f0d0bd06.isJsActive\"><code class=\"language-typescript\">\nimport &#123; NestFactory &#125; from &#39;@nestjs/core&#39;;\nimport &#123; FastifyAdapter &#125; from &#39;@nestjs/platform-fastify&#39;;\nimport &#123; AppModule &#125; from &#39;./app.module&#39;;\nimport &#123; join &#125; from &#39;path&#39;;\n\nasync function bootstrap() &#123;\n  const app = await NestFactory.create(AppModule, new FastifyAdapter());\n  app.useStaticAssets(&#123;\n    root: join(__dirname, &#39;..&#39;, &#39;public&#39;),\n    prefix: &#39;/public/&#39;,\n  &#125;);\n  app.setViewEngine(&#123;\n    engine: &#123;\n      handlebars: require(&#39;handlebars&#39;),\n    &#125;,\n    templates: join(__dirname, &#39;..&#39;, &#39;views&#39;),\n  &#125;);\n  await app.listen(3000);\n&#125;\nbootstrap();</code></pre><p>The Fastify API is slightly different but the end result of those methods calls remains the same. One difference to notice with Fastify is that the template name passed into the <code>@Render()</code> decorator must include a file extension.</p>\n\n<span class=\"filename\">\n  {{ 'app.controller' | extension: app8dd5c73562795b8b4d328cc7881f724199846970.isJsActive }}\n<app-tabs #app8dd5c73562795b8b4d328cc7881f724199846970></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Get, Controller, Render &#125; from &#39;@nestjs/common&#39;;\n\n@Controller()\nexport class AppController &#123;\n  @Get()\n  @Render(&#39;index.hbs&#39;)\n  root() &#123;\n    return &#123; message: &#39;Hello world!&#39; &#125;;\n  &#125;\n&#125;</code></pre><p>While the application is running, open your browser and navigate to <code>http://localhost:3000</code>. You should see the <code>Hello world!</code> message.</p>\n<h4 appAnchor id=\"example-1\"><span>Example</span></h4>\n<p>A working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/17-mvc-fastify\">here</a>.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-performance',\n  templateUrl: './performance.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PerformanceComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/performance.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"performance-fastify\">Performance (Fastify)</h3>\n<p>By default, Nest makes use of the <a rel='nofollow' target='_blank' href=\"https://expressjs.com/\">Express</a> framework. As mentioned earlier, Nest also provides compatibility with other libraries such as, for example, <a rel='nofollow' target='_blank' href=\"https://github.com/fastify/fastify\">Fastify</a>. Nest achieves this framework independence by implementing a framework adapter whose primary function is to proxy middleware and handlers to appropriate library-specific implementations.</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Note that in order for a framework adapter to be implemented, the target library has to provide similar request/response pipeline processing as found in Express.\n</blockquote>\n<p><a rel='nofollow' target='_blank' href=\"https://github.com/fastify/fastify\">Fastify</a> provides a good alternative framework for Nest because it solves design issues in a similar manner to Express. However, fastify is much <strong>faster</strong> than Express, achieving almost two times better benchmarks results. A fair question is why does Nest use Express as the default HTTP provider? The reason is that Express is widely-used, well-known, and has an enormous set of compatible middleware, which is available to Nest users out-of-the-box.</p>\n<p>But since Nest provides framework-independence, you can easily migrate between them. Fastify can be a better choice when you place high value on very fast performance. To utilize Fastify, simply choose the built-in <code>FastifyAdapter</code> as shown in this chapter.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>First, we need to install the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save @nestjs/platform-fastify</code></pre>\n<h4 appAnchor id=\"adapter\"><span>Adapter</span></h4>\n<p>Once the Fastify platform is installed, we can use the <code>FastifyAdapter</code>.</p>\n<pre><code class=\"language-typescript\">\nimport &#123; NestFactory &#125; from &#39;@nestjs/core&#39;;\nimport &#123;\n  FastifyAdapter,\n  NestFastifyApplication,\n&#125; from &#39;@nestjs/platform-fastify&#39;;\nimport &#123; AppModule &#125; from &#39;./app.module&#39;;\n\nasync function bootstrap() &#123;\n  const app = await NestFactory.create&lt;NestFastifyApplication&gt;(\n    AppModule,\n    new FastifyAdapter()\n  );\n  await app.listen(3000);\n&#125;\nbootstrap();</code></pre>\n<p>By default, Fastify listens only on the <code>localhost 127.0.0.1</code> interface (<a rel='nofollow' target='_blank' href=\"https://www.fastify.io/docs/latest/Getting-Started/#your-first-server\">read more</a>). If you want to accept connections on other hosts, you should specify <code>&#39;0.0.0.0&#39;</code> in the <code>listen()</code> call:</p>\n<pre><code class=\"language-typescript\">\nasync function bootstrap() &#123;\n  const app = await NestFactory.create&lt;NestFastifyApplication&gt;(\n    AppModule,\n    new FastifyAdapter()\n  );\n  await app.listen(3000, &#39;0.0.0.0&#39;);\n&#125;</code></pre>\n<h4 appAnchor id=\"platform-specific-packages\"><span>Platform specific packages</span></h4>\n<p>Keep in mind that when you use the <code>FastifyAdapter</code>, Nest uses Fastify as the <strong>HTTP provider</strong>. This means that each recipe that relies on Express may no longer work. You should, instead, use Fastify equivalent packages.</p>\n<h4 appAnchor id=\"redirect-response\"><span>Redirect response</span></h4>\n<p>Fastify handles redirect responses slightly differently than Express. To do a proper redirect with Fastify, return both the status code and the URL, as follows:</p>\n<pre><code class=\"language-typescript\">\n@Get()\nindex(@Res() res) &#123;\n  res.status(302).redirect(&#39;/login&#39;);\n&#125;</code></pre>\n<h4 appAnchor id=\"fastify-options\"><span>Fastify options</span></h4>\n<p>You can pass options into the Fastify constructor through the <code>FastifyAdapter</code> constructor. For example:</p>\n<pre><code class=\"language-typescript\">\nnew FastifyAdapter(&#123; logger: true &#125;);</code></pre>\n<h4 appAnchor id=\"example\"><span>Example</span></h4>\n<p>A working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/10-fastify\">here</a>.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-queues',\n  templateUrl: './queues.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class QueuesComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/queues.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"queues\">Queues</h3>\n<p>Queues are a powerful design pattern that help you deal with common application scaling and performance challenges. Some examples of problems that Queues can help you solve are:</p>\n<ul>\n<li>Smooth out processing peaks. For example, if users can initiate resource-intensive tasks at arbitrary times, you can add these tasks to a queue instead of performing them synchronously. Then you can have worker processes pull tasks from the queue in a controlled manner. You can easily add new Queue consumers to scale up the back-end task handling as the application scales up.</li>\n<li>Break up monolithic tasks that may otherwise block the Node.js event loop. For example, if a user request requires CPU intensive work like audio transcoding, you can delegate this task to other processes, freeing up user-facing processes to remain responsive.</li>\n<li>Provide a reliable communication channel across various services. For example, you can queue tasks (jobs) in one process or service, and consume them in another. You can be notified (by listening for status events) upon completion, error or other state changes in the job life cycle from any process or service. When Queue producers or consumers fail, their state is preserved and task handling can restart automatically when nodes are restarted.</li>\n</ul>\n<p>Nest provides the <code>@nestjs/bull</code> package as an abstraction/wrapper on top of <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull\">Bull</a>, a popular, well supported, high performance Node.js based Queue system implementation. The package makes it easy to integrate Bull Queues in a Nest-friendly way to your application.</p>\n<p>Bull uses <a rel='nofollow' target='_blank' href=\"https://redis.io/\">Redis</a> to persist job data, so you&#39;ll need to have Redis installed on your system. Because it is Redis-backed, your Queue architecture can be completely distributed and platform-independent. For example, you can have some Queue <a href=\"techniques/queues#producers\">producers</a> and <a href=\"techniques/queues#consumers\">consumers</a> and <a href=\"techniques/queues#event-listeners\">listeners</a> running in Nest on one (or several) nodes, and other producers, consumers and listeners running on other Node.js platforms on other network nodes.</p>\n<p>This chapter covers the <code>@nestjs/bull</code> package. We also recommend reading the <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md\">Bull documentation</a> for more background and specific implementation details.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To begin using it, we first install the required dependencies.</p>\n<pre><code class=\"language-bash\">\n$ npm install --save @nestjs/bull bull\n$ npm install --save-dev @types/bull</code></pre>\n<p>Once the installation process is complete, we can import the <code>BullModule</code> into the root <code>AppModule</code>.</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app95c43e9f72278ca52e06176b847f6e06153e415c.isJsActive }}\n<app-tabs #app95c43e9f72278ca52e06176b847f6e06153e415c></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; BullModule &#125; from &#39;@nestjs/bull&#39;;\n\n@Module(&#123;\n  imports: [\n    BullModule.registerQueue(&#123;\n      name: &#39;audio&#39;,\n      redis: &#123;\n        host: &#39;localhost&#39;,\n        port: 6379,\n      &#125;,\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>The <code>registerQueue()</code> method is used to instantiate and/or register queues. Queues are shared across modules and processes that connect to the same underlying Redis database with the same credentials. Each queue is unique by its name property (see below). When sharing queues (across modules/processes), the first <code>registerQueue()</code> method to run both <strong>instantiates</strong> the queue and <strong>registers</strong> it for that module. Other modules (in the same or separate processes) simply <strong>register</strong> the queue. Queue registration creates an <strong>injection token</strong> that can be used to access the queue in a given Nest module.</p>\n<p>For each queue, pass a configuration object containing the following properties:</p>\n<ul>\n<li><code>name: string</code> - A queue name, which will be used as both an injection token (for injecting the queue into controllers/providers), and as an argument to decorators to associate consumer classes and listeners with queues. Required.</li>\n<li><code>limiter: RateLimiter</code> - Options to control the rate at which the queue&#39;s jobs are processed. See <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queue\">RateLimiter</a> for more information. Optional.</li>\n<li><code>redis: RedisOpts</code> - Options to configure the Redis connection. See <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queue\">RedisOpts</a> for more information. Optional.</li>\n<li><code>prefix: string</code> - Prefix for all queue keys. Optional.</li>\n<li><code>defaultJobOptions: JobOpts</code> - Options to control the default settings for new jobs. See <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queueadd\">JobOpts</a> for more information. Optional.</li>\n<li><code>settings: AdvancedSettings</code> - Advanced Queue configuration settings. These should usually not be changed. See <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queue\">AdvancedSettings</a> for more information. Optional.</li>\n</ul>\n<p>As noted, the <code>name</code> property is required. The rest of the options are optional, providing detailed control over queue behavior. These are passed directly to the Bull <code>Queue</code> constructor. Read more about these options <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queue\">here</a>. When registering a queue in a second or subsequent module, it is best practice to omit all options but the <code>name</code> property from the configuration object. These options should be specified only in the module that <strong>instantiates</strong> the queue.</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Create multiple queues by passing multiple comma-separated configuration objects to the <code>registerQueue()</code> method.\n</blockquote>\n<p>Since jobs are persisted in Redis, each time a specific named queue is instantiated (e.g., when an app is started/restarted), it attempts to process any old jobs that may exist from a previous unfinished session.</p>\n<p>Each queue can have one or many producers, consumers, and listeners. Consumers retrieve jobs from the queue in a specific order: FIFO (the default), LIFO, or according to priorities. Controlling queue processing order is discussed <a href=\"techniques/queues#consumers\">here</a>.</p>\n<p><app-banner-enterprise></app-banner-enterprise></p>\n<h4 appAnchor id=\"producers\"><span>Producers</span></h4>\n<p>Job producers add jobs to queues. Producers are typically application services (Nest <a routerLink=\"/providers\">providers</a>). To add jobs to a queue, first inject the queue into the service as follows:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; Queue &#125; from &#39;bull&#39;;\nimport &#123; InjectQueue &#125; from &#39;@nestjs/bull&#39;;\n\n@Injectable()\nexport class AudioService &#123;\n  constructor(@InjectQueue(&#39;audio&#39;) private readonly audioQueue: Queue) &#123;&#125;\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>@InjectQueue()</code> decorator identifies the queue by its name, as provided in the <code>registerQueue()</code> method call (e.g., <code>&#39;audio&#39;</code>).\n</blockquote>\n<p>Now, add a job by calling the queue&#39;s <code>add()</code> method, passing a user-defined job object. Jobs are represented as serializable JavaScript objects (since that is how they are stored in the Redis database). The shape of the job you pass is arbitrary; use it to represent the semantics of your job object.</p>\n<pre><code class=\"language-typescript\">\nconst job = await this.audioQueue.add(&#123;\n  foo: &#39;bar&#39;,\n&#125;);</code></pre>\n<h4 appAnchor id=\"named-jobs\"><span>Named jobs</span></h4>\n<p>Jobs may have unique names. This allows you to create specialized <a href=\"techniques/queues#consumers\">consumers</a> that will only process jobs with a given name.</p>\n<pre><code class=\"language-typescript\">\nconst job = await this.audioQueue.add(&#39;transcode&#39;, &#123;\n  foo: &#39;bar&#39;,\n&#125;);</code></pre>\n<blockquote class=\"\nWarning \"><strong>Warning</strong> When using named jobs, you must create processors for each unique name added to a queue, or the queue will complain that you are missing a processor for the given job. See <a href=\"techniques/queues#consumers\">here</a> for more information on consuming named jobs.\n</blockquote>\n<h4 appAnchor id=\"job-options\"><span>Job options</span></h4>\n<p>Jobs can have additional options associated with them. Pass an options object after the <code>job</code> argument in the <code>Queue.add()</code> method. Job options properties are:</p>\n<ul>\n<li><code>priority</code>: <code>number</code> - Optional priority value. Ranges from 1 (highest priority) to MAX_INT (lowest priority). Note that using priorities has a slight impact on performance, so use them with caution.</li>\n<li><code>delay</code>: <code>number</code> - An amount of time (milliseconds) to wait until this job can be processed. Note that for accurate delays, both server and clients should have their clocks synchronized.</li>\n<li><code>attempts</code>: <code>number</code> - The total number of attempts to try the job until it completes.</li>\n<li><code>repeat</code>: <code>RepeatOpts</code> - Repeat job according to a cron specification. See <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queueadd\">RepeatOpts</a>.</li>\n<li><code>backoff</code>: <code>number | BackoffOpts</code> - Backoff setting for automatic retries if the job fails. See <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queueadd\">BackoffOpts</a>.</li>\n<li><code>lifo</code>: <code>boolean</code> - If true, adds the job to the right end of the queue instead of the left (default false).</li>\n<li><code>timeout</code>: <code>number</code> - The number of milliseconds after which the job should fail with a timeout error.</li>\n<li><code>jobId</code>: <code>number</code> | <code>string</code> - Override the job ID - by default, the job ID is a unique\ninteger, but you can use this setting to override it. If you use this option, it is up to you to ensure the jobId is unique. If you attempt to add a job with an id that already exists, it will not be added.</li>\n<li><code>removeOnComplete</code>: <code>boolean | number</code> - If true, removes the job when it successfully completes. A number specifies the amount of jobs to keep. Default behavior is to keep the job in the completed set.</li>\n<li><code>removeOnFail</code>: <code>boolean | number</code> - If true, removes the job when it fails after all attempts. A number specifies the amount of jobs to keep. Default behavior is to keep the job in the failed set.</li>\n<li><code>stackTraceLimit</code>: <code>number</code> - Limits the amount of stack trace lines that will be recorded in the stacktrace.</li>\n</ul>\n<p>Here are a few examples of customizing jobs with job options.</p>\n<p>To delay the start of a job, use the <code>delay</code> configuration property.</p>\n<pre><code class=\"language-typescript\">\nconst job = await this.audioQueue.add(\n  &#123;\n    foo: &#39;bar&#39;,\n  &#125;,\n  &#123; delay: 3000 &#125;, // 3 seconds delayed\n);</code></pre>\n<p>To add a job to the right end of the queue (process the job as <strong>LIFO</strong> (Last In First Out)), set the <code>lifo</code> property of the configuration object to <code>true</code>.</p>\n<pre><code class=\"language-typescript\">\nconst job = await this.audioQueue.add(\n  &#123;\n    foo: &#39;bar&#39;,\n  &#125;,\n  &#123; lifo: true &#125;,\n);</code></pre>\n<p>To prioritize a job, use the <code>priority</code> property.</p>\n<pre><code class=\"language-typescript\">\nconst job = await this.audioQueue.add(\n  &#123;\n    foo: &#39;bar&#39;,\n  &#125;,\n  &#123; priority: 2 &#125;,\n);</code></pre>\n<h4 appAnchor id=\"consumers\"><span>Consumers</span></h4>\n<p>A consumer is a <strong>class</strong> defining methods that either process jobs added into the queue, or listen for events on the queue, or both. Declare a consumer class using the <code>@Processor()</code> decorator as follows:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Processor &#125; from &#39;@nestjs/bull&#39;;\n\n@Processor(&#39;audio&#39;)\nexport class AudioConsumer &#123;&#125;</code></pre>\n<p>Where the decorator&#39;s string argument (e.g., <code>&#39;audio&#39;</code>) is the name of the queue to be associated with the class methods.</p>\n<p>Within a consumer class, declare job handlers by decorating handler methods with the <code>@Process()</code> decorator.</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Processor, Process &#125; from &#39;@nestjs/bull&#39;;\nimport &#123; Job &#125; from &#39;bull&#39;;\n\n@Processor(&#39;audio&#39;)\nexport class AudioConsumer &#123;\n  @Process()\n  async transcode(job: Job&lt;unknown&gt;) &#123;\n    let progress = 0;\n    for (i = 0; i &lt; 100; i++) &#123;\n      await doSomething(job.data);\n      progress += 10;\n      job.progress(progress);\n    &#125;\n    return &#123;&#125;;\n  &#125;\n&#125;</code></pre>\n<p>The decorated method (e.g., <code>transcode()</code>) is called whenever the worker is idle and there are jobs to process in the queue. This handler method receives the <code>job</code> object as its only argument. The value returned by the handler method is stored in the job object and can be accessed later on, for example in a listener for the completed event.</p>\n<p><code>Job</code> objects have multiple methods that allow you to interact with their state. For example, the above code uses the <code>progress()</code> method to update the job&#39;s progress. See <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#job\">here</a> for the complete <code>Job</code> object API reference.</p>\n<p>You can designate that a job handler method will handle <strong>only</strong> jobs of a certain type (jobs with a specific <code>name</code>) by passing that <code>name</code> to the <code>@Process()</code> decorator as shown below. You can have multiple <code>@Process()</code> handlers in a given consumer class, corresponding to each job type (<code>name</code>). When you use named jobs, be sure to have a handler corresponding to each name.</p>\n<pre><code class=\"language-typescript\">\n@Process(&#39;transcode&#39;)\nasync transcode(job: Job&lt;unknown&gt;) &#123; ... &#125;</code></pre>\n<h4 appAnchor id=\"event-listeners\"><span>Event listeners</span></h4>\n<p>Bull generates a set of useful events when queue and/or job state changes occur. Nest provides a set of decorators that allow subscribing to a core set of standard events. These are exported from the <code>@nestjs/bull</code> package.</p>\n<p>Event listeners must be declared within a <a href=\"techniques/queues#consumers\">consumer</a> class (i.e., within a class decorated with the <code>@Processor()</code> decorator). To listen for an event, use one of the decorators in the table below to declare a handler for the event. For example, to listen to the event emitted when a job enters the active state in the <code>audio</code> queue, use the following construct:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Processor, Process &#125; from &#39;@nestjs/bull&#39;;\nimport &#123; Job &#125; from &#39;bull&#39;;\n\n@Processor(&#39;audio&#39;)\nexport class AudioConsumer &#123;\n\n  @OnQueueActive()\n  onActive(job: Job) &#123;\n    console.log(\n      `Processing job $&#123;job.id&#125; of type $&#123;job.name&#125; with data $&#123;job.data&#125;...`,\n    );\n  &#125;\n  ...</code></pre>\n<p>Since Bull operates in a distributed (multi-node) environment, it defines the concept of event locality. This concept recognizes that events may be triggered either entirely within a single process, or on shared queues from different processes. A <strong>local</strong> event is one that is produced when an action or state change is triggered on a queue in the local process. In other words, when your event producers and consumers are local to a single process, all events happening on queues are local.</p>\n<p>When a queue is shared across multiple processes, we encounter the possibility of <strong>global</strong> events. For a listener in one process to receive an event notification triggered by another process, it must register for a global event.</p>\n<p>Event handlers are invoked whenever their corresponding event is emitted. The handler is called with the signature shown in the table below, providing access to information relevant to the event. We discuss one key difference between local and global event handler signatures below.</p>\n<table>\n  <tr>\n    <th>Local event listeners</th>\n    <th>Global event listeners</th>\n    <th>Handler method signature / When fired</th>\n  </tr>\n  <tr>\n    <td><code>@OnQueueError()</code></td><td><code>@OnGlobalQueueError()</code></td><td><code>handler(error: Error)</code> - An error occurred. <code>error</code> contains the triggering error.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueWaiting()</code></td><td><code>@OnGlobalQueueWaiting()</code></td><td><code>handler(jobId: number | string)</code> - A Job is waiting to be processed as soon as a worker is idling. <code>jobId</code> contains the id for the job that has entered this state.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueActive()</code></td><td><code>@OnGlobalQueueActive()</code></td><td><code>handler(job: Job)</code> - Job <code>job</code>has started. </td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueStalled()</code></td><td><code>@OnGlobalQueueStalled()</code></td><td><code>handler(job: Job)</code> - Job <code>job</code> has been marked as stalled. This is useful for debugging job workers that crash or pause the event loop.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueProgress()</code></td><td><code>@OnGlobalQueueProgress()</code></td><td><code>handler(job: Job, progress: number)</code> - Job <code>job</code>'s progress was updated to value <code>progress</code>.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueCompleted()</code></td><td><code>@OnGlobalQueueCompleted()</code></td><td><code>handler(job: Job, result: any)</code> Job <code>job</code> successfully completed with a result <code>result</code>.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueFailed()</code></td><td><code>@OnGlobalQueueFailed()</code></td><td><code>handler(job: Job, err: Error)</code> Job <code>job</code> failed with reason <code>err</code>.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueuePaused()</code></td><td><code>@OnGlobalQueuePaused()</code></td><td><code>handler()</code> The queue has been paused.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueResumed()</code></td><td><code>@OnGlobalQueueResumed()</code></td><td><code>handler(job: Job)</code> The queue has been resumed.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueCleaned()</code></td><td><code>@OnGlobalQueueCleaned()</code></td><td><code>handler(jobs: Job[], type: string)</code> Old jobs have been cleaned from the queue. <code>jobs</code> is an array of cleaned jobs, and <code>type</code> is the type of jobs cleaned.</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueDrained()</code></td><td><code>@OnGlobalQueueDrained()</code></td><td><code>handler()</code> Emitted whenever the queue has processed all the waiting jobs (even if there can be some delayed jobs not yet processed).</td>\n  </tr>\n  <tr>\n    <td><code>@OnQueueRemoved()</code></td><td><code>@OnGlobalQueueRemoved()</code></td><td><code>handler(job: Job)</code> Job <code>job</code> was successfully removed.</td>\n  </tr>\n</table>\n\n<p>When listening for global events, the method signatures can be slightly different from their local counterpart. Specifically, any method signature that receives <code>job</code> objects in the local version, instead receives a <code>jobId</code> (<code>number</code>) in the global version. To get a reference to the actual <code>job</code> object in such a case, use the <code>Queue#getJob</code> method. This call should be awaited, and therefore the handler should be declared <code>async</code>. For example:</p>\n<pre><code class=\"language-typescript\">\n@OnGlobalQueueCompleted()\nasync onGlobalCompleted(jobId: number, result: any) &#123;\n  const job = await this.immediateQueue.getJob(jobId);\n  console.log(&#39;(Global) on completed: job &#39;, job.id, &#39; -&gt; result: &#39;, result);\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> To access the <code>Queue</code> object (to make a <code>getJob()</code> call), you must of course inject it. Also, the Queue must be registered in the module where you are injecting it.\n</blockquote>\n<p>In addition to the specific event listener decorators, you can also use the generic <code>@OnQueueEvent()</code> decorator in combination with either <code>BullQueueEvents</code> or <code>BullQueueGlobalEvents</code> enums. Read more about events <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#events\">here</a>.</p>\n<h4 appAnchor id=\"queue-management\"><span>Queue management</span></h4>\n<p>Queue&#39;s have an API that allows you to perform management functions like pausing and resuming, retrieving the count of jobs in various states, and several more. You can find the full queue API <a rel='nofollow' target='_blank' href=\"https://github.com/OptimalBits/bull/blob/master/REFERENCE.md#queue\">here</a>. Invoke any of these methods directly on the <code>Queue</code> object, as shown below with the pause/resume examples.</p>\n<p>Pause a queue with the <code>pause()</code> method call. A paused queue will not process new jobs until resumed, but current jobs being processed will continue until they are finalized.</p>\n<pre><code class=\"language-typescript\">\nawait audioQueue.pause();</code></pre>\n<p>To resume a paused queue, use the <code>resume()</code> method, as follows:</p>\n<pre><code class=\"language-typescript\">\nawait audioQueue.resume();</code></pre>\n<h4 appAnchor id=\"async-configuration\"><span>Async configuration</span></h4>\n<p>You may want to pass your queue options asynchronously instead of statically. In this case, use the <code>registerQueueAsync()</code> method, which provides several ways to deal with async configuration.</p>\n<p>One approach is to use a factory function:</p>\n<pre><code class=\"language-typescript\">\nBullModule.registerQueueAsync(&#123;\n  name: &#39;audio&#39;,\n  useFactory: () =&gt; (&#123;\n    redis: &#123;\n      host: &#39;localhost&#39;,\n      port: 6379,\n    &#125;,\n  &#125;),\n&#125;);</code></pre>\n<p>Our factory behaves like any other <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/async-providers\">asynchronous provider</a> (e.g., it can be <code>async</code> and it&#39;s able to inject dependencies through <code>inject</code>).</p>\n<pre><code class=\"language-typescript\">\nBullModule.registerQueueAsync(&#123;\n  name: &#39;audio&#39;,\n  imports: [ConfigModule],\n  useFactory: async (configService: ConfigService) =&gt; (&#123;\n    redis: &#123;\n      host: configService.get(&#39;QUEUE_HOST&#39;),\n      port: +configService.get(&#39;QUEUE_PORT&#39;),\n    &#125;,\n  &#125;),\n  inject: [ConfigService],\n&#125;);</code></pre>\n<p>Alternatively, you can use the <code>useClass</code> syntax:</p>\n<pre><code class=\"language-typescript\">\nBullModule.registerQueueAsync(&#123;\n  name: &#39;audio&#39;,\n  useClass: BullConfigService,\n&#125;);</code></pre>\n<p>The construction above will instantiate <code>BullConfigService</code> inside <code>BullModule</code> and use it to provide an options object by calling <code>createBullOptions()</code>. Note that this means that the <code>BullConfigService</code> has to implement the <code>BullOptionsFactory</code> interface, as shown below:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nclass BullConfigService implements BullOptionsFactory &#123;\n  createBullOptions(): BullModuleOptions &#123;\n    return &#123;\n      redis: &#123;\n        host: &#39;localhost&#39;,\n        port: 6379,\n      &#125;,\n    &#125;;\n  &#125;\n&#125;</code></pre>\n<p>In order to prevent the creation of <code>BullConfigService</code> inside <code>BullModule</code> and use a provider imported from a different module, you can use the <code>useExisting</code> syntax.</p>\n<pre><code class=\"language-typescript\">\nBullModule.registerQueueAsync(&#123;\n  name: &#39;audio&#39;,\n  imports: [ConfigModule],\n  useExisting: ConfigService,\n&#125;);</code></pre>\n<p>This construction works the same as <code>useClass</code> with one critical difference - <code>BullModule</code> will lookup imported modules to reuse an existing <code>ConfigService</code> instead of instantiating a new one.</p>\n<h4 appAnchor id=\"example\"><span>Example</span></h4>\n<p>A working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/26-queues\">here</a>.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-securit',\n  templateUrl: './security.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class SecurityComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/security.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"security\">Security</h3>\n<p>In this chapter we cover various techniques that help you to increase the security of your applications.</p>\n<h4 appAnchor id=\"helmet\"><span>Helmet</span></h4>\n<p><a rel='nofollow' target='_blank' href=\"https://github.com/helmetjs/helmet\">Helmet</a> can help protect your app from some well-known web vulnerabilities by setting HTTP headers appropriately. Generally, Helmet is just a collection of 14 smaller middleware functions that set security-related HTTP headers (read <a rel='nofollow' target='_blank' href=\"https://github.com/helmetjs/helmet#how-it-works\">more</a>).</p>\n<p>Start by installing the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save helmet</code></pre>\n<p>Once the installation is complete, apply it as a global middleware.</p>\n<pre><code class=\"language-typescript\">\nimport * as helmet from &#39;helmet&#39;;\n// somewhere in your initialization file\napp.use(helmet());</code></pre>\n<h4 appAnchor id=\"cors\"><span>CORS</span></h4>\n<p>Cross-origin resource sharing (CORS) is a mechanism that allows resources to be requested from another domain. Under the hood, Nest makes use of the Express <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/cors\">cors</a> package. This package provides various options that you can customize based on your requirements. To enable CORS, call the <code>enableCors()</code> method on the Nest application object.</p>\n<pre><code class=\"language-typescript\">\nconst app = await NestFactory.create(AppModule);\napp.enableCors();\nawait app.listen(3000);</code></pre>\n<p>The <code>enableCors()</code> method takes an optional configuration object argument. The available properties of this object are described in the official <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/cors#configuration-options\">CORS</a> documentation.</p>\n<p>Alternatively, enable CORS via the <code>create()</code> method&#39;s options object. Set the <code>cors</code> property to <code>true</code> to enable CORS with default settings. Alternatively, pass a <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/cors#configuration-options\">CORS configuration object</a> as the <code>cors</code> property value to customize its behavior.</p>\n<pre><code class=\"language-typescript\">\nconst app = await NestFactory.create(AppModule, &#123; cors: true &#125;);\nawait app.listen(3000);</code></pre>\n<h4 appAnchor id=\"csrf\"><span>CSRF</span></h4>\n<p>Cross-site request forgery (also known as CSRF or XSRF) is a type of malicious exploit of a website where <strong>unauthorized</strong> commands are transmitted from a user that the web application trusts. To mitigate this kind of attack you can use the <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/csurf\">csurf</a> package.</p>\n<p>Start by installing the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save csurf</code></pre>\n<blockquote class=\"\nwarning \"><strong>Warning</strong> As explained on the <a rel='nofollow' target='_blank' href=\"https://github.com/expressjs/csurf#csurf\">csurf middleware page</a>, the csurf module requires either session middleware or a cookie-parser to be initialized first. Please see that documentation for further instructions.\n</blockquote>\n<p>Once the installation is complete, apply the csurf middleware as global middleware.</p>\n<pre><code class=\"language-typescript\">\nimport * as csurf from &#39;csurf&#39;;\n// somewhere in your initialization file\napp.use(csurf());</code></pre>\n<h4 appAnchor id=\"rate-limiting\"><span>Rate limiting</span></h4>\n<p>A common technique to protect applications from brute-force attacks is <strong>rate-limiting</strong>. Many Express packages exist to provide a rate-limiting feature. A popular one is <a rel='nofollow' target='_blank' href=\"https://github.com/nfriedly/express-rate-limit\">express-rate-limit</a>.</p>\n<p>Start by installing the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save express-rate-limit</code></pre>\n<p>Once the installation is complete, apply the rate-limiter as global middleware.</p>\n<pre><code class=\"language-typescript\">\nimport * as rateLimit from &#39;express-rate-limit&#39;;\n// somewhere in your initialization file\napp.use(\n  rateLimit(&#123;\n    windowMs: 15 * 60 * 1000, // 15 minutes\n    max: 100, // limit each IP to 100 requests per windowMs\n  &#125;),\n);</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> If you use the <code>FastifyAdapter</code>, consider using <a rel='nofollow' target='_blank' href=\"https://github.com/fastify/fastify-rate-limit\">fastify-rate-limit</a> instead.\n</blockquote>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-serialization',\n  templateUrl: './serialization.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class SerializationComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/serialization.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"serialization\">Serialization</h3>\n<p>Serialization is a process that happens before objects are returned in a network response. This is an appropriate place to provide rules for transforming and sanitizing the data to be returned to the client. For example, sensitive data like passwords should always be excluded from the response. Or, certain properties might require additional transformation, such as sending only a subset of properties of an entity. Performing these transformations manually can be tedious and error prone, and can leave you uncertain that all cases have been covered.</p>\n<h4 appAnchor id=\"overview\"><span>Overview</span></h4>\n<p>Nest provides a built-in capability to help ensure that these operations can be performed in a straightforward way. The <code>ClassSerializerInterceptor</code> interceptor uses the powerful <a rel='nofollow' target='_blank' href=\"https://github.com/typestack/class-transformer\">class-transformer</a> package to provide a declarative and extensible way of transforming objects. The basic operation it performs is to take the value returned by a method handler and apply the <code>classToPlain()</code> function from <a rel='nofollow' target='_blank' href=\"https://github.com/typestack/class-transformer\">class-transformer</a>. In doing so, it can apply rules expressed by <code>class-transformer</code> decorators on an entity/DTO class, as described below.</p>\n<h4 appAnchor id=\"exclude-properties\"><span>Exclude properties</span></h4>\n<p>Let&#39;s assume that we want to automatically exclude a <code>password</code> property from a user entity. We annotate the entity as follows:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Exclude &#125; from &#39;class-transformer&#39;;\n\nexport class UserEntity &#123;\n  id: number;\n  firstName: string;\n  lastName: string;\n\n  @Exclude()\n  password: string;\n\n  constructor(partial: Partial&lt;UserEntity&gt;) &#123;\n    Object.assign(this, partial);\n  &#125;\n&#125;</code></pre>\n<p>Now consider a controller with a method handler that returns an instance of this class.</p>\n<pre><code class=\"language-typescript\">\n@UseInterceptors(ClassSerializerInterceptor)\n@Get()\nfindOne(): UserEntity &#123;\n  return new UserEntity(&#123;\n    id: 1,\n    firstName: &#39;Kamil&#39;,\n    lastName: &#39;Mysliwiec&#39;,\n    password: &#39;password&#39;,\n  &#125;);\n&#125;</code></pre>\n<blockquote class=\"\n\"><strong>Warning</strong> Note that we must return an instance of the class. If you return a plain JavaScript object, for example, <code>{{ &#39;{&#39; }} user: new UserEntity() {{ &#39;}&#39; }}</code>, the object won&#39;t be properly serialized.\n</blockquote>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>ClassSerializerInterceptor</code> is imported from <code>@nestjs/common</code>.\n</blockquote>\n<p>When this endpoint is requested, the client receives the following response:</p>\n<pre><code class=\"language-json\">\n&#123;\n  &quot;id&quot;: 1,\n  &quot;firstName&quot;: &quot;Kamil&quot;,\n  &quot;lastName&quot;: &quot;Mysliwiec&quot;\n&#125;</code></pre>\n<p>Note that the interceptor can be applied application-wide (as covered <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/interceptors#binding-interceptors\">here</a>). The combination of the interceptor and the entity class declaration ensures that <strong>any</strong> method that returns a <code>UserEntity</code> will be sure to remove the <code>password</code> property. This gives you a measure of centralized enforcement of this business rule.</p>\n<h4 appAnchor id=\"expose-properties\"><span>Expose properties</span></h4>\n<p>You can use the <code>@Expose()</code> decorator to provide alias names for properties, or to execute a function to calculate a property value (analogous to <strong>getter</strong> functions), as shown below.</p>\n<pre><code class=\"language-typescript\">\n@Expose()\nget fullName(): string &#123;\n  return `$&#123;this.firstName&#125; $&#123;this.lastName&#125;`;\n&#125;</code></pre>\n<h4 appAnchor id=\"transform\"><span>Transform</span></h4>\n<p>You can perform additional data transformation using the <code>@Transform()</code> decorator. For example, the following construct returns the name property of the <code>RoleEntity</code> instead of returning the whole object.</p>\n<pre><code class=\"language-typescript\">\n@Transform(role =&gt; role.name)\nrole: RoleEntity;</code></pre>\n<h4 appAnchor id=\"pass-options\"><span>Pass options</span></h4>\n<p>You may want to modify the default behavior of the transformation functions. To override default settings, pass them in an <code>options</code> object with the <code>@SerializeOptions()</code> decorator.</p>\n<pre><code class=\"language-typescript\">\n@SerializeOptions(&#123;\n  excludePrefixes: [&#39;_&#39;],\n&#125;)\n@Get()\nfindOne(): UserEntity &#123;\n  return new UserEntity();\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>@SerializeOptions()</code> decorator is imported from <code>@nestjs/common</code>.\n</blockquote>\n<p>Options passed via <code>@SerializeOptions()</code> are passed as the second argument of the underlying <code>classToPlain()</code> function. In this example, we are automatically excluding all properties that begin with the <code>_</code> prefix.</p>\n<h4 appAnchor id=\"websockets-and-microservices\"><span>WebSockets and Microservices</span></h4>\n<p>While this chapter shows examples using HTTP style applications (e.g., Express or Fastify), the <code>ClassSerializerInterceptor</code> works the same for WebSockets and Microservices, regardless of the transport method that is used.</p>\n<h4 appAnchor id=\"learn-more\"><span>Learn more</span></h4>\n<p>Read more about available decorators and options as provided by the <code>class-transformer</code> package <a rel='nofollow' target='_blank' href=\"https://github.com/typestack/class-transformer\">here</a>.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-sql',\n  templateUrl: './sql.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class SqlComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/sql.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"database\">Database</h3>\n<p>Nest is database agnostic, allowing you to easily integrate with any SQL or NoSQL database. You have a number of options available to you, depending on your preferences. At the most general level, connecting Nest to a database is simply a matter of loading an appropriate Node.js driver for the database, just as you would with <a rel='nofollow' target='_blank' href=\"https://expressjs.com/en/guide/database-integration.html\">Express</a> or Fastify.</p>\n<p>You can also directly use any general purpose Node.js database integration <strong>library</strong> or ORM, such as <a rel='nofollow' target='_blank' href=\"https://sequelize.org/\">Sequelize</a> (navigate to the <a href=\"/techniques/database#sequelize-integration\">Sequelize integration</a> section), <a rel='nofollow' target='_blank' href=\"http://knexjs.org/\">Knex.js</a> (<a rel='nofollow' target='_blank' href=\"https://dev.to/nestjs/build-a-nestjs-module-for-knex-js-or-other-resource-based-libraries-in-5-minutes-12an\">tutorial</a>) and <a rel='nofollow' target='_blank' href=\"https://github.com/typeorm/typeorm\">TypeORM</a>, to operate at a higher level of abstraction.</p>\n<p>For convenience, Nest provides tight integration with TypeORM and Sequelize out-of-the-box with the <code>@nestjs/typeorm</code> and <code>@nestjs/sequelize</code> packages respectively, which we&#39;ll cover in the current chapter, and Mongoose with <code>@nestjs/mongoose</code>, which is covered in <a routerLink=\"/techniques/mongodb\">this chapter</a>. These integrations provide additional NestJS-specific features, such as model/repository injection, testability, and asynchronous configuration to make accessing your chosen database even easier.</p>\n<h3 id=\"typeorm-integration\">TypeORM Integration</h3>\n<p>For integrating with SQL and NoSQL databases, Nest provides the <code>@nestjs/typeorm</code> package. Nest uses <a rel='nofollow' target='_blank' href=\"https://github.com/typeorm/typeorm\">TypeORM</a> because it&#39;s the most mature Object Relational Mapper (ORM) available for TypeScript. Since it&#39;s written in TypeScript, it integrates well with the Nest framework.</p>\n<p>To begin using it, we first install the required dependencies. In this chapter, we&#39;ll demonstrate using the popular <a rel='nofollow' target='_blank' href=\"https://www.mysql.com/\">MySQL</a> Relational DBMS, but TypeORM provides support for many relational databases, such as PostgreSQL, Oracle, Microsoft SQL Server, SQLite, and even NoSQL databases like MongoDB. The procedure we walk through in this chapter will be the same for any database supported by TypeORM. You&#39;ll simply need to install the associated client API libraries for your selected database.</p>\n<pre><code class=\"language-bash\">\n$ npm install --save @nestjs/typeorm typeorm mysql</code></pre>\n<p>Once the installation process is complete, we can import the <code>TypeOrmModule</code> into the root <code>AppModule</code>.</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: appfc65623c8abf83ebd928cc7a5b53358d70e957b3.isJsActive }}\n<app-tabs #appfc65623c8abf83ebd928cc7a5b53358d70e957b3></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; TypeOrmModule &#125; from &#39;@nestjs/typeorm&#39;;\n\n@Module(&#123;\n  imports: [\n    TypeOrmModule.forRoot(&#123;\n      type: &#39;mysql&#39;,\n      host: &#39;localhost&#39;,\n      port: 3306,\n      username: &#39;root&#39;,\n      password: &#39;root&#39;,\n      database: &#39;test&#39;,\n      entities: [],\n      synchronize: true,\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>The <code>forRoot()</code> method supports all the configuration properties exposed by the <code>createConnection()</code> function from the <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/connection-options\">TypeORM</a> package. In addition, there are several extra configuration properties described below.</p>\n<table>\n  <tr>\n    <td><code>retryAttempts</code></td>\n    <td>Number of attempts to connect to the database (default: <code>10</code>)</td>\n  </tr>\n  <tr>\n    <td><code>retryDelay</code></td>\n    <td>Delay between connection retry attempts (ms) (default: <code>3000</code>)</td>\n  </tr>\n  <tr>\n    <td><code>autoLoadEntities</code></td>\n    <td>If <code>true</code>, entities will be loaded automatically (default: <code>false</code>)</td>\n  </tr>\n  <tr>\n    <td><code>keepConnectionAlive</code></td>\n    <td>If <code>true</code>, connection will not be closed on application shutdown (default: <code>false</code>)</td>\n  </tr>\n</table>\n\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Learn more about the connection options <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/connection-options\">here</a>.\n</blockquote>\n<p>Alternatively, rather than passing a configuration object to <code>forRoot()</code>, we can create an <code>ormconfig.json</code> file in the project root directory.</p>\n<pre><code class=\"language-json\">\n&#123;\n  &quot;type&quot;: &quot;mysql&quot;,\n  &quot;host&quot;: &quot;localhost&quot;,\n  &quot;port&quot;: 3306,\n  &quot;username&quot;: &quot;root&quot;,\n  &quot;password&quot;: &quot;root&quot;,\n  &quot;database&quot;: &quot;test&quot;,\n  &quot;entities&quot;: [&quot;dist/**/*.entity&#123;.ts,.js&#125;&quot;],\n  &quot;synchronize&quot;: true\n&#125;</code></pre>\n<p>Then, we can call <code>forRoot()</code> without any options:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app1f64e2ca5df0618b13330f6700ad2acc7f10a48c.isJsActive }}\n<app-tabs #app1f64e2ca5df0618b13330f6700ad2acc7f10a48c></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; TypeOrmModule &#125; from &#39;@nestjs/typeorm&#39;;\n\n@Module(&#123;\n  imports: [TypeOrmModule.forRoot()],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Warning</strong> Static glob paths (e.g., <code>dist/**/*.entity{{ &#39;{&#39; }} .ts,.js{{ &#39;}&#39; }}</code>) won&#39;t work properly with <a rel='nofollow' target='_blank' href=\"https://webpack.js.org/\">webpack</a>.\n</blockquote>\n<blockquote class=\"\nwarning \"><strong>Warning</strong> Note that the <code>ormconfig.json</code> file is loaded by the <code>typeorm</code> library. Thus, any of the extra properties described above (which are supported internally by way of the <code>forRoot()</code> method - for example, <code>autoLoadEntities</code> and <code>retryDelay</code>) won&#39;t be applied.\n</blockquote>\n<p>Once this is done, the TypeORM <code>Connection</code> and <code>EntityManager</code> objects will be available to inject across the entire project (without needing to import any modules), for example:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app2f9633e5093cb01ce1e717e67e526ccd6544272b.isJsActive }}\n<app-tabs #app2f9633e5093cb01ce1e717e67e526ccd6544272b></app-tabs>\n</span><pre [class.hide]=\"app2f9633e5093cb01ce1e717e67e526ccd6544272b.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Connection &#125; from &#39;typeorm&#39;;\n\n@Module(&#123;\n  imports: [TypeOrmModule.forRoot(), UsersModule],\n&#125;)\nexport class AppModule &#123;\n  constructor(private readonly connection: Connection) &#123;&#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app2f9633e5093cb01ce1e717e67e526ccd6544272b.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Connection &#125; from &#39;typeorm&#39;;\n\n@Dependencies(Connection)\n@Module(&#123;\n  imports: [TypeOrmModule.forRoot(), UsersModule],\n&#125;)\nexport class AppModule &#123;\n  constructor(connection) &#123;\n    this.connection = connection;\n  &#125;\n&#125;</code></pre><h4 appAnchor id=\"repository-pattern\"><span>Repository pattern</span></h4>\n<p><a rel='nofollow' target='_blank' href=\"https://github.com/typeorm/typeorm\">TypeORM</a> supports the <strong>repository design pattern</strong>, so each entity has its own repository. These repositories can be obtained from the database connection.</p>\n<p>To continue the example, we need at least one entity. Let&#39;s define the <code>User</code> entity.</p>\n\n<span class=\"filename\">\n  {{ 'user.entity' | extension: app1f89ed59d957f72a0bbe5356db34d892e431e56a.isJsActive }}\n<app-tabs #app1f89ed59d957f72a0bbe5356db34d892e431e56a></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Entity, Column, PrimaryGeneratedColumn &#125; from &#39;typeorm&#39;;\n\n@Entity()\nexport class User &#123;\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  firstName: string;\n\n  @Column()\n  lastName: string;\n\n  @Column(&#123; default: true &#125;)\n  isActive: boolean;\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> Learn more about entities in the <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/entities\">TypeORM documentation</a>.\n</blockquote>\n<p>The <code>User</code> entity file sits in the <code>users</code> directory. This directory contains all files related to the <code>UsersModule</code>. You can decide where to keep your model files, however, we recommend creating them near their <strong>domain</strong>, in the corresponding module directory.</p>\n<p>To begin using the <code>User</code> entity, we need to let TypeORM know about it by inserting it into the <code>entities</code> array in the module <code>forRoot()</code> method options (unless you use a static glob path):</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: appb65f9c1e3b3eba5c553d6e2069d6059ac31e9ac4.isJsActive }}\n<app-tabs #appb65f9c1e3b3eba5c553d6e2069d6059ac31e9ac4></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; TypeOrmModule &#125; from &#39;@nestjs/typeorm&#39;;\nimport &#123; User &#125; from &#39;./users/user.entity&#39;;\n\n@Module(&#123;\n  imports: [\n    TypeOrmModule.forRoot(&#123;\n      type: &#39;mysql&#39;,\n      host: &#39;localhost&#39;,\n      port: 3306,\n      username: &#39;root&#39;,\n      password: &#39;root&#39;,\n      database: &#39;test&#39;,\n      entities: [User],\n      synchronize: true,\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>Next, let&#39;s look at the <code>UsersModule</code>:</p>\n\n<span class=\"filename\">\n  {{ 'users.module' | extension: appe623713924eef984fcd1767980a4dc38575526b0.isJsActive }}\n<app-tabs #appe623713924eef984fcd1767980a4dc38575526b0></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; TypeOrmModule &#125; from &#39;@nestjs/typeorm&#39;;\nimport &#123; UsersService &#125; from &#39;./users.service&#39;;\nimport &#123; UsersController &#125; from &#39;./users.controller&#39;;\nimport &#123; User &#125; from &#39;./user.entity&#39;;\n\n@Module(&#123;\n  imports: [TypeOrmModule.forFeature([User])],\n  providers: [UsersService],\n  controllers: [UsersController],\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre><p>This module uses the <code>forFeature()</code> method to define which repositories are registered in the current scope. With that in place, we can inject the <code>UsersRepository</code> into the <code>UsersService</code> using the <code>@InjectRepository()</code> decorator:</p>\n\n<span class=\"filename\">\n  {{ 'users.service' | extension: appafd0491566415e56dcbd762ab047d7a4e3adc520.isJsActive }}\n<app-tabs #appafd0491566415e56dcbd762ab047d7a4e3adc520></app-tabs>\n</span><pre [class.hide]=\"appafd0491566415e56dcbd762ab047d7a4e3adc520.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; InjectRepository &#125; from &#39;@nestjs/typeorm&#39;;\nimport &#123; Repository &#125; from &#39;typeorm&#39;;\nimport &#123; User &#125; from &#39;./user.entity&#39;;\n\n@Injectable()\nexport class UsersService &#123;\n  constructor(\n    @InjectRepository(User)\n    private readonly usersRepository: Repository&lt;User&gt;,\n  ) &#123;&#125;\n\n  findAll(): Promise&lt;User[]&gt; &#123;\n    return this.usersRepository.find();\n  &#125;\n\n  findOne(id: string): Promise&lt;User&gt; &#123;\n    return this.usersRepository.findOne(id);\n  &#125;\n\n  async remove(id: string): Promise&lt;void&gt; &#123;\n    await this.usersRepository.delete(id);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appafd0491566415e56dcbd762ab047d7a4e3adc520.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable, Dependencies &#125; from &#39;@nestjs/common&#39;;\nimport &#123; getRepositoryToken &#125; from &#39;@nestjs/typeorm&#39;;\nimport &#123; User &#125; from &#39;./user.entity&#39;;\n\n@Injectable()\n@Dependencies(getRepositoryToken(User))\nexport class UserService &#123;\n  constructor(usersRepository) &#123;\n    this.usersRepository = usersRepository;\n  &#125;\n\n  findAll() &#123;\n    return this.usersRepository.find();\n  &#125;\n\n  findOne(id) &#123;\n    return this.usersRepository.findOne(id);\n  &#125;\n\n  async remove(id) &#123;\n    await this.usersRepository.delete(id);\n  &#125;\n&#125;</code></pre><blockquote class=\"\nwarning \"><strong>Notice</strong> Don&#39;t forget to import the <code>UsersModule</code> into the root <code>AppModule</code>.\n</blockquote>\n<p>If you want to use the repository outside of the module which imports <code>TypeOrmModule.forFeature</code>, you&#39;ll need to re-export the providers generated by it.\nYou can do this by exporting the whole module, like this:</p>\n\n<span class=\"filename\">\n  {{ 'users.module' | extension: app1f0a9c939d72d2a4a6e33f134ceccfcfead626de.isJsActive }}\n<app-tabs #app1f0a9c939d72d2a4a6e33f134ceccfcfead626de></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; TypeOrmModule &#125; from &#39;@nestjs/typeorm&#39;;\nimport &#123; User &#125; from &#39;./user.entity&#39;;\n\n@Module(&#123;\n  imports: [TypeOrmModule.forFeature([User])],\n  exports: [TypeOrmModule]\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre><p>Now if we import <code>UsersModule</code> in <code>UserHttpModule</code>, we can use <code>@InjectRepository(User)</code> in the providers of the latter module.</p>\n\n<span class=\"filename\">\n  {{ 'users-http.module' | extension: app40759e845a6fd5d24cd1a5808902643c078f657a.isJsActive }}\n<app-tabs #app40759e845a6fd5d24cd1a5808902643c078f657a></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; UsersModule &#125; from &#39;./user.module&#39;;\nimport &#123; UserService &#125; from &#39;./user.service&#39;;\nimport &#123; UserController &#125; from &#39;./user.controller&#39;;\n\n@Module(&#123;\n  imports: [UsersModule],\n  providers: [UserService],\n  controllers: [UserController]\n&#125;)\nexport class UserHttpModule &#123;&#125;</code></pre><h3 id=\"relations\">Relations</h3>\n<p>Relations are associations established between two or more tables. Relations are based on common fields from each table, often involving primary and foreign keys.</p>\n<p>There are three types of relations:</p>\n<table>\n  <tr>\n    <td><code>One-to-one</code></td>\n    <td>Every row in the primary table has one and only one associated row in the foreign table.  Use the <code>@OneToOne()</code> decorator to define this type of relation.</td>\n  </tr>\n  <tr>\n    <td><code>One-to-many / Many-to-one</code></td>\n    <td>Every row in the primary table has one or more related rows in the foreign table. Use the <code>@OneToMany()</code> and <code>@ManyToOne()</code> decorators to define this type of relation.</td>\n  </tr>\n  <tr>\n    <td><code>Many-to-many</code></td>\n    <td>Every row in the primary table has many related rows in the foreign table, and every record in the foreign table has many related rows in the primary table. Use the <code>@ManyToMany()</code> decorator to define this type of relation.</td>\n  </tr>\n</table>\n\n<p>To define relations in entities, use the corresponding <strong>decorators</strong>. For example, to define that each <code>User</code> can have multiple photos, use the <code>@OneToMany()</code> decorator.</p>\n\n<span class=\"filename\">\n  {{ 'user.entity' | extension: app8e40b230b999c27951d1df7ecfe70f2964526f0e.isJsActive }}\n<app-tabs #app8e40b230b999c27951d1df7ecfe70f2964526f0e></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Entity, Column, PrimaryGeneratedColumn, OneToMany &#125; from &#39;typeorm&#39;;\nimport &#123; Photo &#125; from &#39;../photos/photo.entity&#39;;\n\n@Entity()\nexport class User &#123;\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  firstName: string;\n\n  @Column()\n  lastName: string;\n\n  @Column(&#123; default: true &#125;)\n  isActive: boolean;\n\n  @OneToMany(type =&gt; Photo, photo =&gt; photo.user)\n  photos: Photo[];\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> To learn more about relations in TypeORM, visit the <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/relations\">TypeORM documentation</a>.\n</blockquote>\n<h4 appAnchor id=\"auto-load-entities\"><span>Auto-load entities</span></h4>\n<p>Manually adding entities to the <code>entities</code> array of the connection options can be tedious. In addition, referencing entities from the root module breaks application domain boundaries and causes leaking implementation details to other parts of the application. To solve this issue, static glob paths can be used (e.g., <code>dist/**/*.entity{{ &#39;{&#39; }} .ts,.js{{ &#39;}&#39; }}</code>).</p>\n<p>Note, however, that glob paths are not supported by webpack, so if you are building your application within a monorepo, you won&#39;t be able to use them. To address this issue, an alternative solution is provided. To automatically load entities, set the <code>autoLoadEntities</code> property of the configuration object (passed into the <code>forRoot()</code> method) to <code>true</code>, as shown below:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: appdc7da72bffdd85a856a8f329c5560984befbf44b.isJsActive }}\n<app-tabs #appdc7da72bffdd85a856a8f329c5560984befbf44b></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; TypeOrmModule &#125; from &#39;@nestjs/typeorm&#39;;\n\n@Module(&#123;\n  imports: [\n    TypeOrmModule.forRoot(&#123;\n      ...\n      autoLoadEntities: true,\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>With that option specified, every entity registered through the <code>forFeature()</code> method will be automatically added to the <code>entities</code> array of the configuration object.</p>\n<blockquote class=\"\nwarning \"><strong>Warning</strong> Note that entities that aren&#39;t registered through the <code>forFeature()</code> method, but are only referenced from the entity (via a relationship), won&#39;t be included by way of the <code>autoLoadEntities</code> setting.\n</blockquote>\n<h4 appAnchor id=\"transactions\"><span>Transactions</span></h4>\n<p>A database transaction symbolizes a unit of work performed within a database management system against a database, and treated in a coherent and reliable way independent of other transactions. A transaction generally represents any change in a database (<a rel='nofollow' target='_blank' href=\"https://en.wikipedia.org/wiki/Database_transaction\">learn more</a>).</p>\n<p>There are many different strategies to handle <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/transactions\">TypeORM transactions</a>. We recommend using the <code>QueryRunner</code> class because it gives full control over the transaction.</p>\n<p>First, we need to inject the <code>Connection</code> object into a class in the normal way:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nexport class UsersService &#123;\n  constructor(private readonly connection: Connection) &#123;&#125;\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>Connection</code> class is imported from the <code>typeorm</code> package.\n</blockquote>\n<p>Now, we can use this object to create a transaction.</p>\n<pre><code class=\"language-typescript\">\nasync createMany(users: User[]) &#123;\n  const queryRunner = this.connection.createQueryRunner();\n\n  await queryRunner.connect();\n  await queryRunner.startTransaction();\n  try &#123;\n    await queryRunner.manager.save(users[0]);\n    await queryRunner.manager.save(users[1]);\n\n    await queryRunner.commitTransaction();\n  &#125; catch (err) &#123;\n    // since we have errors lets rollback the changes we made\n    await queryRunner.rollbackTransaction();\n  &#125; finally &#123;\n    // you need to release a queryRunner which was manually instantiated\n    await queryRunner.release();\n  &#125;\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Note that the <code>connection</code> is used only to create the <code>QueryRunner</code>. However, to test this class would require mocking the entire <code>Connection</code> object (which exposes several methods). Thus, we recommend using a helper factory class (e.g., <code>QueryRunnerFactory</code>) and defining an interface with a limited set of methods required to maintain transactions. This technique makes mocking these methods pretty straightforward.\n</blockquote>\n<p>Alternatively, you can use the callback-style approach with the <code>transaction</code> method of the <code>Connection</code> object (<a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/transactions/creating-and-using-transactions\">read more</a>).</p>\n<pre><code class=\"language-typescript\">\nasync createMany(users: User[]) &#123;\n  await this.connection.transaction(async manager =&gt; &#123;\n    await manager.save(users[0]);\n    await manager.save(users[1]);\n  &#125;);\n&#125;</code></pre>\n<p>Using decorators to control the transaction (<code>@Transaction()</code> and <code>@TransactionManager()</code>) is not recommended.</p>\n<p><app-banner-shop></app-banner-shop></p>\n<h4 appAnchor id=\"subscribers\"><span>Subscribers</span></h4>\n<p>With TypeORM <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/listeners-and-subscribers/what-is-a-subscriber\">subscribers</a>, you can listen to specific entity events.</p>\n<pre><code class=\"language-typescript\">\nimport &#123;\n  Connection,\n  EntitySubscriberInterface,\n  EventSubscriber,\n  InsertEvent,\n&#125; from &#39;typeorm&#39;;\nimport &#123; User &#125; from &#39;./user.entity&#39;;\n\n@EventSubscriber()\nexport class UserSubscriber implements EntitySubscriberInterface&lt;User&gt; &#123;\n  constructor(connection: Connection) &#123;\n    connection.subscribers.push(this);\n  &#125;\n\n  listenTo() &#123;\n    return User;\n  &#125;\n\n  beforeInsert(event: InsertEvent&lt;User&gt;) &#123;\n    console.log(`BEFORE USER INSERTED: `, event.entity);\n  &#125;\n&#125;</code></pre>\n<blockquote class=\"\nerror \"><strong>Warning</strong> Event subscribers can not be <a routerLink=\"/fundamentals/injection-scopes\">request-scoped</a>.\n</blockquote>\n<p>Now, add the <code>UserSubscriber</code> class to the <code>providers</code> array:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; TypeOrmModule &#125; from &#39;@nestjs/typeorm&#39;;\nimport &#123; User &#125; from &#39;./user.entity&#39;;\nimport &#123; UsersController &#125; from &#39;./users.controller&#39;;\nimport &#123; UsersService &#125; from &#39;./users.service&#39;;\nimport &#123; UserSubscriber &#125; from &#39;./user.subscriber&#39;;\n\n@Module(&#123;\n  imports: [TypeOrmModule.forFeature([User])],\n  providers: [UsersService, UserSubscriber],\n  controllers: [UsersController],\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Learn more about entity subscribers <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/listeners-and-subscribers/what-is-a-subscriber\">here</a>.\n</blockquote>\n<h4 appAnchor id=\"migrations\"><span>Migrations</span></h4>\n<p><a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/migrations\">Migrations</a> provide a way to incrementally update the database schema to keep it in sync with the application&#39;s data model while preserving existing data in the database. To generate, run, and revert migrations, TypeORM provides a dedicated <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/migrations/creating-a-new-migration\">CLI</a>.</p>\n<p>Migration classes are separate from the Nest application source code. Their lifecycle is maintained by the TypeORM CLI. Therefore, you are not able to leverage dependency injection and other Nest specific features with migrations. To learn more about migrations, follow the guide in the <a rel='nofollow' target='_blank' href=\"https://typeorm.io/#/migrations/creating-a-new-migration\">TypeORM documentation</a>.</p>\n<h4 appAnchor id=\"multiple-databases\"><span>Multiple databases</span></h4>\n<p>Some projects require multiple database connections. This can also be achieved with this module. To work with multiple connections, first create the connections. In this case, connection naming becomes <strong>mandatory</strong>.</p>\n<p>Suppose you have an <code>Album</code> entity stored in its own database.</p>\n<pre><code class=\"language-typescript\">\nconst defaultOptions = &#123;\n  type: &#39;postgres&#39;,\n  port: 5432,\n  username: &#39;user&#39;,\n  password: &#39;password&#39;,\n  database: &#39;db&#39;,\n  synchronize: true,\n&#125;;\n\n@Module(&#123;\n  imports: [\n    TypeOrmModule.forRoot(&#123;\n      ...defaultOptions,\n      host: &#39;user_db_host&#39;,\n      entities: [User],\n    &#125;),\n    TypeOrmModule.forRoot(&#123;\n      ...defaultOptions,\n      name: &#39;albumsConnection&#39;,\n      host: &#39;album_db_host&#39;,\n      entities: [Album],\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<blockquote class=\"\nwarning \"><strong>Notice</strong> If you don&#39;t set the <code>name</code> for a connection, its name is set to <code>default</code>. Please note that you shouldn&#39;t have multiple connections without a name, or with the same name, otherwise they will get overridden.\n</blockquote>\n<p>At this point, you have <code>User</code> and <code>Album</code> entities registered with their own connection. With this setup, you have to tell the <code>TypeOrmModule.forFeature()</code> method and the <code>@InjectRepository()</code> decorator which connection should be used. If you do not pass any connection name, the <code>default</code> connection is used.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    TypeOrmModule.forFeature([User]),\n    TypeOrmModule.forFeature([Album], &#39;albumsConnection&#39;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<p>You can also inject the <code>Connection</code> or <code>EntityManager</code> for a given connection:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nexport class AlbumsService &#123;\n  constructor(\n    @InjectConnection(&#39;albumsConnection&#39;)\n    private readonly connection: Connection,\n    @InjectEntityManager(&#39;albumsConnection&#39;)\n    private readonly entityManager: EntityManager,\n  ) &#123;&#125;\n&#125;</code></pre>\n<h4 appAnchor id=\"testing\"><span>Testing</span></h4>\n<p>When it comes to unit testing an application, we usually want to avoid making a database connection, keeping our test suites independent and their execution process as fast as possible. But our classes might depend on repositories that are pulled from the connection instance. How do we handle that? The solution is to create mock repositories. In order to achieve that, we set up <a routerLink=\"/fundamentals/custom-providers\">custom providers</a>. Each registered repository is automatically represented by an <code>&lt;EntityName&gt;Repository</code> token, where <code>EntityName</code> is the name of your entity class.</p>\n<p>The <code>@nestjs/typeorm</code> package exposes the <code>getRepositoryToken()</code> function which returns a prepared token based on a given entity.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  providers: [\n    UserService,\n    &#123;\n      provide: getRepositoryToken(User),\n      useValue: mockRepository,\n    &#125;,\n  ],\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre>\n<p>Now a substitute <code>mockRepository</code> will be used as the <code>UserRepository</code>. Whenever any class asks for <code>UserRepository</code> using an <code>@InjectRepository()</code> decorator, Nest will use the registered <code>mockRepository</code> object.</p>\n<h4 appAnchor id=\"custom-repository\"><span>Custom repository</span></h4>\n<p>TypeORM provides a feature called <strong>custom repositories</strong>. Custom repositories allow you to extend a base repository class, and enrich it with several special methods. To learn more about this feature, visit <a rel='nofollow' target='_blank' href=\"http://typeorm.io/#/custom-repository\">this page</a>.</p>\n<p>In order to create your custom repository, use the <code>@EntityRepository()</code> decorator and extend the <code>Repository</code> class.</p>\n<pre><code class=\"language-typescript\">\n@EntityRepository(Author)\nexport class AuthorRepository extends Repository&lt;Author&gt; &#123;&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Both <code>@EntityRepository()</code> and <code>Repository</code> are imported from the <code>typeorm</code> package.\n</blockquote>\n<p>Once the class is created, the next step is to delegate instantiation responsibility to Nest. For this, we have to pass the<code>AuthorRepository</code> class to the <code>TypeOrm.forFeature()</code> method.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [TypeOrmModule.forFeature([AuthorRepository])],\n  controller: [AuthorController],\n  providers: [AuthorService],\n&#125;)\nexport class AuthorModule &#123;&#125;</code></pre>\n<p>Afterward, simply inject the repository using the following construction:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nexport class AuthorService &#123;\n  constructor(private readonly authorRepository: AuthorRepository) &#123;&#125;\n&#125;</code></pre>\n<h4 appAnchor id=\"async-configuration\"><span>Async configuration</span></h4>\n<p>You may want to pass your repository module options asynchronously instead of statically. In this case, use the <code>forRootAsync()</code> method, which provides several ways to deal with async configuration.</p>\n<p>One approach is to use a factory function:</p>\n<pre><code class=\"language-typescript\">\nTypeOrmModule.forRootAsync(&#123;\n  useFactory: () =&gt; (&#123;\n    type: &#39;mysql&#39;,\n    host: &#39;localhost&#39;,\n    port: 3306,\n    username: &#39;root&#39;,\n    password: &#39;root&#39;,\n    database: &#39;test&#39;,\n    entities: [__dirname + &#39;/**/*.entity&#123;.ts,.js&#125;&#39;],\n    synchronize: true,\n  &#125;),\n&#125;);</code></pre>\n<p>Our factory behaves like any other <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/async-providers\">asynchronous provider</a> (e.g., it can be <code>async</code> and it&#39;s able to inject dependencies through <code>inject</code>).</p>\n<pre><code class=\"language-typescript\">\nTypeOrmModule.forRootAsync(&#123;\n  imports: [ConfigModule],\n  useFactory: (configService: ConfigService) =&gt; (&#123;\n    type: &#39;mysql&#39;,\n    host: configService.get&lt;string&gt;(&#39;HOST&#39;),\n    port: configService.get&lt;string&gt;(&#39;PORT&#39;),\n    username: configService.get&lt;string&gt;(&#39;USERNAME&#39;),\n    password: configService.get&lt;string&gt;(&#39;PASSWORD&#39;),\n    database: configService.get&lt;string&gt;(&#39;DATABASE&#39;),\n    entities: [__dirname + &#39;/**/*.entity&#123;.ts,.js&#125;&#39;],\n    synchronize: true,\n  &#125;),\n  inject: [ConfigService],\n&#125;);</code></pre>\n<p>Alternatively, you can use the <code>useClass</code> syntax:</p>\n<pre><code class=\"language-typescript\">\nTypeOrmModule.forRootAsync(&#123;\n  useClass: TypeOrmConfigService,\n&#125;);</code></pre>\n<p>The construction above will instantiate <code>TypeOrmConfigService</code> inside <code>TypeOrmModule</code> and use it to provide an options object by calling <code>createTypeOrmOptions()</code>. Note that this means that the <code>TypeOrmConfigService</code> has to implement the <code>TypeOrmOptionsFactory</code> interface, as shown below:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nclass TypeOrmConfigService implements TypeOrmOptionsFactory &#123;\n  createTypeOrmOptions(): TypeOrmModuleOptions &#123;\n    return &#123;\n      type: &#39;mysql&#39;,\n      host: &#39;localhost&#39;,\n      port: 3306,\n      username: &#39;root&#39;,\n      password: &#39;root&#39;,\n      database: &#39;test&#39;,\n      entities: [__dirname + &#39;/**/*.entity&#123;.ts,.js&#125;&#39;],\n      synchronize: true,\n    &#125;;\n  &#125;\n&#125;</code></pre>\n<p>In order to prevent the creation of <code>TypeOrmConfigService</code> inside <code>TypeOrmModule</code> and use a provider imported from a different module, you can use the <code>useExisting</code> syntax.</p>\n<pre><code class=\"language-typescript\">\nTypeOrmModule.forRootAsync(&#123;\n  imports: [ConfigModule],\n  useExisting: ConfigService,\n&#125;);</code></pre>\n<p>This construction works the same as <code>useClass</code> with one critical difference - <code>TypeOrmModule</code> will lookup imported modules to reuse an existing <code>ConfigService</code> instead of instantiating a new one.</p>\n<h4 appAnchor id=\"example\"><span>Example</span></h4>\n<p>A working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/05-sql-typeorm\">here</a>.</p>\n<p><app-banner-enterprise></app-banner-enterprise></p>\n<h3 id=\"sequelize-integration\">Sequelize Integration</h3>\n<p>An alternative to using TypeORM is to use the <a rel='nofollow' target='_blank' href=\"https://sequelize.org/\">Sequelize</a> ORM with the <code>@nestjs/sequelize</code> package. In addition, we leverage the <a rel='nofollow' target='_blank' href=\"https://github.com/RobinBuschmann/sequelize-typescript\">sequelize-typescript</a> package which provides a set of additional decorators to declaratively define entities.</p>\n<p>To begin using it, we first install the required dependencies. In this chapter, we&#39;ll demonstrate using the popular <a rel='nofollow' target='_blank' href=\"https://www.mysql.com/\">MySQL</a> Relational DBMS, but Sequelize provides support for many relational databases, such as PostgreSQL, MySQL, Microsoft SQL Server, SQLite, and MariaDB. The procedure we walk through in this chapter will be the same for any database supported by Sequelize. You&#39;ll simply need to install the associated client API libraries for your selected database.</p>\n<pre><code class=\"language-bash\">\n$ npm install --save @nestjs/sequelize sequelize sequelize-typescript mysql2\n$ npm install --save-dev @types/sequelize</code></pre>\n<p>Once the installation process is complete, we can import the <code>SequelizeModule</code> into the root <code>AppModule</code>.</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app6f37f54ed907a23901cec0731f5d707405d077ca.isJsActive }}\n<app-tabs #app6f37f54ed907a23901cec0731f5d707405d077ca></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; SequelizeModule &#125; from &#39;@nestjs/sequelize&#39;;\n\n@Module(&#123;\n  imports: [\n    SequelizeModule.forRoot(&#123;\n      dialect: &#39;mysql&#39;,\n      host: &#39;localhost&#39;,\n      port: 3306,\n      username: &#39;root&#39;,\n      password: &#39;root&#39;,\n      database: &#39;test&#39;,\n      models: [],\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>The <code>forRoot()</code> method supports all the configuration properties exposed by the Sequelize constuctor (<a rel='nofollow' target='_blank' href=\"https://sequelize.org/v5/manual/getting-started.html#setting-up-a-connection\">read more</a>). In addition, there are several extra configuration properties described below.</p>\n<table>\n  <tr>\n    <td><code>retryAttempts</code></td>\n    <td>Number of attempts to connect to the database (default: <code>10</code>)</td>\n  </tr>\n  <tr>\n    <td><code>retryDelay</code></td>\n    <td>Delay between connection retry attempts (ms) (default: <code>3000</code>)</td>\n  </tr>\n  <tr>\n    <td><code>autoLoadModels</code></td>\n    <td>If <code>true</code>, models will be loaded automatically (default: <code>false</code>)</td>\n  </tr>\n  <tr>\n    <td><code>keepConnectionAlive</code></td>\n    <td>If <code>true</code>, connection will not be closed on the application shutdown (default: <code>false</code>)</td>\n  </tr>\n  <tr>\n    <td><code>synchronize</code></td>\n    <td>If <code>true</code>, automatically loaded models will be synchronized (default: <code>false</code>)</td>\n  </tr>\n</table>\n\n<p>Once this is done, the <code>Sequelize</code> object will be available to inject across the entire project (without needing to import any modules), for example:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app0ae8f009583dbe0d02441ac80a663129fcdfd9b8.isJsActive }}\n<app-tabs #app0ae8f009583dbe0d02441ac80a663129fcdfd9b8></app-tabs>\n</span><pre [class.hide]=\"app0ae8f009583dbe0d02441ac80a663129fcdfd9b8.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; Sequelize &#125; from &#39;sequelize-typescript&#39;;\n\n@Injectable()\nexport class AppService &#123;\n  constructor(private readonly sequelize: Sequelize) &#123;&#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app0ae8f009583dbe0d02441ac80a663129fcdfd9b8.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; Sequelize &#125; from &#39;sequelize-typescript&#39;;\n\n@Dependencies(Sequelize)\n@Injectable()\nexport class AppService &#123;\n  constructor(sequelize) &#123;\n    this.sequelize = sequelize;\n  &#125;\n&#125;</code></pre><h4 appAnchor id=\"models\"><span>Models</span></h4>\n<p>Sequelize implements the Active Record pattern. With this pattern, you use model classes directly to interact with the database. To continue the example, we need at least one model. Let&#39;s define the <code>User</code> model.</p>\n\n<span class=\"filename\">\n  {{ 'user.model' | extension: appdccee095844235621b8c50f1178f1a657e2e7220.isJsActive }}\n<app-tabs #appdccee095844235621b8c50f1178f1a657e2e7220></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Column, Model, Table &#125; from &#39;sequelize-typescript&#39;;\n\n@Table\nexport class User extends Model&lt;User&gt; &#123;\n  @Column\n  firstName: string;\n\n  @Column\n  lastName: string;\n\n  @Column(&#123; defaultValue: true &#125;)\n  isActive: boolean;\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> Learn more about the available decorators <a rel='nofollow' target='_blank' href=\"https://github.com/RobinBuschmann/sequelize-typescript#column\">here</a>.\n</blockquote>\n<p>The <code>User</code> model file sits in the <code>users</code> directory. This directory contains all files related to the <code>UsersModule</code>. You can decide where to keep your model files, however, we recommend creating them near their <strong>domain</strong>, in the corresponding module directory.</p>\n<p>To begin using the <code>User</code> model, we need to let Sequelize know about it by inserting it into the <code>models</code> array in the module <code>forRoot()</code> method options:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app07a3cf98c04f98ed82fe762d40ba914a9e3e4b87.isJsActive }}\n<app-tabs #app07a3cf98c04f98ed82fe762d40ba914a9e3e4b87></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; SequelizeModule &#125; from &#39;@nestjs/sequelize&#39;;\nimport &#123; User &#125; from &#39;./users/user.model&#39;;\n\n@Module(&#123;\n  imports: [\n    SequelizeModule.forRoot(&#123;\n      dialect: &#39;mysql&#39;,\n      host: &#39;localhost&#39;,\n      port: 3306,\n      username: &#39;root&#39;,\n      password: &#39;root&#39;,\n      database: &#39;test&#39;,\n      models: [User],\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>Next, let&#39;s look at the <code>UsersModule</code>:</p>\n\n<span class=\"filename\">\n  {{ 'users.module' | extension: app79467c6485e15cc343a0d1d0a268b945bf3a53c0.isJsActive }}\n<app-tabs #app79467c6485e15cc343a0d1d0a268b945bf3a53c0></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; SequelizeModule &#125; from &#39;@nestjs/sequelize&#39;;\nimport &#123; User &#125; from &#39;./user.model&#39;;\nimport &#123; UsersController &#125; from &#39;./users.controller&#39;;\nimport &#123; UsersService &#125; from &#39;./users.service&#39;;\n\n@Module(&#123;\n  imports: [SequelizeModule.forFeature([User])],\n  providers: [UsersService],\n  controllers: [UsersController],\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre><p>This module uses the <code>forFeature()</code> method to define which models are registered in the current scope. With that in place, we can inject the <code>UserModel</code> into the <code>UsersService</code> using the <code>@InjectModel()</code> decorator:</p>\n\n<span class=\"filename\">\n  {{ 'users.service' | extension: app4a764583d16a962d0e267c9cbd64466717f86cc9.isJsActive }}\n<app-tabs #app4a764583d16a962d0e267c9cbd64466717f86cc9></app-tabs>\n</span><pre [class.hide]=\"app4a764583d16a962d0e267c9cbd64466717f86cc9.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable &#125; from &#39;@nestjs/common&#39;;\nimport &#123; InjectModel &#125; from &#39;@nestjs/sequelize&#39;;\nimport &#123; User &#125; from &#39;./user.model&#39;;\n\n@Injectable()\nexport class UsersService &#123;\n  constructor(\n    @InjectModel(User)\n    private readonly userModel: typeof User,\n  ) &#123;&#125;\n\n  async findAll(): Promise&lt;User[]&gt; &#123;\n    return this.userModel.findAll();\n  &#125;\n\n  findOne(id: string): Promise&lt;User&gt; &#123;\n    return this.userModel.findOne(&#123;\n      where: &#123;\n        id,\n      &#125;,\n    &#125;);\n  &#125;\n\n  async remove(id: string): Promise&lt;void&gt; &#123;\n    const user = await this.findOne(id);\n    await user.destroy();\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app4a764583d16a962d0e267c9cbd64466717f86cc9.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Injectable, Dependencies &#125; from &#39;@nestjs/common&#39;;\nimport &#123; getModelToken &#125; from &#39;@nestjs/sequelize&#39;;\nimport &#123; User &#125; from &#39;./user.model&#39;;\n\n@Injectable()\n@Dependencies(getModelToken(User))\nexport class UserService &#123;\n  constructor(usersRepository) &#123;\n    this.usersRepository = usersRepository;\n  &#125;\n\n  async findAll() &#123;\n    return this.userModel.findAll();\n  &#125;\n\n  findOne(id) &#123;\n    return this.userModel.findOne(&#123;\n      where: &#123;\n        id,\n      &#125;,\n    &#125;);\n  &#125;\n\n  async remove(id) &#123;\n    const user = await this.findOne(id);\n    await user.destroy();\n  &#125;\n&#125;</code></pre><blockquote class=\"\nwarning \"><strong>Notice</strong> Don&#39;t forget to import the <code>UsersModule</code> into the root <code>AppModule</code>.\n</blockquote>\n<p>If you want to use the repository outside of the module which imports <code>SequelizeModule.forFeature</code>, you&#39;ll need to re-export the providers generated by it.\nYou can do this by exporting the whole module, like this:</p>\n\n<span class=\"filename\">\n  {{ 'users.module' | extension: appf2562015ff5aace455ff2d101065ec7289ca780d.isJsActive }}\n<app-tabs #appf2562015ff5aace455ff2d101065ec7289ca780d></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; SequelizeModule &#125; from &#39;@nestjs/sequelize&#39;;\nimport &#123; User &#125; from &#39;./user.entity&#39;;\n\n@Module(&#123;\n  imports: [SequelizeModule.forFeature([User])],\n  exports: [SequelizeModule]\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre><p>Now if we import <code>UsersModule</code> in <code>UserHttpModule</code>, we can use <code>@InjectModel(User)</code> in the providers of the latter module.</p>\n\n<span class=\"filename\">\n  {{ 'users-http.module' | extension: appb2ac11240bf46e0aa41ad62798ae16f973c42b6d.isJsActive }}\n<app-tabs #appb2ac11240bf46e0aa41ad62798ae16f973c42b6d></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; UsersModule &#125; from &#39;./user.module&#39;;\nimport &#123; UserService &#125; from &#39;./user.service&#39;;\nimport &#123; UserController &#125; from &#39;./user.controller&#39;;\n\n@Module(&#123;\n  imports: [UsersModule],\n  providers: [UserService],\n  controllers: [UserController]\n&#125;)\nexport class UserHttpModule &#123;&#125;</code></pre><h3 id=\"relations-1\">Relations</h3>\n<p>Relations are associations established between two or more tables. Relations are based on common fields from each table, often involving primary and foreign keys.</p>\n<p>There are three types of relations:</p>\n<table>\n  <tr>\n    <td><code>One-to-one</code></td>\n    <td>Every row in the primary table has one and only one associated row in the foreign table</td>\n  </tr>\n  <tr>\n    <td><code>One-to-many / Many-to-one</code></td>\n    <td>Every row in the primary table has one or more related rows in the foreign table</td>\n  </tr>\n  <tr>\n    <td><code>Many-to-many</code></td>\n    <td>Every row in the primary table has many related rows in the foreign table, and every record in the foreign table has many related rows in the primary table</td>\n  </tr>\n</table>\n\n<p>To define relations in entities, use the corresponding <strong>decorators</strong>. For example, to define that each <code>User</code> can have multiple photos, use the <code>@HasMany()</code> decorator.</p>\n\n<span class=\"filename\">\n  {{ 'user.entity' | extension: app08825ee69f1f1fa9e79a9af222373d6ab9df78aa.isJsActive }}\n<app-tabs #app08825ee69f1f1fa9e79a9af222373d6ab9df78aa></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Column, Model, Table, HasMany &#125; from &#39;sequelize-typescript&#39;;\nimport &#123; Photo &#125; from &#39;../photos/photo.model&#39;;\n\n@Table\nexport class User extends Model&lt;User&gt; &#123;\n  @Column\n  firstName: string;\n\n  @Column\n  lastName: string;\n\n  @Column(&#123; defaultValue: true &#125;)\n  isActive: boolean;\n\n  @HasMany(() =&gt; Photo)\n  photos: Photo[];\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> To learn more about associations in Sequelize, read <a rel='nofollow' target='_blank' href=\"https://github.com/RobinBuschmann/sequelize-typescript#model-association\">this</a> chapter.\n</blockquote>\n<h4 appAnchor id=\"auto-load-models\"><span>Auto-load models</span></h4>\n<p>Manually adding models to the <code>models</code> array of the connection options can be tedious. In addition, referencing models from the root module breaks application domain boundaries and causes leaking implementation details to other parts of the application. To solve this issue, automatically load models by setting both <code>autoLoadModels</code> and <code>synchronize</code> properties of the configuration object (passed into the <code>forRoot()</code> method) to <code>true</code>, as shown below:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: app09e4bee4739ebaf68c87b8b740661239ab727221.isJsActive }}\n<app-tabs #app09e4bee4739ebaf68c87b8b740661239ab727221></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; SequelizeModule &#125; from &#39;@nestjs/sequelize&#39;;\n\n@Module(&#123;\n  imports: [\n    SequelizeModule.forRoot(&#123;\n      ...\n      autoLoadModels: true,\n      synchronize: true,\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>With that option specified, every model registered through the <code>forFeature()</code> method will be automatically added to the <code>models</code> array of the configuration object.</p>\n<blockquote class=\"\nwarning \"><strong>Warning</strong> Note that models that aren&#39;t registered through the <code>forFeature()</code> method, but are only referenced from the model (via an association), won&#39;t be included.\n</blockquote>\n<h4 appAnchor id=\"transactions-1\"><span>Transactions</span></h4>\n<p>A database transaction symbolizes a unit of work performed within a database management system against a database, and treated in a coherent and reliable way independent of other transactions. A transaction generally represents any change in a database (<a rel='nofollow' target='_blank' href=\"https://en.wikipedia.org/wiki/Database_transaction\">learn more</a>).</p>\n<p>There are many different strategies to handle <a rel='nofollow' target='_blank' href=\"https://sequelize.org/v5/manual/transactions.html\">Sequelize transactions</a>. Below is a sample implementation of a managed transaction (auto-callback).</p>\n<p>First, we need to inject the <code>Sequelize</code> object into a class in the normal way:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nexport class UsersService &#123;\n  constructor(private readonly sequelize: Sequelize) &#123;&#125;\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>Sequelize</code> class is imported from the <code>sequelize-typescript</code> package.\n</blockquote>\n<p>Now, we can use this object to create a transaction.</p>\n<pre><code class=\"language-typescript\">\nasync createMany() &#123;\n  try &#123;\n    await this.sequelize.transaction(async t =&gt; &#123;\n      const transactionHost = &#123; transaction: t &#125;;\n\n      await this.userModel.create(\n          &#123; firstName: &#39;Abraham&#39;, lastName: &#39;Lincoln&#39; &#125;,\n          transactionHost,\n      );\n      await this.userModel.create(\n          &#123; firstName: &#39;John&#39;, lastName: &#39;Boothe&#39; &#125;,\n          transactionHost,\n      );\n    &#125;);\n  &#125; catch (err) &#123;\n    // Transaction has been rolled back\n    // err is whatever rejected the promise chain returned to the transaction callback\n  &#125;\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Note that the <code>Sequelize</code> instance is used only to start the transaction. However, to test this class would require mocking the entire <code>Sequelize</code> object (which exposes several methods). Thus, we recommend using a helper factory class (e.g., <code>TransactionRunner</code>) and defining an interface with a limited set of methods required to maintain transactions. This technique makes mocking these methods pretty straightforward.\n</blockquote>\n<h4 appAnchor id=\"migrations-1\"><span>Migrations</span></h4>\n<p><a rel='nofollow' target='_blank' href=\"https://sequelize.org/v5/manual/migrations.html\">Migrations</a> provide a way to incrementally update the database schema to keep it in sync with the application&#39;s data model while preserving existing data in the database. To generate, run, and revert migrations, Sequelize provides a dedicated <a rel='nofollow' target='_blank' href=\"https://sequelize.org/v5/manual/migrations.html#the-cli\">CLI</a>.</p>\n<p>Migration classes are separate from the Nest application source code. Their lifecycle is maintained by the Sequelize CLI. Therefore, you are not able to leverage dependency injection and other Nest specific features with migrations. To learn more about migrations, follow the guide in the <a rel='nofollow' target='_blank' href=\"https://sequelize.org/v5/manual/migrations.html#the-cli\">Sequelize documentation</a>.</p>\n<p></p>\n<h4 appAnchor id=\"multiple-databases-1\"><span>Multiple databases</span></h4>\n<p>Some projects require multiple database connections. This can also be achieved with this module. To work with multiple connections, first create the connections. In this case, connection naming becomes <strong>mandatory</strong>.</p>\n<p>Suppose you have an <code>Album</code> entity stored in its own database.</p>\n<pre><code class=\"language-typescript\">\nconst defaultOptions = &#123;\n  dialect: &#39;postgres&#39;,\n  port: 5432,\n  username: &#39;user&#39;,\n  password: &#39;password&#39;,\n  database: &#39;db&#39;,\n  synchronize: true,\n&#125;;\n\n@Module(&#123;\n  imports: [\n    SequelizeModule.forRoot(&#123;\n      ...defaultOptions,\n      host: &#39;user_db_host&#39;,\n      models: [User],\n    &#125;),\n    SequelizeModule.forRoot(&#123;\n      ...defaultOptions,\n      name: &#39;albumsConnection&#39;,\n      host: &#39;album_db_host&#39;,\n      models: [Album],\n    &#125;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<blockquote class=\"\nwarning \"><strong>Notice</strong> If you don&#39;t set the <code>name</code> for a connection, its name is set to <code>default</code>. Please note that you shouldn&#39;t have multiple connections without a name, or with the same name, otherwise they will get overridden.\n</blockquote>\n<p>At this point, you have <code>User</code> and <code>Album</code> models registered with their own connection. With this setup, you have to tell the <code>SequelizeModule.forFeature()</code> method and the <code>@InjectModel()</code> decorator which connection should be used. If you do not pass any connection name, the <code>default</code> connection is used.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    SequelizeModule.forFeature([User]),\n    SequelizeModule.forFeature([Album], &#39;albumsConnection&#39;),\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre>\n<p>You can also inject the <code>Sequelize</code> instance for a given connection:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nexport class AlbumsService &#123;\n  constructor(\n    @InjectConnection(&#39;albumsConnection&#39;)\n    private readonly sequelize: Sequelize,\n  ) &#123;&#125;\n&#125;</code></pre>\n<h4 appAnchor id=\"testing-1\"><span>Testing</span></h4>\n<p>When it comes to unit testing an application, we usually want to avoid making a database connection, keeping our test suites independent and their execution process as fast as possible. But our classes might depend on models that are pulled from the connection instance. How do we handle that? The solution is to create mock models. In order to achieve that, we set up <a routerLink=\"/fundamentals/custom-providers\">custom providers</a>. Each registered model is automatically represented by a <code>&lt;ModelName&gt;Model</code> token, where <code>ModelName</code> is the name of your model class.</p>\n<p>The <code>@nestjs/sequelize</code> package exposes the <code>getModelToken()</code> function which returns a prepared token based on a given model.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  providers: [\n    UserService,\n    &#123;\n      provide: getModelToken(User),\n      useValue: mockModel,\n    &#125;,\n  ],\n&#125;)\nexport class UsersModule &#123;&#125;</code></pre>\n<p>Now a substitute <code>mockModel</code> will be used as the <code>UserModel</code>. Whenever any class asks for <code>UserModel</code> using an <code>@InjectModel()</code> decorator, Nest will use the registered <code>mockModel</code> object.</p>\n<h4 appAnchor id=\"async-configuration-1\"><span>Async configuration</span></h4>\n<p>You may want to pass your <code>SequelizeModule</code> options asynchronously instead of statically. In this case, use the <code>forRootAsync()</code> method, which provides several ways to deal with async configuration.</p>\n<p>One approach is to use a factory function:</p>\n<pre><code class=\"language-typescript\">\nSequelizeModule.forRootAsync(&#123;\n  useFactory: () =&gt; (&#123;\n    dialect: &#39;mysql&#39;,\n    host: &#39;localhost&#39;,\n    port: 3306,\n    username: &#39;root&#39;,\n    password: &#39;root&#39;,\n    database: &#39;test&#39;,\n    models: [],\n  &#125;),\n&#125;);</code></pre>\n<p>Our factory behaves like any other <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/async-providers\">asynchronous provider</a> (e.g., it can be <code>async</code> and it&#39;s able to inject dependencies through <code>inject</code>).</p>\n<pre><code class=\"language-typescript\">\nSequelizeModule.forRootAsync(&#123;\n  imports: [ConfigModule],\n  useFactory: (configService: ConfigService) =&gt; (&#123;\n    dialect: &#39;mysql&#39;,\n    host: configService.get&lt;string&gt;(&#39;HOST&#39;),\n    port: configService.get&lt;string&gt;(&#39;PORT&#39;),\n    username: configService.get&lt;string&gt;(&#39;USERNAME&#39;),\n    password: configService.get&lt;string&gt;(&#39;PASSWORD&#39;),\n    database: configService.get&lt;string&gt;(&#39;DATABASE&#39;),\n    models: [],\n  &#125;),\n  inject: [ConfigService],\n&#125;);</code></pre>\n<p>Alternatively, you can use the <code>useClass</code> syntax:</p>\n<pre><code class=\"language-typescript\">\nSequelizeModule.forRootAsync(&#123;\n  useClass: SequelizeConfigService,\n&#125;);</code></pre>\n<p>The construction above will instantiate <code>SequelizeConfigService</code> inside <code>SequelizeModule</code> and use it to provide an options object by calling <code>createSequelizeOptions()</code>. Note that this means that the <code>SequelizeConfigService</code> has to implement the <code>SequelizeOptionsFactory</code> interface, as shown below:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nclass SequelizeConfigService implements SequelizeOptionsFactory &#123;\n  createSequelizeOptions(): SequelizeModuleOptions &#123;\n    return &#123;\n      dialect: &#39;mysql&#39;,\n      host: &#39;localhost&#39;,\n      port: 3306,\n      username: &#39;root&#39;,\n      password: &#39;root&#39;,\n      database: &#39;test&#39;,\n      models: [],\n    &#125;;\n  &#125;\n&#125;</code></pre>\n<p>In order to prevent the creation of <code>SequelizeConfigService</code> inside <code>SequelizeModule</code> and use a provider imported from a different module, you can use the <code>useExisting</code> syntax.</p>\n<pre><code class=\"language-typescript\">\nSequelizeModule.forRootAsync(&#123;\n  imports: [ConfigModule],\n  useExisting: ConfigService,\n&#125;);</code></pre>\n<p>This construction works the same as <code>useClass</code> with one critical difference - <code>SequelizeModule</code> will lookup imported modules to reuse an existing <code>ConfigService</code> instead of instantiating a new one.</p>\n<h4 appAnchor id=\"example-1\"><span>Example</span></h4>\n<p>A working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/07-sequelize\">here</a>.</p>\n\n</div>\n\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-task-scheduling',\n  templateUrl: './task-scheduling.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TaskSchedulingComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/task-scheduling.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"task-scheduling\">Task Scheduling</h3>\n<p>Task scheduling allows you to schedule arbitrary code (methods/functions) to execute at a fixed date/time, at recurring intervals, or once after a specified interval. In the Linux world, this is often handled by packages like <a rel='nofollow' target='_blank' href=\"https://en.wikipedia.org/wiki/Cron\">cron</a> at the OS level. For Node.js apps, there are several packages that emulate cron-like functionality. Nest provides the <code>@nestjs/schedule</code> package, which integrates with the popular Node.js <a rel='nofollow' target='_blank' href=\"https://github.com/kelektiv/node-cron\">node-cron</a> package. We&#39;ll cover this package in the current chapter.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To begin using it, we first install the required dependencies.</p>\n<pre><code class=\"language-bash\">\n$ npm install --save @nestjs/schedule</code></pre>\n<p>To activate job scheduling, import the <code>ScheduleModule</code> into the root <code>AppModule</code> and run the <code>forRoot()</code> static method as shown below:</p>\n\n<span class=\"filename\">\n  {{ 'app.module' | extension: appe0e32a6b70950cdcbf0e6ab3eaea0a1a2361bb2e.isJsActive }}\n<app-tabs #appe0e32a6b70950cdcbf0e6ab3eaea0a1a2361bb2e></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; Module &#125; from &#39;@nestjs/common&#39;;\nimport &#123; ScheduleModule &#125; from &#39;@nestjs/schedule&#39;;\n\n@Module(&#123;\n  imports: [\n    ScheduleModule.forRoot()\n  ],\n&#125;)\nexport class AppModule &#123;&#125;</code></pre><p>The <code>.forRoot()</code> call initializes the scheduler and registers any declarative <a href=\"techniques/task-scheduling#declarative-cron-jobs\">cron jobs</a>, <a href=\"techniques/task-scheduling#declarative-timeouts\">timeouts</a> and <a href=\"techniques/task-scheduling#declarative-intervals\">intervals</a> that exist within your app. Registration occurs when the <code>onApplicationBootstrap</code> lifecycle hook occurs, ensuring that all modules have loaded and declared any scheduled jobs.</p>\n<h4 appAnchor id=\"declarative-cron-jobs\"><span>Declarative cron jobs</span></h4>\n<p>A cron job schedules an arbitrary function (method call) to run automatically. Cron jobs can run:</p>\n<ul>\n<li>Once, at a specified date/time.</li>\n<li>On a recurring basis; recurring jobs can run at a specified instant within a specified interval (for example, once per hour, once per week, once every 5 minutes)</li>\n</ul>\n<p>Declare a cron job with the <code>@Cron()</code> decorator preceding the method definition containing the code to be executed, as follows:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Injectable, Logger &#125; from &#39;@nestjs/common&#39;;\nimport &#123; Cron &#125; from &#39;@nestjs/schedule&#39;;\n\n@Injectable()\nexport class TasksService &#123;\n  private readonly logger = new Logger(TasksService.name);\n\n  @Cron(&#39;45 * * * * *&#39;)\n  handleCron() &#123;\n    this.logger.debug(&#39;Called when the current second is 45&#39;);\n  &#125;\n&#125;</code></pre>\n<p>In this example, the <code>handleCron()</code> method will be called each time the current second is <code>45</code>. In other words, the method will be run once per minute, at the 45 second mark.</p>\n<p>The <code>@Cron()</code> decorator supports all standard <a rel='nofollow' target='_blank' href=\"http://crontab.org/\">cron patterns</a>:</p>\n<ul>\n<li>Asterisk (e.g. <code>*</code>)</li>\n<li>Ranges (e.g. <code>1-3,5</code>)</li>\n<li>Steps (e.g. <code>*/2</code>)</li>\n</ul>\n<p>In the example above, we passed <code>45 * * * * *</code> to the decorator. The following key shows how each position in the cron pattern string is interpreted:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">\n* * * * * *\n| | | | | |\n| | | | | day of week\n| | | | month\n| | | day of month\n| | hour\n| minute\nsecond (optional)\n</code></pre>\n\n<p>Some sample cron patterns are:</p>\n<table>\n  <tbody>\n    <tr>\n      <td><code>* * * * * *</code></td>\n      <td>every second</td>\n    </tr>\n    <tr>\n      <td><code>45 * * * * *</code></td>\n      <td>every minute, on the 45th second</td>\n    </tr>\n    <tr>\n      <td><code>* 10 * * * *</code></td>\n      <td>every hour, at the start of the 10th minute</td>\n    </tr>\n    <tr>\n      <td><code>0 */30 9-17 * * *</code></td>\n      <td>every 30 minutes between 9am and 5pm</td>\n    </tr>\n   <tr>\n      <td><code>0 30 11 * * 1-5</code></td>\n      <td>Monday to Friday at 11:30am</td>\n    </tr>\n  </tbody>\n</table>\n\n<p>The <code>@nestjs/schedule</code> package provides a convenience enum with commonly used cron patterns. You can use this enum as follows:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Injectable, Logger &#125; from &#39;@nestjs/common&#39;;\nimport &#123; Cron, CronExpression &#125; from &#39;@nestjs/schedule&#39;;\n\n@Injectable()\nexport class TasksService &#123;\n  private readonly logger = new Logger(TasksService.name);\n\n  @Cron(CronExpression.EVERY_45_SECONDS)\n  handleCron() &#123;\n    this.logger.debug(&#39;Called every 45 seconds&#39;);\n  &#125;\n&#125;</code></pre>\n<p>In this example, the <code>handleCron()</code> method will be called every <code>45</code> seconds.</p>\n<p>Alternatively, you can supply a JavaScript <code>Date</code> object to the <code>@Cron()</code> decorator. Doing so causes the job to execute exactly once, at the specified date.</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Use JavaScript date arithmetic to schedule jobs relative to the current date. For example, <code>@Cron(new Date(Date.now() + 10 * 1000))</code> to schedule a job to run 10 seconds after the app starts.\n</blockquote>\n<p>You can access and control a cron job after it&#39;s been declared, or dynamically create a cron job (where its cron pattern is defined at runtime) with the <a href=\"/techniques/task-scheduling#dynamic-schedule-module-api\">Dynamic API</a>. To access a declarative cron job via the API, you must associate the job with a name by passing the <code>name</code> property in an optional options object as the second argument of the decorator, as shown below:</p>\n<pre><code class=\"language-typescript\">\n@Cron(&#39;* * 8 * * *&#39;, &#123;\n  name: &#39;notifications&#39;,\n&#125;)\ntriggerNotifications() &#123;&#125;</code></pre>\n<h4 appAnchor id=\"declarative-intervals\"><span>Declarative intervals</span></h4>\n<p>To declare that a method should run at a (recurring) specified interval, prefix the method definition with the <code>@Interval()</code> decorator. Pass the interval value, as a number in milliseconds, to the decorator as shown below:</p>\n<pre><code class=\"language-typescript\">\n@Interval(10000)\nhandleInterval() &#123;\n  this.logger.debug(&#39;Called every 10 seconds&#39;);\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> This mechanism uses the JavaScript <code>setInterval()</code> function under the hood. You can also utilize a cron job to schedule recurring jobs.\n</blockquote>\n<p>If you want to control your declarative interval from outside the declaring class via the <a href=\"/techniques/task-scheduling#dynamic-schedule-module-api\">Dynamic API</a>, associate the interval with a name using the following construction:</p>\n<pre><code class=\"language-typescript\">\n@Interval(&#39;notifications&#39;, 2500)\nhandleInterval() &#123;&#125;</code></pre>\n<p>The <a href=\"techniques/task-scheduling#dynamic-intervals\">Dynamic API</a> also enables <strong>creating</strong> dynamic intervals, where the interval&#39;s properties are defined at runtime, and <strong>listing and deleting</strong> them.</p>\n<p><app-banner-enterprise></app-banner-enterprise></p>\n<h4 appAnchor id=\"declarative-timeouts\"><span>Declarative timeouts</span></h4>\n<p>To declare that a method should run (once) at a specified timeout, prefix the method definition with the <code>@Timeout()</code> decorator. Pass the relative time offset (in milliseconds), from application startup, to the decorator as shown below:</p>\n<pre><code class=\"language-typescript\">\n@Timeout(5000)\nhandleTimeout() &#123;\n  this.logger.debug(&#39;Called once after 5 seconds&#39;);\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> This mechanism uses the JavaScript <code>setTimeout()</code> function under the hood.\n</blockquote>\n<p>If you want to control your declarative timeout from outside the declaring class via the <a href=\"/techniques/task-scheduling#dynamic-schedule-module-api\">Dynamic API</a>, associate the timeout with a name using the following construction:</p>\n<pre><code class=\"language-typescript\">\n@Timeout(&#39;notifications&#39;, 2500)\nhandleTimeout() &#123;&#125;</code></pre>\n<p>The <a href=\"techniques/task-scheduling#dynamic-timeouts\">Dynamic API</a> also enables <strong>creating</strong> dynamic timeouts, where the timeout&#39;s properties are defined at runtime, and <strong>listing and deleting</strong> them.</p>\n<h4 appAnchor id=\"dynamic-schedule-module-api\"><span>Dynamic schedule module API</span></h4>\n<p>The <code>@nestjs/schedule</code> module provides a dynamic API that enables managing declarative <a href=\"techniques/task-scheduling#declarative-cron-jobs\">cron jobs</a>, <a href=\"techniques/task-scheduling#declarative-timeouts\">timeouts</a> and <a href=\"techniques/task-scheduling#declarative-intervals\">intervals</a>. The API also enables creating and managing <strong>dynamic</strong> cron jobs, timeouts and intervals, where the properties are defined at runtime.</p>\n<h4 appAnchor id=\"dynamic-cron-jobs\"><span>Dynamic cron jobs</span></h4>\n<p>Obtain a reference to a <code>CronJob</code> instance by name from anywhere in your code using the <code>SchedulerRegistry</code> API. First, inject <code>SchedulerRegistry</code> using standard constructor injection:</p>\n<pre><code class=\"language-typescript\">\nconstructor(private readonly schedulerRegistry: SchedulerRegistry) &#123;&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Import the <code>SchedulerRegistry</code> from the <code>@nestjs/schedule</code> package.\n</blockquote>\n<p>Then use it in a class as follows. Assume a cron job was created with the following declaration:</p>\n<pre><code class=\"language-typescript\">\n@Cron(&#39;* * 8 * * *&#39;, &#123;\n  name: &#39;notifications&#39;,\n&#125;)\ntriggerNotifications() &#123;&#125;</code></pre>\n<p>Access this job using the following:</p>\n<pre><code class=\"language-typescript\">\nconst job = this.schedulerRegistry.getCronJob(&#39;notifications&#39;);\n\njob.stop();\nconsole.log(job.lastDate());</code></pre>\n<p>The <code>getCronJob()</code> method returns the named cron job. The returned <code>CronJob</code> object has the following methods:</p>\n<ul>\n<li><code>stop()</code> - stops a job that is scheduled to run.</li>\n<li><code>start()</code> - restarts a job that has been stopped.</li>\n<li><code>setTime(time: CronTime)</code> - stops a job, sets a new time for it, and then starts it</li>\n<li><code>lastDate()</code> - returns a string representation of the last date a job executed</li>\n<li><code>nextDates(count: number)</code> - returns an array (size <code>count</code>) of <code>moment</code> objects representing upcoming job execution dates.</li>\n</ul>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> Use <code>toDate()</code> on <code>moment</code> objects to render them in human readable form.\n</blockquote>\n<p><strong>Create</strong> a new cron job dynamically using the <code>SchedulerRegistry.addCronJob()</code> method, as follows:</p>\n<pre><code class=\"language-typescript\">\naddCronJob(name: string, seconds: string) &#123;\n  const job = new CronJob(`$&#123;seconds&#125; * * * * *`, () =&gt; &#123;\n    this.logger.warn(`time ($&#123;seconds&#125;) for job $&#123;name&#125; to run!`);\n  &#125;);\n\n  this.scheduler.addCronJob(name, job);\n  job.start();\n\n  this.logger.warn(\n    `job $&#123;name&#125; added for each minute at $&#123;seconds&#125; seconds!`,\n  );\n&#125;</code></pre>\n<p>In this code, we use the <code>CronJob</code> object from the <code>cron</code> package to create the cron job. The <code>CronJob</code> constructor takes a cron pattern (just like the <code>@Cron()</code> <a href=\"techniques/task-scheduling#declarative-cron-jobs\">decorator</a>) as its first argument, and a callback to be executed when the cron timer fires as its second argument. The <code>SchedulerRegistry.addCronJob()</code> method takes two arguments: a name for the <code>CronJob</code>, and the <code>CronJob</code> object itself.</p>\n<blockquote class=\"\nwarning \"><strong>Warning</strong> Remember to inject the <code>SchedulerRegistry</code> before accessing it. Import <code>CronJob</code> from the <code>cron</code> package.\n</blockquote>\n<p><strong>Delete</strong> a named cron job using the <code>SchedulerRegistry.deleteCronJob()</code> method, as follows:</p>\n<pre><code class=\"language-typescript\">\ndeleteCron(name: string) &#123;\n  this.scheduler.deleteCronJob(name);\n  this.logger.warn(`job $&#123;name&#125; deleted!`);\n&#125;</code></pre>\n<p><strong>List</strong> all cron jobs using the <code>SchedulerRegistry.getCronJobs()</code> method as follows:</p>\n<pre><code class=\"language-typescript\">\ngetCrons() &#123;\n  const jobs = this.scheduler.getCronJobs();\n  jobs.forEach((value, key, map) =&gt; &#123;\n    let next;\n    try &#123;\n      next = value.nextDates().toDate();\n    &#125; catch (e) &#123;\n      next = &#39;error: next fire date is in the past!&#39;;\n    &#125;\n    this.logger.log(`job: $&#123;key&#125; -&gt; next: $&#123;next&#125;`);\n  &#125;);\n&#125;</code></pre>\n<p>The <code>getCronJobs()</code> method returns a <code>map</code>. In this code, we iterate over the map and attempt to access the <code>nextDates()</code> method of each <code>CronJob</code>. In the <code>CronJob</code> API, if a job has already fired and has no future firing dates, it throws an exception.</p>\n<h4 appAnchor id=\"dynamic-intervals\"><span>Dynamic intervals</span></h4>\n<p>Obtain a reference to an interval with the <code>SchedulerRegistry.getInterval()</code> method. As above, inject <code>SchedulerRegistry</code> using standard constructor injection:</p>\n<pre><code class=\"language-typescript\">\nconstructor(private readonly schedulerRegistry: SchedulerRegistry) &#123;&#125;</code></pre>\n<p>And use it as follows:</p>\n<pre><code class=\"language-typescript\">\nconst interval = this.schedulerRegistry.getInterval(&#39;notifications&#39;);\nclearInterval(interval);</code></pre>\n<p><strong>Create</strong> a new interval dynamically using the <code>SchedulerRegistry.addInterval()</code> method, as follows:</p>\n<pre><code class=\"language-typescript\">\naddInterval(name: string, seconds: string) &#123;\n  const callback = () =&gt; &#123;\n    this.logger.warn(`Interval $&#123;name&#125; executing at time ($&#123;seconds&#125;)!`);\n  &#125;;\n\n  const interval = setInterval(callback, seconds);\n  this.scheduler.addInterval(name, interval);\n&#125;</code></pre>\n<p>In this code, we create a standard JavaScript interval, then pass it to the <code>ScheduleRegistry.addInterval()</code> method.\nThat method takes two arguments: a name for the interval, and the interval itself.</p>\n<p><strong>Delete</strong> a named interval using the <code>SchedulerRegistry.deleteInterval()</code> method, as follows:</p>\n<pre><code class=\"language-typescript\">\ndeleteInterval(name: string) &#123;\n  this.scheduler.deleteInterval(name);\n  this.logger.warn(`Interval $&#123;name&#125; deleted!`);\n&#125;</code></pre>\n<p><strong>List</strong> all intervals using the <code>SchedulerRegistry.getIntervals()</code> method as follows:</p>\n<pre><code class=\"language-typescript\">\ngetIntervals() &#123;\n  const intervals = this.scheduler.getIntervals();\n  intervals.forEach(key =&gt; this.logger.log(`Interval: $&#123;key&#125;`));\n&#125;</code></pre>\n<h4 appAnchor id=\"dynamic-timeouts\"><span>Dynamic timeouts</span></h4>\n<p>Obtain a reference to a timeout with the <code>SchedulerRegistry.getTimeout()</code> method. As above, inject <code>SchedulerRegistry</code> using standard constructor injection:</p>\n<pre><code class=\"language-typescript\">\nconstructor(private readonly schedulerRegistry: SchedulerRegistry) &#123;&#125;</code></pre>\n<p>And use it as follows:</p>\n<pre><code class=\"language-typescript\">\nconst timeout = this.schedulerRegistry.getTimeout(&#39;notifications&#39;);\nclearTimeout(timeout);</code></pre>\n<p><strong>Create</strong> a new timeout dynamically using the <code>SchedulerRegistry.addTimeout()</code> method, as follows:</p>\n<pre><code class=\"language-typescript\">\naddTimeout(name: string, seconds: string) &#123;\n  const callback = () =&gt; &#123;\n    this.logger.warn(`Timeout $&#123;name&#125; executing after ($&#123;seconds&#125;)!`);\n  &#125;);\n\n  const timeout = setTimeout(callback, seconds);\n  this.scheduler.addTimeout(name, timeout);\n&#125;</code></pre>\n<p>In this code, we create a standard JavaScript timeout, then pass it to the <code>ScheduleRegistry.addTimeout()</code> method.\nThat method takes two arguments: a name for the timeout, and the timeout itself.</p>\n<p><strong>Delete</strong> a named timeout using the <code>SchedulerRegistry.deleteTimeout()</code> method, as follows:</p>\n<pre><code class=\"language-typescript\">\ndeleteTimeout(name: string) &#123;\n  this.scheduler.deleteTimeout(name);\n  this.logger.warn(`Timeout $&#123;name&#125; deleted!`);\n&#125;</code></pre>\n<p><strong>List</strong> all timeouts using the <code>SchedulerRegistry.getTimeouts()</code> method as follows:</p>\n<pre><code class=\"language-typescript\">\ngetTimeouts() &#123;\n  const timeouts = this.scheduler.getTimeouts();\n  timeouts.forEach(key =&gt; this.logger.log(`Timeout: $&#123;key&#125;`));\n&#125;</code></pre>\n<h4 appAnchor id=\"example\"><span>Example</span></h4>\n<p>A working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/27-scheduling\">here</a>.</p>\n\n</div>\n\n",
    "import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { SharedModule } from '../../../shared/shared.module';\nimport { AuthenticationComponent } from './authentication/authentication.component';\nimport { CachingComponent } from './caching/caching.component';\nimport { CompressionComponent } from './compression/compression.component';\nimport { ConfigurationComponent } from './configuration/configuration.component';\nimport { FileUploadComponent } from './file-upload/file-upload.component';\nimport { HttpModuleComponent } from './http-module/http-module.component';\nimport { LoggerComponent } from './logger/logger.component';\nimport { MongoComponent } from './mongo/mongo.component';\nimport { MvcComponent } from './mvc/mvc.component';\nimport { PerformanceComponent } from './performance/performance.component';\nimport { QueuesComponent } from './queues/queues.component';\nimport { SecurityComponent } from './security/security.component';\nimport { SerializationComponent } from './serialization/serialization.component';\nimport { SqlComponent } from './sql/sql.component';\nimport { TaskSchedulingComponent } from './task-scheduling/task-scheduling.component';\nimport { ValidationComponent } from './validation/validation.component';\n\nconst routes: Routes = [\n  {\n    path: 'authentication',\n    component: AuthenticationComponent,\n    data: { title: 'Authentication' },\n  },\n  {\n    path: 'mvc',\n    component: MvcComponent,\n    data: { title: 'MVC' },\n  },\n  {\n    path: 'serialization',\n    component: SerializationComponent,\n    data: { title: 'Serialization' },\n  },\n  {\n    path: 'caching',\n    component: CachingComponent,\n    data: { title: 'Caching' },\n  },\n  {\n    path: 'validation',\n    component: ValidationComponent,\n    data: { title: 'Validation' },\n  },\n  {\n    path: 'sql',\n    redirectTo: 'database',\n  },\n  {\n    path: 'database',\n    component: SqlComponent,\n    data: { title: 'Database' },\n  },\n  {\n    path: 'mongodb',\n    component: MongoComponent,\n    data: { title: 'MongoDB' },\n  },\n  {\n    path: 'file-upload',\n    component: FileUploadComponent,\n    data: { title: 'File upload' },\n  },\n  {\n    path: 'logger',\n    component: LoggerComponent,\n    data: { title: 'Logger' },\n  },\n  {\n    path: 'performance',\n    component: PerformanceComponent,\n    data: { title: 'Performance (Fastify)' },\n  },\n  {\n    path: 'http-module',\n    component: HttpModuleComponent,\n    data: { title: 'HTTP module' },\n  },\n  {\n    path: 'configuration',\n    component: ConfigurationComponent,\n    data: { title: 'Configuration' },\n  },\n  {\n    path: 'security',\n    component: SecurityComponent,\n    data: { title: 'Security' },\n  },\n  {\n    path: 'task-scheduling',\n    component: TaskSchedulingComponent,\n    data: { title: 'Task Scheduling' },\n  },\n  {\n    path: 'compression',\n    component: CompressionComponent,\n    data: { title: 'Compression' },\n  },\n  {\n    path: 'queues',\n    component: QueuesComponent,\n    data: { title: 'Queues' },\n  },\n  {\n    path: 'hot-reload',\n    redirectTo: '/recipes/hot-reload',\n  },\n];\n\n@NgModule({\n  imports: [CommonModule, SharedModule, RouterModule.forChild(routes)],\n  declarations: [\n    SqlComponent,\n    MvcComponent,\n    MongoComponent,\n    AuthenticationComponent,\n    SecurityComponent,\n    QueuesComponent,\n    LoggerComponent,\n    TaskSchedulingComponent,\n    PerformanceComponent,\n    FileUploadComponent,\n    HttpModuleComponent,\n    ConfigurationComponent,\n    CompressionComponent,\n    ValidationComponent,\n    CachingComponent,\n    SerializationComponent,\n  ],\n})\nexport class TechniquesModule {}\n",
    "import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-validation',\n  templateUrl: './validation.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ValidationComponent extends BasePageComponent {}\n",
    "\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/techniques/validation.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"validation\">Validation</h3>\n<p>It is best practice to validate the correctness of any data sent into a web application. To automatically validate incoming requests, Nest provides a built-in <code>ValidationPipe</code>, which makes use of the powerful <a rel='nofollow' target='_blank' href=\"https://github.com/typestack/class-validator\">class-validator</a> package and its declarative validation decorators. The <code>ValidationPipe</code> provides a convenient approach to enforce validation rules for all incoming client payloads, where the specific rules are declared with simple annotations in local class/DTO declarations in each module.</p>\n<h4 appAnchor id=\"overview\"><span>Overview</span></h4>\n<p>In the <a routerLink=\"/pipes\">Pipes</a> chapter, we went through the process of building a simple validation pipe to demonstrate how the process works. Be sure to review that chapter to best understand the topics of this chapter. Here, we&#39;ll focus on various <strong>real world</strong> use cases of the <code>ValidationPipe</code>, and using some of its advanced customization features.</p>\n<h4 appAnchor id=\"auto-validation\"><span>Auto-validation</span></h4>\n<p>We&#39;ll start by binding <code>ValidationPipe</code> at the application level, thus ensuring all endpoints are protected from receiving incorrect data.</p>\n<pre><code class=\"language-typescript\">\nasync function bootstrap() &#123;\n  const app = await NestFactory.create(ApplicationModule);\n  app.useGlobalPipes(new ValidationPipe());\n  await app.listen(3000);\n&#125;\nbootstrap();</code></pre>\n<p>To test our pipe, let&#39;s create a basic endpoint.</p>\n<pre><code class=\"language-typescript\">\n@Post()\ncreate(@Body() createUserDto: CreateUserDto) &#123;\n  return &#39;This action adds a new user&#39;;\n&#125;</code></pre>\n<p>Now we can add a few validation rules in our <code>CreateUserDto</code>. We do this using decorators provided by the <code>class-validator</code> package, described in detail <a rel='nofollow' target='_blank' href=\"https://github.com/typestack/class-validator#validation-decorators\">here</a>. In this fashion, any route that uses the <code>CreateUserDto</code> will automatically enforce these validation rules.</p>\n<pre><code class=\"language-typescript\">\nimport &#123; IsEmail, IsNotEmpty &#125; from &#39;class-validator&#39;;\n\nexport class CreateUserDto &#123;\n  @IsEmail()\n  email: string;\n\n  @IsNotEmpty()\n  password: string;\n&#125;</code></pre>\n<p>With these rules in place, if a request hits our endpoint with an invalid <code>email</code> property in the request body, the application will automatically respond with a <code>400 Bad Request</code> code, along with the following response body:</p>\n<pre><code class=\"language-json\">\n&#123;\n  &quot;statusCode&quot;: 400,\n  &quot;error&quot;: &quot;Bad Request&quot;,\n  &quot;message&quot;: [\n    &#123;\n      &quot;target&quot;: &#123;&#125;,\n      &quot;property&quot;: &quot;email&quot;,\n      &quot;children&quot;: [],\n      &quot;constraints&quot;: &#123;\n        &quot;isEmail&quot;: &quot;email must be an email&quot;\n      &#125;\n    &#125;\n  ]\n&#125;</code></pre>\n<p>In addition to validating request bodies, the <code>ValidationPipe</code> can be used with other request object properties as well. Imagine that we would like to accept <code>:id</code> in the endpoint path. To ensure that only numbers are accepted for this request parameter, we can use the following construct:</p>\n<pre><code class=\"language-typescript\">\n@Get(&#39;:id&#39;)\nfindOne(@Param() params: FindOneParams) &#123;\n  return &#39;This action returns a user&#39;;\n&#125;</code></pre>\n<p><code>FindOneParams</code>, like a DTO, is simply a class that defines validation rules using <code>class-validator</code>. It would look like this:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; IsNumberString &#125; from &#39;class-validator&#39;;\n\nexport class FindOneParams &#123;\n  @IsNumberString()\n  id: number;\n&#125;</code></pre>\n<h4 appAnchor id=\"disable-detailed-errors\"><span>Disable detailed errors</span></h4>\n<p>Error messages can be helpful to explain what was incorrect in a request. However, some production environments prefer to disable detailed errors. Do this by passing an options object to the <code>ValidationPipe</code>:</p>\n<pre><code class=\"language-typescript\">\napp.useGlobalPipes(\n  new ValidationPipe(&#123;\n    disableErrorMessages: true,\n  &#125;),\n);</code></pre>\n<p>As a result, detailed error messages won&#39;t be displayed in the response body.</p>\n<h4 appAnchor id=\"stripping-properties\"><span>Stripping properties</span></h4>\n<p>Our <code>ValidationPipe</code> can also filter out properties that should not be received by the method handler. In this case, we can <strong>whitelist</strong> the acceptable properties, and any property not included in the whitelist is automatically stripped from the resulting object. For example, if our handler expects <code>email</code> and <code>password</code> properties, but a request also includes an <code>age</code> property, this property can be automatically removed from the resulting DTO. To enable such behavior, set <code>whitelist</code> to <code>true</code>.</p>\n<pre><code class=\"language-typescript\">\napp.useGlobalPipes(\n  new ValidationPipe(&#123;\n    whitelist: true,\n  &#125;),\n);</code></pre>\n<p>When set to true, this will automatically remove non-whitelisted properties (those without any decorator in the validation class).</p>\n<p>Alternatively, you can stop the request from processing when non-whitelisted properties are present, and return an error response to the user. To enable this, set the <code>forbidNonWhitelisted</code> option property to <code>true</code>, in combination with setting <code>whitelist</code> to <code>true</code>.</p>\n<p></p>\n<h4 appAnchor id=\"transform-payload-objects\"><span>Transform payload objects</span></h4>\n<p>Payloads coming in over the network are plain JavaScript objects. The <code>ValidationPipe</code> can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set <code>transform</code> to <code>true</code>.</p>\n<pre><code class=\"language-typescript\">\napp.useGlobalPipes(\n  new ValidationPipe(&#123;\n    transform: true,\n  &#125;),\n);</code></pre>\n<h4 appAnchor id=\"websockets--microservices\"><span>WebSockets &amp; Microservices</span></h4>\n<p>While this chapter shows examples using HTTP style applications (e.g., Express or Fastify), the <code>ValidationPipe</code> works the same for WebSockets and microservices, regardless of the transport method that is used.</p>\n<h4 appAnchor id=\"learn-more\"><span>Learn more</span></h4>\n<p>Read more about custom validators, error messages, and available decorators as provided by the <code>class-validator</code> package <a rel='nofollow' target='_blank' href=\"https://github.com/typestack/class-validator\">here</a>.</p>\n\n</div>\n\n"
  ]
}
